<!DOCTYPE html>
<html lang="en" data-multilingual="true">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROI Calculator - Investment Return Analysis | FinCalc</title>
    <meta name="description" content="Calculate Return on Investment (ROI), annualized returns, and compare investment performance.">
    <link rel="icon" href="../favicon.svg" type="image/svg+xml">
    <link rel="stylesheet" href="../assets/styles-modern.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="../assets/i18n.js" defer></script>
    <style>
        .full-calc-page { max-width: 1200px; margin: 0 auto; padding: var(--space-xl); }
        .full-calc-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-xl); flex-wrap: wrap; gap: var(--space-md); }
        .full-calc-header h1 { margin: 0; font-size: 1.75rem; display: flex; align-items: center; gap: var(--space-md); }
        .back-link { display: flex; align-items: center; gap: 0.5rem; color: var(--text-secondary); text-decoration: none; font-weight: 500; padding: 0.5rem 1rem; border-radius: var(--radius-md); border: 1px solid var(--border); transition: all 0.2s; }
        .back-link:hover { background: var(--gray-100); color: #008080; border-color: #008080; }
        .back-link svg { width: 18px; height: 18px; }
        .calc-grid { display: grid; grid-template-columns: 1fr 400px; gap: var(--space-xl); }
        @media (max-width: 1024px) { .calc-grid { grid-template-columns: 1fr; } }
        .results-panel { background: linear-gradient(135deg, rgba(0, 128, 128, 0.04) 0%, rgba(32, 178, 170, 0.04) 100%); border: 1px solid var(--border); border-radius: var(--radius-xl); padding: var(--space-xl); }
        .form-panel { display: flex; flex-direction: column; gap: var(--space-lg); }
        .result-card--roi .result-card__icon { background: rgba(0, 128, 128, 0.15); color: #008080; }
        .calc-icon-roi { color: #008080; }
        .roi-big { text-align: center; padding: var(--space-xl); background: linear-gradient(135deg, rgba(0, 128, 128, 0.1), rgba(32, 178, 170, 0.1)); border-radius: var(--radius-xl); margin-bottom: var(--space-xl); }
        .roi-big__label { font-size: 1rem; color: var(--text-secondary); margin-bottom: 0.5rem; }
        .roi-big__value { font-size: 3.5rem; font-weight: 800; background: linear-gradient(135deg, #008080, #20b2aa); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .roi-big__subtitle { font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem; }
        .metrics-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--space-md); margin-top: var(--space-xl); }
        .metric-item { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius-lg); padding: var(--space-lg); text-align: center; }
        .metric-item__label { font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.25rem; }
        .metric-item__value { font-size: 1.5rem; font-weight: 700; color: var(--text-primary); }
        .metric-item__value--success { color: var(--success); }
        .metric-item__value--danger { color: var(--danger); }
    </style>
</head>
<body>
    <header class="site-header">
        <div class="container">
            <div class="header-content">
                <a href="../index.html" class="logo">
                    <svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect width="32" height="32" rx="8" fill="url(#gradient)"/>
                        <path d="M9 22L13 16L17 18L23 10" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <circle cx="23" cy="10" r="2" fill="white"/>
                        <defs><linearGradient id="gradient" x1="0" y1="0" x2="32" y2="32"><stop stop-color="#0066ff"/><stop offset="1" stop-color="#00a86b"/></linearGradient></defs>
                    </svg>
                    <span>FinCalc</span>
                </a>
                <nav class="nav-menu header-tabs">
                    <a href="../index.html#calculators" class="header-tab" data-i18n="nav.allCalculators">All Calculators</a>
                    <a href="../index.html#news" class="header-tab" data-i18n="nav.news">News</a>
                    <a href="../index.html#articles" class="header-tab" data-i18n="nav.articles">Articles</a>
                    <a href="../index.html#compare" class="header-tab" data-i18n="nav.compare">Compare</a>
                </nav>
                <div class="lang-dropdown">
                    <button class="lang-dropdown-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>
                        <span class="lang-btn-text" data-i18n="nav.language">Language</span>
                    </button>
                    <div class="lang-dropdown-content">
                        <a href="#" onclick="i18n.setLanguage('en'); return false;">English</a>
                        <a href="#" onclick="i18n.setLanguage('pl'); return false;">Polski</a>
                        <a href="#" onclick="i18n.setLanguage('ru'); return false;">Русский</a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="page-surface">
        <div class="full-calc-page">
            <div class="full-calc-header">
                <h1>
                    <svg viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2" class="calc-icon-roi"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
                    <span data-i18n="calc.roi">ROI Calculator</span>
                    <span class="badge badge--live" style="background: #008080; color: white;"><span class="badge__dot"></span>Pro</span>
                </h1>
                <a href="../index.html" class="back-link">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
                    <span data-i18n="nav.home">Back to Home</span>
                </a>
            </div>
            
            <div class="calc-grid">
                <!-- Results Panel -->
                <div class="results-panel">
                    <!-- Big ROI Display -->
                    <div class="roi-big">
                        <div class="roi-big__label" data-i18n="result.roi">Return on Investment</div>
                        <div class="roi-big__value" id="result-roi">+0%</div>
                        <div class="roi-big__subtitle" id="result-status" data-i18n="result.profitable">Profitable Investment</div>
                    </div>
                    
                    <div class="result-cards">
                        <div class="result-card result-card--primary result-card--roi">
                            <div class="result-card__icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg></div>
                            <div class="result-card__content">
                                <span class="result-card__label" data-i18n="result.netProfit">Net Profit</span>
                                <span class="result-card__value" id="result-profit">₽0</span>
                            </div>
                        </div>
                        <div class="result-card">
                            <div class="result-card__icon result-card__icon--blue"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg></div>
                            <div class="result-card__content">
                                <span class="result-card__label" data-i18n="result.annualizedReturn">Annualized Return</span>
                                <span class="result-card__value" id="result-annual">0%</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Metrics Grid -->
                    <div class="metrics-grid">
                        <div class="metric-item">
                            <div class="metric-item__label" data-i18n="result.initialInvestment">Initial Investment</div>
                            <div class="metric-item__value" id="metric-initial">₽0</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-item__label" data-i18n="result.finalValue">Final Value</div>
                            <div class="metric-item__value" id="metric-final">₽0</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-item__label" data-i18n="result.totalGain">Total Gain/Loss</div>
                            <div class="metric-item__value" id="metric-gain">₽0</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-item__label" data-i18n="result.holdingPeriod">Holding Period</div>
                            <div class="metric-item__value" id="metric-period">0 мес.</div>
                        </div>
                    </div>
                    
                    <div class="chart-section" style="margin-top: var(--space-xl);">
                        <div class="chart-header">
                            <h3 data-i18n="chart.valueComparison">Value Comparison</h3>
                        </div>
                        <div class="chart-container" style="max-width: 350px; margin: 0 auto;"><canvas id="comparison-chart"></canvas></div>
                    </div>
                </div>
                
                <!-- Form Panel -->
                <div class="form-panel">
                    <div class="form-card">
                        <div class="form-card__header">
                            <h3 data-i18n="section.investment">Investment Details</h3>
                            <button class="btn-reset" id="btn-reset" title="Reset"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/></svg></button>
                        </div>
                        
                        <div class="form-group">
                            <label data-i18n="form.initialInvestment">Initial Investment</label>
                            <div class="input-with-currency"><input type="text" id="initial-investment" value="100 000" inputmode="numeric"><span class="currency-symbol">₽</span></div>
                            <input type="range" id="initial-investment-range" min="1000" max="100000000" value="100000" step="1000">
                        </div>
                        
                        <div class="form-group">
                            <label data-i18n="form.finalValue">Final Value</label>
                            <div class="input-with-currency"><input type="text" id="final-value" value="150 000" inputmode="numeric"><span class="currency-symbol">₽</span></div>
                            <input type="range" id="final-value-range" min="1000" max="100000000" value="150000" step="1000">
                        </div>
                        
                        <div class="form-row-2">
                            <div class="form-group">
                                <label data-i18n="form.holdingPeriod">Holding Period</label>
                                <input type="number" id="period" value="24" min="1" max="600">
                            </div>
                            <div class="form-group">
                                <label>&nbsp;</label>
                                <select id="period-unit">
                                    <option value="months" data-i18n="form.months" selected>Months</option>
                                    <option value="years" data-i18n="form.years">Years</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-card form-card--collapsible">
                        <button class="form-card__toggle" id="toggle-additional">
                            <h3 data-i18n="section.additionalCosts">Additional Costs</h3>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                        </button>
                        <div class="form-card__content" id="additional-content" style="display:none;">
                            <div class="form-group">
                                <label data-i18n="form.fees">Fees & Commissions</label>
                                <div class="input-with-currency"><input type="text" id="fees" value="0" inputmode="numeric"><span class="currency-symbol">₽</span></div>
                            </div>
                            <div class="form-group">
                                <label data-i18n="form.dividends">Dividends Received</label>
                                <div class="input-with-currency"><input type="text" id="dividends" value="0" inputmode="numeric"><span class="currency-symbol">₽</span></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="presets-card">
                        <h4 data-i18n="form.quickExamples">Quick Examples</h4>
                        <div class="preset-buttons">
                            <button class="preset-btn" data-initial="100000" data-final="110000" data-period="12"><span>+10%</span><span style="font-size:0.75rem;opacity:0.7">1 год</span></button>
                            <button class="preset-btn" data-initial="100000" data-final="125000" data-period="24"><span>+25%</span><span style="font-size:0.75rem;opacity:0.7">2 года</span></button>
                            <button class="preset-btn active" data-initial="100000" data-final="150000" data-period="24"><span>+50%</span><span style="font-size:0.75rem;opacity:0.7">2 года</span></button>
                            <button class="preset-btn" data-initial="100000" data-final="200000" data-period="36"><span>+100%</span><span style="font-size:0.75rem;opacity:0.7">3 года</span></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer class="site-footer" style="margin-top: var(--space-2xl);">
            <div class="container">
                <p>&copy; 2025 FinCalc. <span data-i18n="footer.disclaimer">Financial calculators for informational purposes only</span></p>
            </div>
        </footer>
    </main>

    <script>
    (function() {
        'use strict';
        
        let chart = null;
        let currentCurrency = '₽';
        
        function formatCurrency(num, currency = currentCurrency) {
            const formatted = new Intl.NumberFormat('ru-RU', { maximumFractionDigits: 0 }).format(Math.abs(num));
            const sign = num >= 0 ? '' : '-';
            return `${sign}${currency}${formatted}`;
        }
        
        function parseNumber(str) {
            return parseFloat((str || '').toString().replace(/\s|\u00A0/g, '').replace(',', '.')) || 0;
        }
        
        function formatInput(value) {
            return new Intl.NumberFormat('ru-RU').format(Math.round(value));
        }
        
        function calculate() {
            const initial = parseNumber(document.getElementById('initial-investment').value);
            const final = parseNumber(document.getElementById('final-value').value);
            const period = parseNumber(document.getElementById('period').value);
            const periodUnit = document.getElementById('period-unit').value;
            const fees = parseNumber(document.getElementById('fees').value);
            const dividends = parseNumber(document.getElementById('dividends').value);
            
            const months = periodUnit === 'years' ? period * 12 : period;
            const years = months / 12;
            
            const totalGain = final - initial + dividends - fees;
            const roi = initial > 0 ? (totalGain / initial * 100) : 0;
            const annualizedReturn = initial > 0 && years > 0 
                ? (Math.pow((final + dividends - fees) / initial, 1/years) - 1) * 100 
                : 0;
            
            const isProfit = totalGain >= 0;
            
            // Update displays
            document.getElementById('result-roi').textContent = (isProfit ? '+' : '') + roi.toFixed(1) + '%';
            document.getElementById('result-roi').style.background = isProfit 
                ? 'linear-gradient(135deg, #008080, #20b2aa)' 
                : 'linear-gradient(135deg, #f44336, #ff5722)';
            document.getElementById('result-status').textContent = isProfit ? 'Прибыльная инвестиция' : 'Убыточная инвестиция';
            
            document.getElementById('result-profit').textContent = (isProfit ? '+' : '') + formatCurrency(totalGain);
            document.getElementById('result-profit').classList.toggle('result-card__value--success', isProfit);
            document.getElementById('result-profit').classList.toggle('result-card__value--danger', !isProfit);
            
            document.getElementById('result-annual').textContent = (annualizedReturn >= 0 ? '+' : '') + annualizedReturn.toFixed(1) + '%';
            
            document.getElementById('metric-initial').textContent = formatCurrency(initial);
            document.getElementById('metric-final').textContent = formatCurrency(final);
            document.getElementById('metric-gain').textContent = (isProfit ? '+' : '') + formatCurrency(totalGain);
            document.getElementById('metric-gain').className = 'metric-item__value ' + (isProfit ? 'metric-item__value--success' : 'metric-item__value--danger');
            
            const formatPeriod = (m) => {
                const y = Math.floor(m / 12);
                const mo = m % 12;
                if (y > 0 && mo > 0) return `${y} г. ${mo} мес.`;
                if (y > 0) return `${y} г.`;
                return `${mo} мес.`;
            };
            document.getElementById('metric-period').textContent = formatPeriod(months);
            
            updateChart(initial, final, totalGain, isProfit);
        }
        
        function updateChart(initial, final, gain, isProfit) {
            const ctx = document.getElementById('comparison-chart');
            if (!ctx) return;
            
            const config = {
                type: 'bar',
                data: {
                    labels: ['Начало', 'Конец'],
                    datasets: [{
                        data: [initial, final],
                        backgroundColor: ['rgba(107, 114, 128, 0.6)', isProfit ? 'rgba(0, 128, 128, 0.8)' : 'rgba(244, 67, 54, 0.8)'],
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { grid: { display: false } },
                        y: { 
                            beginAtZero: true,
                            ticks: { callback: v => v >= 1000000 ? (v/1000000).toFixed(1)+'M' : v >= 1000 ? (v/1000).toFixed(0)+'K' : v }
                        }
                    }
                }
            };
            
            if (chart) { chart.data = config.data; chart.update('none'); }
            else { chart = new Chart(ctx, config); }
        }
        
        function setupInputs() {
            ['initial-investment', 'final-value'].forEach(id => {
                const input = document.getElementById(id);
                const range = document.getElementById(id + '-range');
                if (!input || !range) return;
                
                input.addEventListener('input', () => { range.value = parseNumber(input.value); calculate(); });
                range.addEventListener('input', () => {
                    input.value = formatInput(range.value);
                    calculate();
                });
            });
            
            ['period', 'period-unit', 'fees', 'dividends'].forEach(id => {
                const el = document.getElementById(id);
                if (el) { el.addEventListener('change', calculate); el.addEventListener('input', calculate); }
            });
            
            document.getElementById('btn-reset').addEventListener('click', () => {
                document.getElementById('initial-investment').value = '100 000';
                document.getElementById('initial-investment-range').value = 100000;
                document.getElementById('final-value').value = '150 000';
                document.getElementById('final-value-range').value = 150000;
                document.getElementById('period').value = '24';
                document.getElementById('period-unit').value = 'months';
                document.getElementById('fees').value = '0';
                document.getElementById('dividends').value = '0';
                document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
                document.querySelector('.preset-btn[data-initial="100000"][data-final="150000"]').classList.add('active');
                calculate();
            });
            
            document.querySelectorAll('.form-card__toggle').forEach(btn => {
                btn.addEventListener('click', () => {
                    const content = btn.nextElementSibling;
                    const isOpen = content.style.display !== 'none';
                    content.style.display = isOpen ? 'none' : 'block';
                    btn.classList.toggle('open', !isOpen);
                });
            });
            
            document.querySelectorAll('.preset-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    const initial = parseInt(btn.dataset.initial);
                    const final = parseInt(btn.dataset.final);
                    const period = parseInt(btn.dataset.period);
                    
                    document.getElementById('initial-investment').value = formatInput(initial);
                    document.getElementById('initial-investment-range').value = initial;
                    document.getElementById('final-value').value = formatInput(final);
                    document.getElementById('final-value-range').value = final;
                    document.getElementById('period').value = period;
                    document.getElementById('period-unit').value = 'months';
                    
                    calculate();
                });
            });
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            setupInputs();
            calculate();
            if (window.i18n) i18n.updatePage();
        });
    })();
    </script>
</body>
</html>
