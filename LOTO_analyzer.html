<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –õ–æ—Ç–µ—Ä–µ–∏ - –ì—Ä–∞—Ñ–∏–∫–∏ –∏ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ê–Ω–∞–ª–∏–∑</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <style>
        :root {
            /* –û—Å–Ω–æ–≤–Ω—ã–µ —Ü–≤–µ—Ç–∞ */
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --primary-color: #667eea;
            --primary-light: #f0f4ff;
            --secondary-gradient: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);

            /* –§–æ–Ω–æ–≤—ã–µ —Ü–≤–µ—Ç–∞ */
            --bg-white: #ffffff;
            --bg-light: #f8f9fa;
            --bg-lighter: #f0f2f5;
            --bg-gray: #e0e0e0;

            /* –¶–≤–µ—Ç–∞ —Ç—Ä–µ–Ω–¥–æ–≤ */
            --trend-hot-high: #ff4444;
            --trend-hot: #ff8800;
            --trend-stable: #888888;
            --trend-cold: #44aa44;
            --trend-cold-low: #0066cc;

            /* –¶–≤–µ—Ç–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π */
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --info: #17a2b8;
            --secondary: #6c757d;

            /* –¢–µ–∫—Å—Ç–æ–≤—ã–µ —Ü–≤–µ—Ç–∞ */
            --text-primary: #333333;
            --text-secondary: #555555;
            --text-muted: #666666;
            --text-light: #ffffff;

            /* –†–∞–¥–∏—É—Å—ã */
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 10px;
            --radius-xl: 15px;

            /* –¢–µ–Ω–∏ */
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.1);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.15);
            --shadow-lg: 0 10px 30px rgba(0,0,0,0.2);

            /* –†–∞—Å—Å—Ç–æ—è–Ω–∏—è */
            --space-xs: 5px;
            --space-sm: 10px;
            --space-md: 15px;
            --space-lg: 20px;
            --space-xl: 25px;
            --space-2xl: 30px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--primary-gradient);
            min-height: 100vh;
            color: var(--text-primary);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: var(--space-lg);
        }

        .header {
            text-align: center;
            margin-bottom: var(--space-2xl);
            color: var(--text-light);
        }

        .header h1 {
            font-size: 2.25em;
            margin-bottom: var(--space-sm);
            text-shadow: none;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .section-card,
        .controls {
            background: var(--bg-white);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            margin-bottom: var(--space-2xl);
            box-shadow: var(--shadow-lg);
        }

        .section-card-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-xs);
            margin-bottom: var(--space-lg);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: var(--space-sm);
            text-align: center;
        }

        .section-card-title {
            font-size: 1.6em;
            font-weight: 700;
            color: var(--text-primary);
        }

        .section-card p,
        .controls p {
            font-size: 1em;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .section-subtitle {
            font-size: 1em;
            color: var(--text-muted);
        }

        .legend-card {
            display: flex;
            flex-direction: column;
            gap: var(--space-lg);
            margin-bottom: var(--space-lg);
            padding: var(--space-lg);
            background: linear-gradient(135deg, var(--bg-light) 0%, var(--bg-lighter) 100%);
            border-radius: var(--radius-lg);
            border: 1px solid var(--bg-gray);
            box-shadow: var(--shadow-sm);
        }

        .legend-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: var(--space-md);
        }

        .legend-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-xs);
            padding: var(--space-sm);
            background: var(--bg-white);
            border-radius: var(--radius-md);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }

        .legend-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .legend-badge {
            width: 28px;
            height: 28px;
            border-radius: var(--radius-sm);
            position: relative;
        }

        .legend-badge--hot-high {
            background: var(--trend-hot-high);
        }

        .legend-badge--hot {
            background: var(--trend-hot);
        }

        .legend-badge--stable {
            background: var(--trend-stable);
        }

        .legend-badge--cold {
            background: var(--trend-cold);
        }

        .legend-badge--cold-low {
            background: var(--trend-cold-low);
        }

        .legend-pulse {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 10px;
            height: 10px;
            background: rgba(255,255,255,0.8);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .legend-label {
            font-size: 13px;
            font-weight: 700;
            text-align: center;
        }

        .legend-label--hot-high {
            color: var(--trend-hot-high);
        }

        .legend-label--hot {
            color: var(--trend-hot);
        }

        .legend-label--stable {
            color: var(--trend-stable);
        }

        .legend-label--cold {
            color: var(--trend-cold);
        }

        .legend-label--cold-low {
            color: var(--trend-cold-low);
        }

        .legend-description {
            font-size: 11px;
            color: var(--text-muted);
            text-align: center;
        }

        .legend-info {
            padding: var(--space-sm) var(--space-md);
            background: var(--bg-white);
            border-radius: var(--radius-md);
            border-left: 4px solid var(--primary-color);
            box-shadow: var(--shadow-sm);
            font-size: 13px;
            color: var(--text-muted);
            line-height: 1.4;
        }

        .form-group {
            margin-bottom: var(--space-lg);
        }

        .form-group label {
            display: block;
            margin-bottom: var(--space-xs);
            font-weight: 600;
            color: var(--text-secondary);
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--bg-lighter);
            border-radius: var(--radius-md);
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-xs);
            background: var(--primary-gradient);
            color: var(--text-light);
            border: none;
            padding: 12px var(--space-xl);
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shine 0.6s ease-in-out;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn.cold-btn {
            background: linear-gradient(135deg, var(--trend-cold-low) 0%, #4488cc 100%);
        }

        .btn.secondary-btn {
            background: linear-gradient(135deg, var(--primary-light) 0%, var(--bg-light) 100%);
            color: var(--primary-color);
        }

        .btn.secondary-btn:hover {
            color: var(--text-light);
            background: var(--primary-gradient);
        }

        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-sm);
        }

        @keyframes shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .number-selector {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            gap: var(--space-sm);
            margin-bottom: var(--space-lg);
        }

        .number-btn {
            padding: var(--space-md);
            border: 2px solid var(--bg-lighter);
            border-radius: var(--radius-lg);
            background: linear-gradient(135deg, var(--bg-white) 0%, var(--bg-light) 100%);
            cursor: pointer;
            text-align: center;
            font-weight: 700;
            font-size: 16px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .number-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s;
        }

        .number-btn:hover::before {
            left: 100%;
        }

        .number-btn:hover {
            border-color: var(--primary-color);
            background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary-color) 100%);
            color: var(--text-light);
            transform: translateY(-3px) scale(1.05);
            box-shadow: var(--shadow-lg);
        }

        .number-btn:active {
            transform: translateY(-1px) scale(1.02);
            transition: all 0.1s;
        }

        .number-btn.active {
            background: var(--primary-color);
            color: var(--text-light);
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —É–≥–æ–ª–∫–∞ –≤ –∫–Ω–æ–ø–∫–∞—Ö —Ç–∞–±–ª–∏—Ü—ã */
        .corner-btn {
            position: absolute;
            top: -3px;
            right: -3px;
            width: 18px;
            height: 18px;
            background: var(--primary-color);
            color: var(--text-light);
            border-radius: 3px;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .number-btn:hover .corner-btn {
            display: flex;
            transform: translateY(1px) scale(1.1);
            background: var(--primary-dark);
            box-shadow: 0 3px 6px rgba(0,0,0,0.3);
        }

        .number-btn {
            position: relative;
        }

        /* –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è —Ç—Ä–µ–Ω–¥–æ–≤ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ */
        .number-btn.trend-up-high {
            background: linear-gradient(135deg, var(--trend-hot-high) 0%, #ff6666 100%);
            color: var(--text-light);
            border-color: var(--trend-hot-high);
            animation: hotPulse 3s infinite;
        }

        .number-btn.trend-up-high::before {
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
        }

        .number-btn.trend-up {
            background: linear-gradient(135deg, var(--trend-hot) 0%, #ffaa44 100%);
            color: var(--text-light);
            border-color: var(--trend-hot);
        }

        .number-btn.trend-up::before {
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.5), transparent);
        }

        .number-btn.trend-down {
            background: linear-gradient(135deg, var(--trend-cold) 0%, #66cc66 100%);
            color: var(--text-light);
            border-color: var(--trend-cold);
        }

        .number-btn.trend-down::before {
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
        }

        .number-btn.trend-down-low {
            background: linear-gradient(135deg, var(--trend-cold-low) 0%, #4488cc 100%);
            color: var(--text-light);
            border-color: var(--trend-cold-low);
            animation: coldGlow 4s infinite;
        }

        .number-btn.trend-down-low::before {
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        }

        .number-btn.trend-stable {
            background: linear-gradient(135deg, var(--trend-stable) 0%, #aaaaaa 100%);
            color: var(--text-light);
            border-color: var(--trend-stable);
        }

        .number-btn.trend-stable::before {
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        }

            /* –ê–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π */
            @keyframes hotPulse {
                0%, 100% { transform: scale(1); }
                50% { transform: scale(1.05); }
            }

            @keyframes coldGlow {
                0%, 100% { transform: scale(1); }
                50% { transform: scale(1.05); }
            }

        @keyframes pulse {
            0% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            50% { opacity: 0.3; transform: translate(-50%, -50%) scale(1.2); }
            100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }

            /* –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞ */
            .number-btn.selected-highlight {
                position: relative;
                transform: scale(1.1) !important;
                z-index: 10;
                border: 3px solid var(--primary-color) !important;
                box-shadow: 0 0 20px rgba(102, 51, 153, 0.6) !important;
                animation: selectedPulse 2s infinite !important;
            }

            @keyframes selectedPulse {
                0%, 100% { 
                    box-shadow: 0 0 20px rgba(102, 51, 153, 0.6);
                    transform: scale(1.1);
                }
                50% { 
                    box-shadow: 0 0 30px rgba(102, 51, 153, 0.8);
                    transform: scale(1.15);
                }
        }

        /* –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è —Ç—Ä–µ–Ω–¥–æ–≤ –¥–ª—è —á–∏—Å–ª–∞ –≤ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–µ */
        .number-container.trend-up-high {
            background: var(--trend-hot-high);
            color: var(--text-light);
            border-color: var(--trend-hot-high);
            box-shadow: 0 0 10px rgba(255, 68, 68, 0.3);
        }

        .number-container.trend-up {
            background: var(--trend-hot);
            color: var(--text-light);
            border-color: var(--trend-hot);
            box-shadow: 0 0 8px rgba(255, 136, 0, 0.3);
        }

        .number-container.trend-down {
            background: var(--trend-cold);
            color: var(--text-light);
            border-color: var(--trend-cold);
            box-shadow: 0 0 8px rgba(68, 170, 68, 0.3);
        }

        .number-container.trend-down-low {
            background: var(--trend-cold-low);
            color: var(--text-light);
            border-color: var(--trend-cold-low);
            box-shadow: 0 0 10px rgba(0, 102, 204, 0.3);
        }

        .number-container.trend-stable {
            background: var(--trend-stable);
            color: var(--text-light);
            border-color: var(--trend-stable);
        }

        .chart-container {
            background: var(--bg-white);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            margin-bottom: var(--space-2xl);
            box-shadow: var(--shadow-lg);
        }

        .chart-container h2 {
            margin-bottom: var(--space-lg);
            color: var(--text-primary);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: var(--space-sm);
        }

        .chart-wrapper {
            position: relative;
            height: 400px;
            margin-bottom: var(--space-lg);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-md);
            margin-top: var(--space-lg);
        }

        .stat-card {
            background: var(--bg-light);
            padding: var(--space-md);
            border-radius: var(--radius-lg);
            text-align: center;
            border-left: 4px solid var(--primary-color);
        }

        .stat-card h3 {
            color: var(--primary-color);
            margin-bottom: var(--space-xs);
        }

        .stat-card .value {
            font-size: 1.5em;
            font-weight: bold;
            color: var(--text-primary);
        }

        .prediction-panel {
            background: var(--secondary-gradient);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            margin-bottom: var(--space-2xl);
            color: var(--text-primary);
        }

        .prediction-panel h2 {
            margin-bottom: var(--space-lg);
            color: var(--text-primary);
        }

        .prediction-item {
            background: var(--bg-white);
            padding: var(--space-md);
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-sm);
            box-shadow: var(--shadow-sm);
        }

        .prediction-item h4 {
            color: var(--primary-color);
            margin-bottom: var(--space-xs);
        }

        .stat-portrait {
            background: var(--bg-white);
            padding: var(--space-lg);
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-sm);
            box-shadow: var(--shadow-sm);
        }
        .stat-portrait h4 {
            color: var(--primary-color);
            margin-top: 0;
            margin-bottom: var(--space-md);
            font-size: 1.2em;
        }
        .stat-portrait p {
            margin: var(--space-sm) 0;
            line-height: 1.6;
            font-size: 1em;
        }

        /* –ù–æ–≤—ã–π –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –¥–∏–∑–∞–π–Ω –ø–æ—Ä—Ç—Ä–µ—Ç–∞ */
        .portrait-header {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
        }

        .number-container {
            padding: var(--space-sm);
            border: 2px solid var(--bg-lighter);
            border-radius: var(--radius-md);
            display: inline-block;
            width: auto;
            height: auto;
            min-width: 50px;
            min-height: 50px;
            text-align: center;
            font-weight: 600;
            font-size: 1.1em;
            transition: all 0.3s;
            box-shadow: var(--shadow-sm);
            color: var(--text-light);
            cursor: pointer;
        }

        .number-container:hover {
            border-color: var(--primary-color);
            background: var(--primary-light);
        }

        .number-text {
            display: block;
        }

        .stats-container {
            margin-top: var(--space-xs);
        }

        .stats-frame {
            background: var(--bg-white);
            border: 1px solid var(--bg-lighter);
            border-radius: var(--radius-sm);
            padding: var(--space-xs) var(--space-sm);
            font-size: 1em;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        .stats-frame strong {
            font-weight: 700;
            color: var(--text-primary);
            font-size: 1em;
        }


        .status-badge {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius-md);
            font-weight: 600;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-icon {
            font-size: 1.2em;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
        }

        .metric-card {
            background: var(--bg-gray);
            padding: var(--space-sm);
            border-radius: var(--radius-md);
            text-align: center;
        }

        .metric-label {
            font-size: 0.8em;
            color: var(--text-secondary);
            margin-bottom: var(--space-xs);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .metric-value {
            font-size: 1.4em;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: var(--space-xs);
        }

        .metric-desc {
            font-size: 0.7em;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: var(--space-xs);
        }

        .metric-bar {
            width: 100%;
            height: 6px;
            background: var(--bg-white);
            border-radius: 3px;
            overflow: hidden;
        }

        .metric-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .forecast-section {
            background: linear-gradient(135deg, var(--bg-gray), var(--bg-white));
            padding: var(--space-md);
            border-radius: var(--radius-md);
            margin-bottom: var(--space-lg);
            text-align: center;
        }

        .forecast-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-xs);
            margin-bottom: var(--space-sm);
            font-weight: 600;
            color: var(--primary-color);
        }

        .forecast-icon {
            font-size: 1.2em;
        }

        .forecast-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-white);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: var(--space-xs);
        }

        .forecast-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .forecast-text {
            font-size: 0.9em;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .forecast-desc {
            font-size: 0.7em;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: var(--space-xs);
        }

        .quick-stats {
            display: flex;
            justify-content: space-between;
            background: var(--bg-white);
            padding: var(--space-sm);
            border-radius: var(--radius-md);
            border-top: 2px solid var(--primary-color);
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-xs);
        }

        .stat-label {
            font-size: 0.7em;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-value {
            font-size: 1.1em;
            font-weight: 600;
            color: var(--primary-color);
        }

        .stat-desc {
            font-size: 0.6em;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: 1px;
        }
        .activity-bar-background {
            width: 100%;
            height: 20px;
            background-color: var(--bg-gray);
            border-radius: var(--radius-lg);
            position: relative;
            margin-top: var(--space-xs);
        }
        .activity-bar-fill {
            height: 100%;
            border-radius: var(--radius-lg);
            transition: width 0.5s ease-in-out;
        }
        .activity-bar-fill.hot {
            background: linear-gradient(90deg, var(--warning), var(--trend-hot-high));
        }
        .activity-bar-fill.cold {
            background: linear-gradient(90deg, var(--info), var(--trend-cold));
        }
        .activity-bar-marker {
            position: absolute;
            left: 50%;
            top: -3px;
            bottom: -3px;
            width: 2px;
            background-color: var(--secondary);
            opacity: 0.7;
        }
        .activity-label {
            font-size: 0.9em;
            color: var(--text-secondary);
            margin-top: var(--space-xs);
            display: block;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: var(--text-muted);
        }

        .error {
            background: #ffebee;
            color: #c62828;
            padding: var(--space-md);
            border-radius: var(--radius-md);
            margin: var(--space-sm) 0;
            border-left: 4px solid #c62828;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .number-selector {
                grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
            }
        }

        #generator-results-container {
            margin-top: var(--space-lg);
            background: var(--bg-light);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
        }
        .generator-results-title {
            font-size: 1.4em;
            color: var(--text-primary);
            margin-bottom: var(--space-md);
            border-bottom: 2px solid var(--bg-lighter);
            padding-bottom: var(--space-sm);
        }
        .combination-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: var(--space-md);
        }
        .combination-card {
            background: var(--bg-white);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            box-shadow: var(--shadow-md);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }
        .combination-card-title {
            font-weight: 600;
            color: var(--text-secondary);
            flex-shrink: 0;
        }
        .combination-numbers {
            display: flex;
            gap: var(--space-xs);
            flex-wrap: wrap;
        }
        .combo-number {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--text-light);
            background: var(--primary-color);
            box-shadow: var(--shadow-sm);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .combo-number:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        /* –¶–≤–µ—Ç–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è —Ç—Ä–µ–Ω–¥–æ–≤ –≤ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è—Ö */
        .combo-number.trend-up-high {
            background: var(--trend-hot-high); /* –ö—Ä–∞—Å–Ω—ã–π - –æ—á–µ–Ω—å –≥–æ—Ä—è—á–∏–π */
        }
        .combo-number.trend-up {
            background: var(--trend-hot); /* –û—Ä–∞–Ω–∂–µ–≤—ã–π - –≥–æ—Ä—è—á–∏–π */
        }
        .combo-number.trend-stable {
            background: var(--trend-stable); /* –°–µ—Ä—ã–π - —Å—Ç–∞–±–∏–ª—å–Ω—ã–π */
        }
        .combo-number.trend-down {
            background: var(--trend-cold); /* –ó–µ–ª–µ–Ω—ã–π - —Ö–æ–ª–æ–¥–Ω—ã–π */
        }
        .combo-number.trend-down-low {
            background: var(--trend-cold-low); /* –°–∏–Ω–∏–π - –æ—á–µ–Ω—å —Ö–æ–ª–æ–¥–Ω—ã–π */
        }
        .long-term-info {
            margin-top: var(--space-lg);
            padding: var(--space-md);
            background: var(--primary-light);
            border-left: 4px solid var(--primary-color);
            border-radius: var(--radius-md);
        }
        .long-term-info h4 {
            margin-top: 0;
            color: var(--primary-color);
        }

        /* –ù–æ–≤—ã–π –¥–∏–∑–∞–π–Ω —Å—Ç—Ä–∞—Ç–µ–≥–∏–π */
        .strategy-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--space-lg);
            margin-bottom: var(--space-lg);
        }

        .strategy-card {
            background: var(--bg-white);
            border-radius: var(--radius-xl);
            padding: var(--space-lg);
            box-shadow: var(--shadow-md);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .strategy-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .strategy-card.selected {
            border-color: var(--primary-color);
            background: linear-gradient(135deg, var(--primary-light) 0%, var(--bg-white) 100%);
        }

        .strategy-header {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            margin-bottom: var(--space-md);
        }

        .strategy-icon {
            font-size: 2em;
        }

        .strategy-header h3 {
            margin: 0;
            color: var(--text-primary);
            font-size: 1.2em;
        }

        .strategy-stats {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: var(--space-sm);
            margin-bottom: var(--space-md);
        }

        .stat-item {
            text-align: center;
            padding: var(--space-xs);
            background: var(--bg-light);
            border-radius: var(--radius-md);
        }

        .stat-label {
            display: block;
            font-size: 0.8em;
            color: var(--text-muted);
            margin-bottom: 4px;
        }

        .stat-value {
            display: block;
            font-weight: bold;
            font-size: 1.1em;
        }

        .stat-value.low { color: var(--success); }
        .stat-value.medium { color: var(--warning); }
        .stat-value.high { color: var(--danger); }

        .strategy-desc {
            text-align: center;
            color: var(--text-muted);
            font-size: 0.9em;
            font-style: italic;
        }

        /* –î–∞—à–±–æ—Ä–¥ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ */
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-md);
        }

        .efficiency-display {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .efficiency-meter {
            width: 150px;
            height: 20px;
            background: var(--bg-gray);
            border-radius: var(--radius-lg);
            overflow: hidden;
        }

        .meter-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--success), var(--warning), var(--danger));
            transition: width 0.5s ease;
        }

        .meter-label {
            font-weight: 600;
            color: var(--text-primary);
        }

        .detailed-settings-wrapper {
            margin-top: var(--space-lg);
        }
        #detailed-settings {
            background: var(--bg-lighter);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-top: var(--space-md);
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: var(--space-lg);
        }
        .settings-block {
            background: var(--bg-white);
            padding: var(--space-md);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
        }
        .settings-block h4 {
            margin-top: 0;
            margin-bottom: var(--space-lg);
            color: var(--text-primary);
            border-bottom: 1px solid var(--bg-lighter);
            padding-bottom: var(--space-sm);
        }
        .setting-item {
            margin-bottom: var(--space-md);
        }
        .setting-item label {
            display: block;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: var(--space-xs);
        }
        .setting-item input[type="range"] {
            width: 100%;
        }
        .setting-item-inline {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: var(--space-xs);
            width: 100%;
        }
        .setting-item-inline .small-input {
            width: 70px;
            padding: var(--space-xs);
            border: 2px solid var(--bg-lighter);
            border-radius: var(--radius-md);
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Å–µ–ª–µ–∫—Ç–∞ –≤ –≤–∏–¥–µ –∫–Ω–æ–ø–∫–∏ */
        .custom-select-btn {
            background: var(--primary-gradient);
            color: var(--text-light);
            border: none;
            padding: 12px 35px 12px 15px; /* –û—Ç—Å—Ç—É–ø —Å–ø—Ä–∞–≤–∞ –¥–ª—è —Å—Ç—Ä–µ–ª–∫–∏ */
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            /* –ò–∫–æ–Ω–∫–∞ —Å—Ç—Ä–µ–ª–∫–∏ */
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 1.2em;
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –æ–ø—Ü–∏–π –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞, —á—Ç–æ–±—ã —Ç–µ–∫—Å—Ç –±—ã–ª —á–∏—Ç–∞–µ–º—ã–º */
        .custom-select-btn option {
            background: white;
            color: black;
        }

        /* –£–±–∏—Ä–∞–µ–º —Å—Ç—Ä–µ–ª–∫–∏ –≤ number input –ø–æ–ª—è—Ö –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ */
        #customNum1::-webkit-outer-spin-button,
        #customNum1::-webkit-inner-spin-button,
        #customNum2::-webkit-outer-spin-button,
        #customNum2::-webkit-inner-spin-button,
        #customNum3::-webkit-outer-spin-button,
        #customNum3::-webkit-inner-spin-button,
        #customNum4::-webkit-outer-spin-button,
        #customNum4::-webkit-inner-spin-button,
        #customNum5::-webkit-outer-spin-button,
        #customNum5::-webkit-inner-spin-button,
        #customNum6::-webkit-outer-spin-button,
        #customNum6::-webkit-inner-spin-button {
            -webkit-appearance: none !important;
            margin: 0 !important;
            display: none !important;
        }

        #customNum1, #customNum2, #customNum3, #customNum4, #customNum5, #customNum6 {
            -webkit-appearance: none !important; /* –î–ª—è Safari –∏ Chrome */
            -moz-appearance: textfield !important; /* –î–ª—è Firefox */
            appearance: none !important; /* –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ */
        }

        /* –¶–≤–µ—Ç–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è —Ç—Ä–µ–Ω–¥–æ–≤ –≤ –ø–æ–ª—è—Ö –≤–≤–æ–¥–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ */
        #customNum1.trend-up-high, #customNum2.trend-up-high, #customNum3.trend-up-high,
        #customNum4.trend-up-high, #customNum5.trend-up-high, #customNum6.trend-up-high {
            background: linear-gradient(135deg, var(--trend-hot-high) 0%, #ff6666 100%) !important;
            color: var(--text-light) !important;
            border-color: var(--trend-hot-high) !important;
        }

        #customNum1.trend-up, #customNum2.trend-up, #customNum3.trend-up,
        #customNum4.trend-up, #customNum5.trend-up, #customNum6.trend-up {
            background: linear-gradient(135deg, var(--trend-hot) 0%, #ffaa44 100%) !important;
            color: var(--text-light) !important;
            border-color: var(--trend-hot) !important;
        }

        #customNum1.trend-stable, #customNum2.trend-stable, #customNum3.trend-stable,
        #customNum4.trend-stable, #customNum5.trend-stable, #customNum6.trend-stable {
            background: linear-gradient(135deg, var(--trend-stable) 0%, #aaaaaa 100%) !important;
            color: var(--text-light) !important;
            border-color: var(--trend-stable) !important;
        }

        #customNum1.trend-down, #customNum2.trend-down, #customNum3.trend-down,
        #customNum4.trend-down, #customNum5.trend-down, #customNum6.trend-down {
            background: linear-gradient(135deg, var(--trend-cold) 0%, #66cc66 100%) !important;
            color: var(--text-light) !important;
            border-color: var(--trend-cold) !important;
        }

        #customNum1.trend-down-low, #customNum2.trend-down-low, #customNum3.trend-down-low,
        #customNum4.trend-down-low, #customNum5.trend-down-low, #customNum6.trend-down-low {
            background: linear-gradient(135deg, var(--trend-cold-low) 0%, #4488cc 100%) !important;
            color: var(--text-light) !important;
            border-color: var(--trend-cold-low) !important;
        }

        /* –£–±–µ–∂–¥–∞–µ–º—Å—è —á—Ç–æ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –∏—Å—á–µ–∑–∞—é—Ç –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ */
        #customNum1:focus::placeholder,
        #customNum2:focus::placeholder,
        #customNum3:focus::placeholder,
        #customNum4:focus::placeholder,
        #customNum5:focus::placeholder,
        #customNum6:focus::placeholder {
            color: transparent !important;
        }

        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —É–±–∏—Ä–∞–Ω–∏—è —Å—Ç—Ä–µ–ª–æ–∫ */
        #customNum1::-webkit-outer-spin-button,
        #customNum1::-webkit-inner-spin-button,
        #customNum2::-webkit-outer-spin-button,
        #customNum2::-webkit-inner-spin-button,
        #customNum3::-webkit-outer-spin-button,
        #customNum3::-webkit-inner-spin-button,
        #customNum4::-webkit-outer-spin-button,
        #customNum4::-webkit-inner-spin-button,
        #customNum5::-webkit-outer-spin-button,
        #customNum5::-webkit-inner-spin-button,
        #customNum6::-webkit-outer-spin-button,
        #customNum6::-webkit-inner-spin-button {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            margin: 0;
            display: none;
        }

    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –õ–æ—Ç–µ—Ä–µ–∏</h1>
            <p>–ì—Ä–∞—Ñ–∏–∫–∏ –¥–≤–∏–∂–µ–Ω–∏—è –Ω–æ–º–µ—Ä–æ–≤ –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑</p>
        </div>

        <div class="section-card">
            <div class="section-card-header" style="text-align: center;">
                <h2 class="section-card-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏</h2>
            </div>
            
            <div class="form-group">
                <label for="newDate">–î–∞—Ç–∞ –Ω–æ–≤–æ–≥–æ —Ç–∏—Ä–∞–∂–∞:</label>
                <input type="date" id="newDate" required>
            </div>
            
            <div class="form-group">
                <label for="newDrawNumber">–ù–æ–º–µ—Ä —Ç–∏—Ä–∞–∂–∞:</label>
                <input type="number" id="newDrawNumber" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 7246" required>
            </div>
            
            <div class="form-group">
                <label for="newNumbers">–í—ã–∏–≥—Ä—ã—à–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é –∏–ª–∏ –ø—Ä–æ–±–µ–ª):</label>
                <input type="text" id="newNumbers" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 1, 15, 23, 34, 42, 49 –∏–ª–∏ 1 15 23 34 42 49" required>
            </div>
            
            <div class="action-buttons">
                <button class="btn cold-btn" onclick="addNewDraw()">–î–æ–±–∞–≤–∏—Ç—å —Ç–∏—Ä–∞–∂</button>
                <button class="btn cold-btn" onclick="loadData()">–û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
                <button class="btn cold-btn" onclick="toggleEditDraws()">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–∏—Ä–∞–∂–∏</button>
            </div>
        </div>

        <div id="editDrawsSection" class="section-card" style="display:none;">
            <div class="section-card-header" style="text-align: center;">
                <h2 class="section-card-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∏—Ä–∞–∂–µ–π</h2>
            </div>
            <div id="drawsList"></div>
            <button class="btn cold-btn" onclick="toggleEditDraws()" style="margin-top: var(--space-md);">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>


        <div class="section-card">
            <div class="section-card-header" style="text-align: center;">
                <h2 class="section-card-title">–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</h2>
            </div>
            
            <div class="legend-card">
                <div class="legend-grid">
                    <div class="legend-item" title="–ù–æ–º–µ—Ä –≤—ã–ø–∞–¥–∞–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —á–∞—â–µ —Å—Ä–µ–¥–Ω–µ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞">
                        <div class="legend-badge legend-badge--hot-high">
                            <span class="legend-pulse"></span>
                        </div>
                        <span class="legend-label legend-label--hot-high">–û—á–µ–Ω—å –≥–æ—Ä—è—á–∏–π</span>
                        <span class="legend-description">–ß–∞—Å—Ç–æ –≤—ã–ø–∞–¥–∞–µ—Ç</span>
                    </div>
                    <div class="legend-item" title="–ù–æ–º–µ—Ä –≤—ã–ø–∞–¥–∞–µ—Ç —á–∞—â–µ —Å—Ä–µ–¥–Ω–µ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞">
                        <div class="legend-badge legend-badge--hot"></div>
                        <span class="legend-label legend-label--hot">–ì–æ—Ä—è—á–∏–π</span>
                        <span class="legend-description">–í—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ</span>
                    </div>
                    <div class="legend-item" title="–ù–æ–º–µ—Ä –≤—ã–ø–∞–¥–∞–µ—Ç –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Å—Ä–µ–¥–Ω–µ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞">
                        <div class="legend-badge legend-badge--stable"></div>
                        <span class="legend-label legend-label--stable">–°—Ç–∞–±–∏–ª—å–Ω—ã–π</span>
                        <span class="legend-description">–°—Ä–µ–¥–Ω—è—è —á–∞—Å—Ç–æ—Ç–∞</span>
                    </div>
                    <div class="legend-item" title="–ù–æ–º–µ—Ä –≤—ã–ø–∞–¥–∞–µ—Ç —Ä–µ–∂–µ —Å—Ä–µ–¥–Ω–µ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞">
                        <div class="legend-badge legend-badge--cold"></div>
                        <span class="legend-label legend-label--cold">–•–æ–ª–æ–¥–Ω—ã–π</span>
                        <span class="legend-description">–ù–∏–∂–µ —Å—Ä–µ–¥–Ω–µ–≥–æ</span>
                    </div>
                    <div class="legend-item" title="–ù–æ–º–µ—Ä –≤—ã–ø–∞–¥–∞–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Ä–µ–∂–µ —Å—Ä–µ–¥–Ω–µ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞">
                        <div class="legend-badge legend-badge--cold-low"></div>
                        <span class="legend-label legend-label--cold-low">–û—á–µ–Ω—å —Ö–æ–ª–æ–¥–Ω—ã–π</span>
                        <span class="legend-description">–†–µ–¥–∫–æ –≤—ã–ø–∞–¥–∞–µ—Ç</span>
                    </div>
                </div>
                <div class="legend-info">
                    <strong>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–æ–º–µ—Ä–∞</strong> ‚Äî –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–æ–º–µ—Ä–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Ç–∏—Ä–∞–∂–µ–π –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ä–µ–¥–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è.
                </div>
            </div>
            
            <!-- CSS –∞–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –ø—É–ª—å—Å–∞—Ü–∏–∏ -->
            <style>
                @keyframes pulse {
                    0% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
                    50% { opacity: 0.3; transform: translate(-50%, -50%) scale(1.2); }
                    100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
                }
            </style>
            
            <div class="number-selector" id="numberSelector">
                <!-- –ù–æ–º–µ—Ä–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </section>

        <div class="chart-container" id="chartContainer" style="display: none;">
            <h2 id="chartTitle" style="text-align: center; font-size: 1.8em; font-weight: 700; color: var(--primary-color); margin-bottom: 25px; text-shadow: 1px 1px 2px rgba(0,0,0,0.1);">–ì—Ä–∞—Ñ–∏–∫ –Ω–æ–º–µ—Ä–∞</h2>
            <div class="chart-wrapper">
                <canvas id="numberChart"></canvas>
            </div>
            
            
            </div>

        <div class="observation-panel" id="portrait-panel" style="display: none;">
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –ø–æ—Ä—Ç—Ä–µ—Ç –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
        </div>

        <!-- –†–∞–∑–¥–µ–ª –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ -->
        <div class="section-card" id="custom-combination-panel">
            <div class="section-card-header">
                <h2 class="section-card-title">üé≤ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤–æ—é –∫–æ–º–±–∏–Ω–∞—Ü–∏—é</h2>
                <p class="section-subtitle">–í–≤–µ–¥–∏—Ç–µ —à–µ—Å—Ç—å —á–∏—Å–µ–ª –æ—Ç 1 –¥–æ 49 –∏ –ø–æ–ª—É—á–∏—Ç–µ –∏—Ö –æ—Ü–µ–Ω–∫—É</p>
            </div>

            <!-- –û—Å–Ω–æ–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å –≤–≤–æ–¥–∞ -->
            <div style="background: linear-gradient(135deg, var(--bg-white) 0%, var(--bg-light) 100%); border-radius: var(--radius-lg); padding: var(--space-xl); box-shadow: var(--shadow-md); border: 1px solid var(--bg-gray); margin-bottom: var(--space-lg);">
                
                <!-- –ï–¥–∏–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º, –ø–æ–ª—è–º–∏ –≤–≤–æ–¥–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ -->
                <div style="display: flex; align-items: center; gap: var(--space-lg); flex-wrap: wrap; justify-content: center;">
                    
                    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –ø–æ–ª—è –≤–≤–æ–¥–∞ -->
                    <div style="display: flex; align-items: center; gap: var(--space-md);">
                        <div style="width: 35px; height: 35px; background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 18px; font-weight: bold;">üé≤</div>
                        <div style="text-align: center;">
                            <h3 style="margin: 0 0 var(--space-xs) 0; font-size: 1.2em; font-weight: 700; color: var(--text-primary); white-space: nowrap;">6 —á–∏—Å–µ–ª:</h3>
                            <span style="font-size: 13px; color: var(--text-muted);">–ß–∏—Å–ª–∞ –æ—Ç 1 –¥–æ 49</span>
                        </div>

                        <div style="display: flex; gap: var(--space-sm);">
                            <input type="text" id="customNum1" placeholder="1" style="width: 50px; height: 50px; text-align: center; font-size: 18px; font-weight: 700; border: 2px solid var(--bg-lighter); border-radius: var(--radius-md); transition: all 0.3s ease; background: var(--bg-white); box-shadow: var(--shadow-sm);"
                                   onfocus="this.style.borderColor='var(--primary-color)'; this.style.transform='scale(1.05)'"
                                   onblur="this.style.borderColor='var(--bg-lighter)'; this.style.transform='scale(1)'"
                                   oninput="this.value = this.value.replace(/[^0-9]/g, '').substring(0, 2); validateCombinationInput(this);">
                            <input type="text" id="customNum2" placeholder="2" style="width: 50px; height: 50px; text-align: center; font-size: 18px; font-weight: 700; border: 2px solid var(--bg-lighter); border-radius: var(--radius-md); transition: all 0.3s ease; background: var(--bg-white); box-shadow: var(--shadow-sm);"
                                   onfocus="this.style.borderColor='var(--primary-color)'; this.style.transform='scale(1.05)'"
                                   onblur="this.style.borderColor='var(--bg-lighter)'; this.style.transform='scale(1)'"
                                   oninput="this.value = this.value.replace(/[^0-9]/g, '').substring(0, 2); validateCombinationInput(this);">
                            <input type="text" id="customNum3" placeholder="3" style="width: 50px; height: 50px; text-align: center; font-size: 18px; font-weight: 700; border: 2px solid var(--bg-lighter); border-radius: var(--radius-md); transition: all 0.3s ease; background: var(--bg-white); box-shadow: var(--shadow-sm);"
                                   onfocus="this.style.borderColor='var(--primary-color)'; this.style.transform='scale(1.05)'"
                                   onblur="this.style.borderColor='var(--bg-lighter)'; this.style.transform='scale(1)'"
                                   oninput="this.value = this.value.replace(/[^0-9]/g, '').substring(0, 2); validateCombinationInput(this);">
                            <input type="text" id="customNum4" placeholder="4" style="width: 50px; height: 50px; text-align: center; font-size: 18px; font-weight: 700; border: 2px solid var(--bg-lighter); border-radius: var(--radius-md); transition: all 0.3s ease; background: var(--bg-white); box-shadow: var(--shadow-sm);"
                                   onfocus="this.style.borderColor='var(--primary-color)'; this.style.transform='scale(1.05)'"
                                   onblur="this.style.borderColor='var(--bg-lighter)'; this.style.transform='scale(1)'"
                                   oninput="this.value = this.value.replace(/[^0-9]/g, '').substring(0, 2); validateCombinationInput(this);">
                            <input type="text" id="customNum5" placeholder="5" style="width: 50px; height: 50px; text-align: center; font-size: 18px; font-weight: 700; border: 2px solid var(--bg-lighter); border-radius: var(--radius-md); transition: all 0.3s ease; background: var(--bg-white); box-shadow: var(--shadow-sm);"
                                   onfocus="this.style.borderColor='var(--primary-color)'; this.style.transform='scale(1.05)'"
                                   onblur="this.style.borderColor='var(--bg-lighter)'; this.style.transform='scale(1)'"
                                   oninput="this.value = this.value.replace(/[^0-9]/g, '').substring(0, 2); validateCombinationInput(this);">
                            <input type="text" id="customNum6" min="1" max="49" placeholder="6" style="width: 50px; height: 50px; text-align: center; font-size: 18px; font-weight: 700; border: 2px solid var(--bg-lighter); border-radius: var(--radius-md); transition: all 0.3s ease; background: var(--bg-white); box-shadow: var(--shadow-sm);"
                                   onfocus="this.style.borderColor='var(--primary-color)'; this.style.transform='scale(1.05)'"
                                   onblur="this.style.borderColor='var(--bg-lighter)'; this.style.transform='scale(1)'"
                                   oninput="this.value = this.value.replace(/[^0-9]/g, '').substring(0, 2); validateCombinationInput(this);">
                        </div>
                    </div>

                    <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –∫–Ω–æ–ø–∫–∞ -->
                    <div style="display: flex; align-items: center; gap: var(--space-md);">

                        <!-- –ö–Ω–æ–ø–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ -->
                        <button class="btn cold-btn" onclick="testCustomCombination()" style="height: 45px; padding: 0 var(--space-lg); font-size: 16px; font-weight: 600; border-radius: var(--radius-md); background: linear-gradient(135deg, var(--trend-cold-low) 0%, #4488cc 100%); position: relative; overflow: hidden; display: flex; align-items: center;">
                            –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞
                        </button>

                        <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–∏—Ä–∞–∂–µ–π -->
                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                            <select id="customTestTirageCount" style="width: 160px; height: 45px; padding: var(--space-sm) var(--space-md); background: var(--bg-white); color: var(--text-primary); border: 2px solid var(--primary-color); border-radius: var(--radius-md); font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;"
                                    onmouseover="this.style.borderColor='var(--primary-dark)'"
                                    onmouseout="this.style.borderColor='var(--primary-color)'">
                            <option value="10">10 —Ç–∏—Ä–∞–∂–∞—Ö</option>
                            <option value="20" selected>20 —Ç–∏—Ä–∞–∂–∞—Ö</option>
                            <option value="30">30 —Ç–∏—Ä–∞–∂–∞—Ö</option>
                            <option value="50">50 —Ç–∏—Ä–∞–∂–∞—Ö</option>
                            <option value="100">100 —Ç–∏—Ä–∞–∂–∞—Ö</option>
                        </select>
                    </div>
                    </div>
                </div>
            </div>

            <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
            <div id="custom-results-container"></div>

        </div>

        <div class="section-card" id="generator-panel">
            <div class="section-card-header">
                <h2 class="section-card-title">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏</h2>
            </div>

            <!-- –ù–æ–≤—ã–π –≤–∏–∑—É–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–π -->
            <div class="strategy-selection">
                <div class="strategy-card" data-strategy="conservative" onclick="selectStrategy('conservative')">
                    <div class="strategy-header">
                        <span class="strategy-icon">üõ°Ô∏è</span>
                        <h3>–ö–û–ù–°–ï–†–í–ê–¢–ò–í–ù–ê–Ø</h3>
                    </div>
                    <div class="strategy-stats">
                        <div class="stat-item">
                            <span class="stat-label">–†–ò–°–ö:</span>
                            <span class="stat-value low">–ù–ò–ó–ö–ò–ô</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">–®–ê–ù–°:</span>
                            <span class="stat-value">40%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">–¢–ï–°–¢:</span>
                            <span class="stat-value high">85%</span>
                        </div>
                    </div>
                    <div class="strategy-desc">–°—Ç–∞–±–∏–ª—å–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ —Å –Ω–∏–∑–∫–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å—é</div>
        </div>

                <div class="strategy-card" data-strategy="balanced" onclick="selectStrategy('balanced')">
                    <div class="strategy-header">
                        <span class="strategy-icon">‚öñÔ∏è</span>
                        <h3>–°–ë–ê–õ–ê–ù–°–ò–†–û–í–ê–ù–ù–ê–Ø</h3>
                        </div>
                    <div class="strategy-stats">
                        <div class="stat-item">
                            <span class="stat-label">–†–ò–°–ö:</span>
                            <span class="stat-value medium">–°–†–ï–î–ù–ò–ô</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">–®–ê–ù–°:</span>
                            <span class="stat-value">60%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">–¢–ï–°–¢:</span>
                            <span class="stat-value high">78%</span>
                        </div>
                        </div>
                    <div class="strategy-desc">–õ—É—á—à–∏–π –±–∞–ª–∞–Ω—Å —Ä–∏—Å–∫–∞ –∏ —à–∞–Ω—Å–∞ –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ–π –∏–≥—Ä—ã</div>
                    </div>

                <div class="strategy-card" data-strategy="ai" onclick="selectStrategy('ai')">
                    <div class="strategy-header">
                        <span class="strategy-icon">ü§ñ</span>
                        <h3>–ò–ò-–ü–†–ï–î–°–ö–ê–ó–ê–ù–ò–ï</h3>
                        </div>
                    <div class="strategy-stats">
                        <div class="stat-item">
                            <span class="stat-label">–†–ò–°–ö:</span>
                            <span class="stat-value medium">–°–†–ï–î–ù–ò–ô</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">–®–ê–ù–°:</span>
                            <span class="stat-value">85%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">–¢–ï–°–¢:</span>
                            <span class="stat-value high">92%</span>
                        </div>
                    </div>
                    <div class="strategy-desc">–°–∞–º–æ–æ–±—É—á–∞—é—â–∏–π—Å—è –ò–ò –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</div>
                        </div>
                    </div>


            <!-- –≠—Ç–æ—Ç –±–ª–æ–∫ –±—É–¥–µ—Ç —Å–∫—Ä—ã—Ç -->
            <div id="strategy-dashboard" style="display: none !important;"></div>

            <!-- –ù–æ–≤—ã–π –±–ª–æ–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∏ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ -->
            <div id="generation-controls" style="display: flex; margin-top: 20px; align-items: center; gap: 15px; flex-wrap: wrap;">
                <button class="btn cold-btn" id="generate-btn" onclick="generateSelectedStrategy()" style="height: 40px; padding: 0 20px; font-size: 14px; background: linear-gradient(135deg, var(--trend-cold-low) 0%, #4488cc 100%); position: relative; overflow: hidden;">
                    üöÄ –°–ì–ï–ù–ï–†–ò–†–û–í–ê–¢–¨ –ö–û–ú–ë–ò–ù–ê–¶–ò–ò
                </button>

                <div style="display: flex; align-items: center; gap: 10px;">
                    <label for="testTirageCount" style="font-weight: 600; color: var(--text-secondary); font-size: 14px; white-space: nowrap;">–¢–µ—Å—Ç –Ω–∞ —Ç–∏—Ä–∞–∂–∞—Ö:</label>
                    <select id="testTirageCount" onchange="updateQuickSummary()" style="width: 180px; height: 40px; padding: 8px 12px; background: var(--bg-white); color: var(--text-primary); border: 2px solid var(--primary-color); border-radius: var(--radius-md); font-size: 14px; font-weight: 600; -webkit-appearance: none; -moz-appearance: none; appearance: none; background-image: url('data:image/svg+xml,%3Csvg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;%23667eea&quot;%3E%3Cpath d=&quot;M7 10l5 5 5-5z&quot;/%3E%3C/svg%3E'); background-repeat: no-repeat; background-position: right 10px center; background-size: 1.2em;">
                        <option value="10">10 —Ç–∏—Ä–∞–∂–∞—Ö</option>
                        <option value="20" selected>20 —Ç–∏—Ä–∞–∂–∞—Ö</option>
                        <option value="30">30 —Ç–∏—Ä–∞–∂–∞—Ö</option>
                        <option value="50">50 —Ç–∏—Ä–∞–∂–∞—Ö</option>
                        <option value="100">100 —Ç–∏—Ä–∞–∂–∞—Ö</option>
                </select>
                    </div>

                <div style="display: flex; align-items: center; gap: 10px;">
                    <label for="numCombinations" style="font-weight: 600; color: var(--text-secondary); font-size: 14px; white-space: nowrap;">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π:</label>
                    <input type="number" id="numCombinations" value="8" min="1" max="50" style="width: 80px; height: 40px; padding: 8px 12px; background: var(--bg-white); color: var(--text-primary); border: 2px solid var(--primary-color); border-radius: var(--radius-md); font-size: 14px; font-weight: 600; text-align: center;">
            </div>
        </div>

            <div id="generator-results-container"></div>


    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let lottoData = null;
        let currentChart = null;
        let selectedNumber = null;
        let selectedStrategy = null;

        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
        window.lastGeneratedCombinations = null;
        window.lastGeneratedStrategy = null;

        // ===============================================================================================
        // –¢–ï–°–¢–û–í–´–ï –§–£–ù–ö–¶–ò–ò
        // ===============================================================================================

        // –¢–µ—Å—Ç–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ analyzeClusterBehavior
        window.testClusterBehavior = function() {
            console.log('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ analyzeClusterBehavior...');
            const clusterBonuses = analyzeClusterBehavior(lottoData);
            console.log('–†–µ–∑—É–ª—å—Ç–∞—Ç:', Object.keys(clusterBonuses).length, '–Ω–æ–º–µ—Ä–æ–≤ —Å –±–æ–Ω—É—Å–∞–º–∏');
            return clusterBonuses;
        };

        // –¢–µ—Å—Ç–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ getSmartTargetNumbers
        window.testSmartTargets = function() {
            console.log('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ getSmartTargetNumbers...');
            const targets = getSmartTargetNumbers(15, lottoData);
            console.log('–¢–æ–ø-10 —Ü–µ–ª–µ–π:', targets.slice(0, 10));
            return targets;
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            createNumberSelector();
            loadData();
            updateNumberTrends();


            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
            document.getElementById('numCombinations').addEventListener('change', function() {
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
                updateStrategyCardsEfficiency();
            });

            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∏–ª—è –ø–æ–ª–µ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –ø—Ä–∏ –≤–≤–æ–¥–µ
            for (let i = 1; i <= 6; i++) {
                const inputField = document.getElementById(`customNum${i}`);
                inputField.addEventListener('blur', function() {
                    validateCombinationInput(this);
                });
            }
        });

        // –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ –Ω–æ–º–µ—Ä–æ–≤
        function createNumberSelector() {
            const selector = document.getElementById('numberSelector');
            for (let i = 1; i <= 49; i++) {
                const btn = document.createElement('div');
                btn.className = 'number-btn';
                btn.textContent = i;
                btn.onclick = () => selectNumber(i);

                // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π —É–≥–æ–ª–æ–∫ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —á–∏—Å–ª–∞ –≤ –∫–æ–º–±–∏–Ω–∞—Ü–∏—é
                const cornerBtn = document.createElement('div');
                cornerBtn.className = 'corner-btn';
                cornerBtn.innerHTML = '‚ñº';
                cornerBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    addNumberToCombination(i);
                });
                btn.appendChild(cornerBtn);

                selector.appendChild(btn);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —á–∏—Å–ª–∞ –≤ –∫–æ–º–±–∏–Ω–∞—Ü–∏—é
        function addNumberToCombination(number) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –ª–∏ —á–∏—Å–ª–æ –≤ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
            if (isNumberInCombination(number)) {
                showError(`–ß–∏—Å–ª–æ ${number} —É–∂–µ –µ—Å—Ç—å –≤ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏! –í –ª–æ—Ç–µ—Ä–µ–µ —á–∏—Å–ª–∞ –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è.`);
                return;
            }

            // –ù–∞—Ö–æ–¥–∏–º –ø–µ—Ä–≤–æ–µ –ø—É—Å—Ç–æ–µ –ø–æ–ª–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
            for (let i = 1; i <= 6; i++) {
                const inputField = document.getElementById(`customNum${i}`);
                if (!inputField.value.trim()) {
                    inputField.value = number;

                    // –î–æ–±–∞–≤–ª—è–µ–º –≤–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —á–∏—Å–ª–∞
                    inputField.style.transform = 'scale(1.1)';
                    inputField.style.borderColor = 'var(--primary-color)';
                    inputField.style.boxShadow = '0 0 10px rgba(102, 51, 153, 0.3)';

                    setTimeout(() => {
                        inputField.style.transform = 'scale(1)';
                        inputField.style.borderColor = 'var(--bg-lighter)';
                        inputField.style.boxShadow = 'var(--shadow-sm)';
                    }, 300);

                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è —Ü–≤–µ—Ç–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–∏ —Ç—Ä–µ–Ω–¥–æ–≤
                    updateCombinationFieldStyles();

                    showSuccess(`–ß–∏—Å–ª–æ ${number} –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∫–æ–º–±–∏–Ω–∞—Ü–∏—é`);
                    return;
                }
            }

            // –ï—Å–ª–∏ –≤—Å–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
            showSuccess('–í—Å–µ –ø–æ–ª—è –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã. –û—á–∏—Å—Ç–∏—Ç–µ –ø–æ–ª—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —á–∏—Å–µ–ª.');
        }

        // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è —á–∏—Å–ª–∞ –≤ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
        function isNumberInCombination(number) {
            for (let i = 1; i <= 6; i++) {
                const inputField = document.getElementById(`customNum${i}`);
                const existingNumber = parseInt(inputField.value.trim());
                if (existingNumber === number) {
                    return true;
                }
            }
            return false;
        }

        // –§—É–Ω–∫—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø—Ä–∏ –≤–≤–æ–¥–µ –≤ –ø–æ–ª—è –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
        function validateCombinationInput(inputField) {
            const number = parseInt(inputField.value.trim());

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –≤–≤–µ–¥–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —á–∏—Å–ª–æ–º
            if (inputField.value.trim() && (isNaN(number) || number < 1 || number > 49)) {
                showError('–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 49');
                inputField.value = '';
                inputField.focus();
                return;
            }

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª–µ –Ω–µ –ø—É—Å—Ç–æ–µ –∏ —á–∏—Å–ª–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ
            if (number && number >= 1 && number <= 49) {
                const duplicateField = findDuplicateNumberField(number, inputField);
                if (duplicateField) {
                    showError(`–ß–∏—Å–ª–æ ${number} —É–∂–µ –µ—Å—Ç—å –≤ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏! –í –ª–æ—Ç–µ—Ä–µ–µ —á–∏—Å–ª–∞ –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è.`);
                    inputField.value = '';
                    inputField.focus();
                    return;
                }
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –ø–æ—Å–ª–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
            updateCombinationFieldStyles();
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞ –ø–æ–ª—è —Å –¥—É–±–ª–∏—Ä—É—é—â–∏–º—Å—è —á–∏—Å–ª–æ–º
        function findDuplicateNumberField(number, excludeField) {
            for (let i = 1; i <= 6; i++) {
                const field = document.getElementById(`customNum${i}`);
                if (field !== excludeField && field.value.trim()) {
                    const existingNumber = parseInt(field.value.trim());
                    if (existingNumber === number) {
                        return field;
                    }
                }
            }
            return null;
        }


        // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ç–µ–∫—É—â–µ–µ –ø–æ–ª–µ –ø—É—Å—Ç—ã–º
        function isCurrentFieldEmpty(inputField) {
            return !inputField.value.trim();
        }


        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∏–ª—è –ø–æ–ª–µ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç—Ä–µ–Ω–¥–æ–≤
        function updateCombinationFieldStyles() {
            for (let i = 1; i <= 6; i++) {
                const inputField = document.getElementById(`customNum${i}`);
                const number = parseInt(inputField.value.trim());

                if (number && number >= 1 && number <= 49) {
                    const trend = calculateNumberTrend(number);
                    const trendClass = getTrendClass(trend.status);

                    // –£–±–∏—Ä–∞–µ–º –≤—Å–µ –∫–ª–∞—Å—Å—ã —Ç—Ä–µ–Ω–¥–æ–≤
                    inputField.classList.remove('trend-up-high', 'trend-up', 'trend-stable', 'trend-down', 'trend-down-low');

                    // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∫–ª–∞—Å—Å —Ç—Ä–µ–Ω–¥–∞
                    if (trendClass) {
                        inputField.classList.add(trendClass);
                    }

                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è —Ü–≤–µ—Ç–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–∏
                    applyTrendStyling(inputField, trend.status);
                } else {
                    // –£–±–∏—Ä–∞–µ–º —Å—Ç–∏–ª–∏ —Ç—Ä–µ–Ω–¥–æ–≤ –¥–ª—è –ø—É—Å—Ç—ã—Ö –ø–æ–ª–µ–π
                    inputField.classList.remove('trend-up-high', 'trend-up', 'trend-stable', 'trend-down', 'trend-down-low');
                    inputField.style.background = 'var(--bg-white)';
                    inputField.style.color = 'var(--text-primary)';
                    inputField.style.borderColor = 'var(--bg-lighter)';
                }
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∏–ª–µ–π —Ç—Ä–µ–Ω–¥–æ–≤ –∫ –ø–æ–ª—é –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
        function applyTrendStyling(element, trendStatus) {
            switch (trendStatus) {
                case 'up-high':
                    element.style.background = 'linear-gradient(135deg, var(--trend-hot-high) 0%, #ff6666 100%)';
                    element.style.color = 'var(--text-light)';
                    element.style.borderColor = 'var(--trend-hot-high)';
                    break;
                case 'up':
                    element.style.background = 'linear-gradient(135deg, var(--trend-hot) 0%, #ffaa44 100%)';
                    element.style.color = 'var(--text-light)';
                    element.style.borderColor = 'var(--trend-hot)';
                    break;
                case 'stable':
                    element.style.background = 'linear-gradient(135deg, var(--trend-stable) 0%, #aaaaaa 100%)';
                    element.style.color = 'var(--text-light)';
                    element.style.borderColor = 'var(--trend-stable)';
                    break;
                case 'down':
                    element.style.background = 'linear-gradient(135deg, var(--trend-cold) 0%, #66cc66 100%)';
                    element.style.color = 'var(--text-light)';
                    element.style.borderColor = 'var(--trend-cold)';
                    break;
                case 'down-low':
                    element.style.background = 'linear-gradient(135deg, var(--trend-cold-low) 0%, #4488cc 100%)';
                    element.style.color = 'var(--text-light)';
                    element.style.borderColor = 'var(--trend-cold-low)';
                    break;
                default:
                    element.style.background = 'var(--bg-white)';
                    element.style.color = 'var(--text-primary)';
                    element.style.borderColor = 'var(--bg-lighter)';
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è CSS –∫–ª–∞—Å—Å–∞ –¥–ª—è —Ç—Ä–µ–Ω–¥–∞
        function getTrendClass(trendStatus) {
            switch (trendStatus) {
                case 'up-high': return 'trend-up-high';
                case 'up': return 'trend-up';
                case 'stable': return 'trend-stable';
                case 'down': return 'trend-down';
                case 'down-low': return 'trend-down-low';
                default: return null;
            }
        }

        // –¢–µ—Å—Ç–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç—Ä–µ–Ω–¥–æ–≤ —Ä–∞–∑–Ω—ã—Ö —á–∏—Å–µ–ª
        function testTrendColors() {
            console.log('üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –¶–í–ï–¢–û–í –¢–†–ï–ù–î–û–í –î–õ–Ø –ü–û–õ–ï–ô –ö–û–ú–ë–ò–ù–ê–¶–ò–ò');

            // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–∞–∑–Ω—ã–µ —á–∏—Å–ª–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç—Ä–µ–Ω–¥–∞–º–∏
            const testNumbers = [1, 5, 10, 15, 20, 25, 30, 35, 40, 45];

            testNumbers.forEach(number => {
                const trend = calculateNumberTrend(number);
                console.log(`–ß–∏—Å–ª–æ ${number}: —Å—Ç–∞—Ç—É—Å = ${trend.status}, ratio = ${trend.ratio}`);

                // –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–µ –ø–æ–ª–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                const testInput = document.createElement('input');
                testInput.value = number;
                testInput.className = '';

                // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∏–ª–∏
                const trendClass = getTrendClass(trend.status);
                if (trendClass) {
                    testInput.classList.add(trendClass);
                }
                applyTrendStyling(testInput, trend.status);

                console.log(`  –ü—Ä–∏–º–µ–Ω–µ–Ω –∫–ª–∞—Å—Å: ${trendClass}`);
                console.log(`  –°—Ç–∏–ª—å —Ñ–æ–Ω–∞: ${testInput.style.background}`);
                console.log(`  –¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞: ${testInput.style.color}`);
                console.log('---');
            });
        }

        // –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ª–æ—Ç–µ—Ä–µ–∏
        const embeddedLottoData = {
            "draws": [
                {"date": "06.09.2025", "draw_number": "7245", "numbers": [15, 26, 33, 34, 38, 44]},
                {"date": "09.09.2025", "draw_number": "7246", "numbers": [5, 12, 18, 25, 36, 42]},
                {"date": "11.09.2025", "draw_number": "7247", "numbers": [3, 14, 22, 28, 35, 49]},
                {"date": "13.09.2025", "draw_number": "7248", "numbers": [7, 16, 23, 31, 38, 44]},
                {"date": "04.09.2025", "draw_number": "7244", "numbers": [2, 15, 27, 30, 37, 47]},
                {"date": "02.09.2025", "draw_number": "7243", "numbers": [12, 13, 14, 23, 33, 36]},
                {"date": "30.08.2025", "draw_number": "7242", "numbers": [14, 30, 32, 36, 40, 46]},
                {"date": "28.08.2025", "draw_number": "7241", "numbers": [11, 14, 18, 20, 30, 41]},
                {"date": "26.08.2025", "draw_number": "7240", "numbers": [10, 18, 22, 32, 36, 45]},
                {"date": "23.08.2025", "draw_number": "7239", "numbers": [6, 8, 19, 27, 28, 30]},
                {"date": "21.08.2025", "draw_number": "7238", "numbers": [7, 12, 24, 30, 32, 46]},
                {"date": "19.08.2025", "draw_number": "7237", "numbers": [3, 13, 34, 38, 40, 43]},
                {"date": "16.08.2025", "draw_number": "7236", "numbers": [17, 21, 22, 44, 45, 46]},
                {"date": "14.08.2025", "draw_number": "7235", "numbers": [3, 6, 13, 29, 43, 46]},
                {"date": "12.08.2025", "draw_number": "7234", "numbers": [3, 10, 12, 17, 23, 25]},
                {"date": "09.08.2025", "draw_number": "7233", "numbers": [3, 9, 13, 14, 17, 36]},
                {"date": "07.08.2025", "draw_number": "7232", "numbers": [5, 9, 30, 31, 43, 49]},
                {"date": "05.08.2025", "draw_number": "7231", "numbers": [5, 12, 14, 30, 36, 37]},
                {"date": "02.08.2025", "draw_number": "7230", "numbers": [2, 18, 20, 30, 39, 47]},
                {"date": "31.07.2025", "draw_number": "7229", "numbers": [12, 24, 25, 28, 32, 37]},
                {"date": "29.07.2025", "draw_number": "7228", "numbers": [10, 32, 34, 36, 37, 39]},
                {"date": "26.07.2025", "draw_number": "7227", "numbers": [19, 20, 21, 32, 42, 43]},
                {"date": "24.07.2025", "draw_number": "7226", "numbers": [24, 25, 33, 35, 38, 43]},
                {"date": "22.07.2025", "draw_number": "7225", "numbers": [10, 28, 35, 39, 41, 46]},
                {"date": "19.07.2025", "draw_number": "7224", "numbers": [7, 11, 15, 28, 32, 33]},
                {"date": "17.07.2025", "draw_number": "7223", "numbers": [2, 13, 21, 22, 29, 35]},
                {"date": "15.07.2025", "draw_number": "7222", "numbers": [17, 20, 23, 25, 28, 49]},
                {"date": "12.07.2025", "draw_number": "7221", "numbers": [2, 12, 17, 22, 34, 43]},
                {"date": "10.07.2025", "draw_number": "7220", "numbers": [6, 11, 14, 28, 46, 48]},
                {"date": "08.07.2025", "draw_number": "7219", "numbers": [3, 5, 12, 13, 24, 38]},
                {"date": "05.07.2025", "draw_number": "7218", "numbers": [13, 15, 28, 34, 37, 41]},
                {"date": "03.07.2025", "draw_number": "7217", "numbers": [1, 8, 24, 44, 46, 49]},
                {"date": "01.07.2025", "draw_number": "7216", "numbers": [11, 21, 23, 37, 44, 49]},
                {"date": "28.06.2025", "draw_number": "7215", "numbers": [12, 22, 23, 24, 32, 47]},
                {"date": "26.06.2025", "draw_number": "7214", "numbers": [5, 19, 21, 36, 39, 41]},
                {"date": "24.06.2025", "draw_number": "7213", "numbers": [3, 4, 11, 31, 41, 47]},
                {"date": "21.06.2025", "draw_number": "7212", "numbers": [12, 24, 30, 33, 43, 46]},
                {"date": "19.06.2025", "draw_number": "7211", "numbers": [16, 19, 30, 42, 44, 49]},
                {"date": "17.06.2025", "draw_number": "7210", "numbers": [24, 28, 30, 35, 43, 45]},
                {"date": "14.06.2025", "draw_number": "7209", "numbers": [7, 8, 21, 30, 39, 47]},
                {"date": "12.06.2025", "draw_number": "7208", "numbers": [6, 13, 17, 26, 34, 42]},
                {"date": "10.06.2025", "draw_number": "7207", "numbers": [16, 19, 28, 34, 39, 42]},
                {"date": "07.06.2025", "draw_number": "7206", "numbers": [23, 34, 35, 42, 44, 49]},
                {"date": "05.06.2025", "draw_number": "7205", "numbers": [1, 17, 21, 22, 26, 31]},
                {"date": "03.06.2025", "draw_number": "7204", "numbers": [10, 11, 12, 22, 25, 36]},
                {"date": "31.05.2025", "draw_number": "7203", "numbers": [18, 21, 22, 41, 42, 45]},
                {"date": "29.05.2025", "draw_number": "7202", "numbers": [5, 11, 33, 38, 44, 46]},
                {"date": "27.05.2025", "draw_number": "7201", "numbers": [7, 10, 17, 24, 33, 35]},
                {"date": "24.05.2025", "draw_number": "7200", "numbers": [4, 5, 11, 19, 30, 43]},
                {"date": "22.05.2025", "draw_number": "7199", "numbers": [18, 32, 39, 42, 44, 45]},
                {"date": "20.05.2025", "draw_number": "7198", "numbers": [15, 20, 25, 28, 45, 49]},
                {"date": "17.05.2025", "draw_number": "7197", "numbers": [2, 5, 25, 30, 32, 49]},
                {"date": "15.05.2025", "draw_number": "7196", "numbers": [7, 8, 17, 35, 36, 46]},
                {"date": "13.05.2025", "draw_number": "7195", "numbers": [8, 16, 18, 29, 33, 40]},
                {"date": "10.05.2025", "draw_number": "7194", "numbers": [5, 6, 9, 22, 36, 37]},
                {"date": "08.05.2025", "draw_number": "7193", "numbers": [5, 8, 9, 25, 35, 38]},
                {"date": "06.05.2025", "draw_number": "7192", "numbers": [9, 20, 31, 38, 42, 48]},
                {"date": "03.05.2025", "draw_number": "7191", "numbers": [1, 2, 6, 10, 28, 37]},
                {"date": "01.05.2025", "draw_number": "7190", "numbers": [8, 22, 27, 39, 46, 49]},
                {"date": "29.04.2025", "draw_number": "7189", "numbers": [4, 20, 24, 31, 32, 48]},
                {"date": "26.04.2025", "draw_number": "7188", "numbers": [10, 11, 13, 20, 27, 49]},
                {"date": "24.04.2025", "draw_number": "7187", "numbers": [2, 5, 14, 37, 42, 43]},
                {"date": "22.04.2025", "draw_number": "7186", "numbers": [1, 19, 28, 31, 33, 38]},
                {"date": "19.04.2025", "draw_number": "7185", "numbers": [3, 4, 7, 36, 37, 38]},
                {"date": "17.04.2025", "draw_number": "7184", "numbers": [2, 10, 15, 28, 33, 49]},
                {"date": "15.04.2025", "draw_number": "7183", "numbers": [5, 15, 19, 21, 25, 26]},
                {"date": "12.04.2025", "draw_number": "7182", "numbers": [6, 11, 19, 27, 31, 49]},
                {"date": "10.04.2025", "draw_number": "7181", "numbers": [1, 22, 23, 24, 42, 44]},
                {"date": "08.04.2025", "draw_number": "7180", "numbers": [16, 23, 27, 35, 38, 44]},
                {"date": "05.04.2025", "draw_number": "7179", "numbers": [7, 21, 25, 29, 37, 39]},
                {"date": "03.04.2025", "draw_number": "7178", "numbers": [4, 5, 8, 10, 23, 44]},
                {"date": "01.04.2025", "draw_number": "7177", "numbers": [6, 15, 20, 21, 27, 40]},
                {"date": "29.03.2025", "draw_number": "7176", "numbers": [15, 25, 29, 37, 39, 41]},
                {"date": "27.03.2025", "draw_number": "7175", "numbers": [16, 17, 20, 31, 35, 45]},
                {"date": "25.03.2025", "draw_number": "7174", "numbers": [3, 5, 15, 20, 26, 36]},
                {"date": "22.03.2025", "draw_number": "7173", "numbers": [17, 19, 35, 39, 46, 48]},
                {"date": "20.03.2025", "draw_number": "7172", "numbers": [18, 22, 23, 32, 36, 39]},
                {"date": "18.03.2025", "draw_number": "7171", "numbers": [24, 25, 30, 39, 44, 46]},
                {"date": "15.03.2025", "draw_number": "7170", "numbers": [6, 11, 18, 20, 28, 34]},
                {"date": "13.03.2025", "draw_number": "7169", "numbers": [1, 14, 20, 40, 41, 43]},
                {"date": "11.03.2025", "draw_number": "7168", "numbers": [2, 9, 10, 16, 27, 49]},
                {"date": "08.03.2025", "draw_number": "7167", "numbers": [14, 20, 21, 23, 26, 49]},
                {"date": "06.03.2025", "draw_number": "7166", "numbers": [3, 10, 11, 13, 18, 33]},
                {"date": "04.03.2025", "draw_number": "7165", "numbers": [9, 18, 24, 30, 31, 48]},
                {"date": "01.03.2025", "draw_number": "7164", "numbers": [3, 7, 10, 29, 40, 46]},
                {"date": "27.02.2025", "draw_number": "7163", "numbers": [1, 6, 7, 29, 37, 38]},
                {"date": "25.02.2025", "draw_number": "7162", "numbers": [1, 3, 10, 15, 17, 44]},
                {"date": "22.02.2025", "draw_number": "7161", "numbers": [2, 5, 6, 18, 36, 39]},
                {"date": "20.02.2025", "draw_number": "7160", "numbers": [4, 7, 19, 20, 38, 46]},
                {"date": "18.02.2025", "draw_number": "7159", "numbers": [3, 5, 6, 8, 15, 42]},
                {"date": "15.02.2025", "draw_number": "7158", "numbers": [20, 22, 26, 32, 44, 45]},
                {"date": "13.02.2025", "draw_number": "7157", "numbers": [21, 30, 35, 36, 37, 38]},
                {"date": "11.02.2025", "draw_number": "7156", "numbers": [3, 17, 18, 20, 29, 30]},
                {"date": "08.02.2025", "draw_number": "7155", "numbers": [7, 10, 23, 24, 48, 49]},
                {"date": "06.02.2025", "draw_number": "7154", "numbers": [8, 10, 11, 17, 36, 46]},
                {"date": "04.02.2025", "draw_number": "7153", "numbers": [17, 19, 22, 25, 31, 38]},
                {"date": "01.02.2025", "draw_number": "7152", "numbers": [2, 3, 6, 17, 20, 30]},
                {"date": "30.01.2025", "draw_number": "7151", "numbers": [4, 16, 21, 30, 43, 49]},
                {"date": "28.01.2025", "draw_number": "7150", "numbers": [7, 8, 23, 29, 31, 43]},
                {"date": "25.01.2025", "draw_number": "7149", "numbers": [28, 30, 32, 36, 40, 48]},
                {"date": "23.01.2025", "draw_number": "7148", "numbers": [9, 12, 28, 40, 42, 45]},
                {"date": "21.01.2025", "draw_number": "7147", "numbers": [5, 12, 32, 34, 36, 39]},
                {"date": "18.01.2025", "draw_number": "7146", "numbers": [20, 30, 32, 34, 43, 48]},
                {"date": "16.01.2025", "draw_number": "7145", "numbers": [26, 28, 30, 40, 44, 49]},
                {"date": "14.01.2025", "draw_number": "7144", "numbers": [6, 10, 26, 34, 40, 43]},
                {"date": "11.01.2025", "draw_number": "7143", "numbers": [7, 11, 17, 18, 30, 36]},
                {"date": "09.01.2025", "draw_number": "7142", "numbers": [1, 11, 19, 26, 42, 44]},
                {"date": "07.01.2025", "draw_number": "7141", "numbers": [10, 11, 18, 25, 41, 46]},
                {"date": "04.01.2025", "draw_number": "7140", "numbers": [11, 19, 24, 31, 34, 45]},
                {"date": "02.01.2025", "draw_number": "7139", "numbers": [2, 12, 17, 24, 42, 43]},
                {"date": "31.12.2024", "draw_number": "7138", "numbers": [4, 12, 30, 38, 46, 48]},
                {"date": "28.12.2024", "draw_number": "7137", "numbers": [8, 10, 15, 31, 39, 48]},
                {"date": "26.12.2024", "draw_number": "7136", "numbers": [3, 9, 22, 33, 42, 43]},
                {"date": "24.12.2024", "draw_number": "7135", "numbers": [2, 4, 8, 27, 31, 48]},
                {"date": "21.12.2024", "draw_number": "7134", "numbers": [7, 13, 15, 17, 22, 41]},
                {"date": "19.12.2024", "draw_number": "7133", "numbers": [13, 20, 21, 28, 30, 35]},
                {"date": "17.12.2024", "draw_number": "7132", "numbers": [26, 28, 35, 38, 40, 49]},
                {"date": "14.12.2024", "draw_number": "7131", "numbers": [12, 15, 19, 36, 47, 49]},
                {"date": "12.12.2024", "draw_number": "7130", "numbers": [3, 17, 20, 42, 43, 46]},
                {"date": "10.12.2024", "draw_number": "7129", "numbers": [2, 23, 31, 34, 36, 39]},
                {"date": "07.12.2024", "draw_number": "7128", "numbers": [6, 8, 17, 22, 40, 41]},
                {"date": "05.12.2024", "draw_number": "7127", "numbers": [2, 15, 19, 25, 29, 34]},
                {"date": "03.12.2024", "draw_number": "7126", "numbers": [9, 11, 14, 28, 36, 48]},
                {"date": "30.11.2024", "draw_number": "7125", "numbers": [9, 13, 20, 38, 41, 49]},
                {"date": "28.11.2024", "draw_number": "7124", "numbers": [3, 10, 11, 13, 24, 40]},
                {"date": "26.11.2024", "draw_number": "7123", "numbers": [4, 6, 10, 24, 26, 44]},
                {"date": "23.11.2024", "draw_number": "7122", "numbers": [10, 16, 27, 32, 45, 49]},
                {"date": "21.11.2024", "draw_number": "7121", "numbers": [8, 14, 20, 24, 26, 40]},
                {"date": "19.11.2024", "draw_number": "7120", "numbers": [2, 12, 19, 24, 35, 38]},
                {"date": "16.11.2024", "draw_number": "7119", "numbers": [1, 7, 26, 36, 37, 40]},
                {"date": "14.11.2024", "draw_number": "7118", "numbers": [1, 20, 35, 36, 44, 47]},
                {"date": "12.11.2024", "draw_number": "7117", "numbers": [6, 12, 14, 20, 21, 38]},
                {"date": "09.11.2024", "draw_number": "7116", "numbers": [2, 12, 15, 16, 35, 40]},
                {"date": "07.11.2024", "draw_number": "7115", "numbers": [1, 11, 21, 22, 31, 41]},
                {"date": "05.11.2024", "draw_number": "7114", "numbers": [5, 6, 15, 16, 41, 48]},
                {"date": "02.11.2024", "draw_number": "7113", "numbers": [5, 13, 16, 37, 40, 43]},
                {"date": "31.10.2024", "draw_number": "7112", "numbers": [8, 10, 18, 25, 41, 48]},
                {"date": "29.10.2024", "draw_number": "7111", "numbers": [5, 14, 19, 30, 35, 39]},
                {"date": "26.10.2024", "draw_number": "7110", "numbers": [13, 18, 32, 34, 36, 39]},
                {"date": "24.10.2024", "draw_number": "7109", "numbers": [5, 17, 20, 24, 42, 44]},
                {"date": "22.10.2024", "draw_number": "7108", "numbers": [12, 17, 20, 22, 24, 44]},
                {"date": "19.10.2024", "draw_number": "7107", "numbers": [9, 10, 39, 42, 44, 45]},
                {"date": "17.10.2024", "draw_number": "7106", "numbers": [7, 22, 38, 40, 45, 48]},
                {"date": "15.10.2024", "draw_number": "7105", "numbers": [6, 9, 12, 26, 45, 46]},
                {"date": "12.10.2024", "draw_number": "7104", "numbers": [5, 10, 13, 20, 21, 28]},
                {"date": "10.10.2024", "draw_number": "7103", "numbers": [2, 6, 17, 36, 38, 41]},
                {"date": "08.10.2024", "draw_number": "7102", "numbers": [1, 14, 18, 24, 35, 45]},
                {"date": "05.10.2024", "draw_number": "7101", "numbers": [3, 15, 17, 22, 29, 48]},
                {"date": "03.10.2024", "draw_number": "7100", "numbers": [13, 14, 23, 36, 43, 48]},
                {"date": "01.10.2024", "draw_number": "7099", "numbers": [3, 6, 20, 39, 44, 45]},
                {"date": "28.09.2024", "draw_number": "7098", "numbers": [8, 12, 23, 25, 26, 47]},
                {"date": "26.09.2024", "draw_number": "7097", "numbers": [1, 2, 19, 29, 33, 41]},
                {"date": "24.09.2024", "draw_number": "7096", "numbers": [1, 2, 14, 26, 30, 49]},
                {"date": "21.09.2024", "draw_number": "7095", "numbers": [4, 5, 12, 24, 36, 39]},
                {"date": "19.09.2024", "draw_number": "7094", "numbers": [2, 6, 10, 18, 21, 22]},
                {"date": "17.09.2024", "draw_number": "7093", "numbers": [4, 5, 6, 12, 16, 45]},
                {"date": "14.09.2024", "draw_number": "7092", "numbers": [5, 11, 20, 29, 35, 44]},
                {"date": "12.09.2024", "draw_number": "7091", "numbers": [16, 23, 27, 32, 33, 37]},
                {"date": "10.09.2024", "draw_number": "7090", "numbers": [2, 10, 17, 26, 32, 37]},
                {"date": "07.09.2024", "draw_number": "7089", "numbers": [8, 21, 23, 30, 31, 43]},
                {"date": "05.09.2024", "draw_number": "7088", "numbers": [2, 4, 21, 32, 40, 49]},
                {"date": "03.09.2024", "draw_number": "7087", "numbers": [3, 11, 19, 21, 27, 44]},
                {"date": "31.08.2024", "draw_number": "7086", "numbers": [12, 14, 18, 30, 34, 38]},
                {"date": "29.08.2024", "draw_number": "7085", "numbers": [2, 13, 17, 23, 32, 41]},
                {"date": "27.08.2024", "draw_number": "7084", "numbers": [3, 15, 27, 34, 45, 46]},
                {"date": "24.08.2024", "draw_number": "7083", "numbers": [1, 6, 12, 36, 37, 49]},
                {"date": "22.08.2024", "draw_number": "7082", "numbers": [2, 3, 8, 12, 17, 21]},
                {"date": "20.08.2024", "draw_number": "7081", "numbers": [2, 17, 26, 27, 32, 40]},
                {"date": "17.08.2024", "draw_number": "7080", "numbers": [13, 16, 22, 30, 38, 44]},
                {"date": "15.08.2024", "draw_number": "7079", "numbers": [9, 17, 21, 33, 35, 37]},
                {"date": "13.08.2024", "draw_number": "7078", "numbers": [1, 13, 35, 36, 41, 47]},
                {"date": "10.08.2024", "draw_number": "7077", "numbers": [1, 17, 32, 39, 42, 43]},
                {"date": "08.08.2024", "draw_number": "7076", "numbers": [21, 26, 36, 39, 45, 49]}
            ],
            "number_data": {}
        };

        // –°–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –Ω–æ–º–µ—Ä–∞–º –∏–∑ —Ç–∏—Ä–∞–∂–µ–π
        function createNumberData() {
            const numberData = {};
            for (let i = 1; i <= 49; i++) {
                numberData[i] = [];
            }
            
            embeddedLottoData.draws.forEach(draw => {
                draw.numbers.forEach(number => {
                    numberData[number].push({
                        date: draw.date,
                        draw_number: draw.draw_number
                    });
                });
            });
            
            return numberData;
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ localStorage
        function saveData() {
            try {
                const dataToSave = {
                    draws: lottoData.draws
                };
                localStorage.setItem('lottoAnalyzerData', JSON.stringify(dataToSave));

                // –¢–∞–∫–∂–µ –æ–±–Ω–æ–≤–ª—è–µ–º embedded –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
                embeddedLottoData.draws = [...lottoData.draws];
                console.log('–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ localStorage –∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –≤ embeddedLottoData');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:', error);
                showError('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ. –í–æ–∑–º–æ–∂–Ω–æ, —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–æ.');
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        function loadData() {
            try {
                const savedData = localStorage.getItem('lottoAnalyzerData');
                let draws;
                if (savedData) {
                    console.log('–ù–∞–π–¥–µ–Ω—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ localStorage.');
                    draws = JSON.parse(savedData).draws;
                    // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º embedded –¥–∞–Ω–Ω—ã–µ —Å localStorage
                    embeddedLottoData.draws = [...draws];
                } else {
                    console.log('–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ.');
                    draws = embeddedLottoData.draws;
                }

                // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ç–∏—Ä–∞–∂–µ–π –ø–æ –Ω–æ–º–µ—Ä—É —Ç–∏—Ä–∞–∂–∞ –≤ —É–±—ã–≤–∞—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ
                draws.sort((a, b) => parseInt(b.draw_number) - parseInt(a.draw_number));

                lottoData = {
                    draws: draws,
                    number_data: createNumberDataFromDraws(draws) // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é
                };

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
                saveData();

                console.log('–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', lottoData);

                // –û–±–Ω–æ–≤–ª—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                updateStrategyCardsEfficiency();

                updateNumberTrends();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: ' + error.message);
                // –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞, –∑–∞–≥—Ä—É–∂–∞–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                lottoData = {
                    draws: embeddedLottoData.draws,
                    number_data: createNumberDataFromDraws(embeddedLottoData.draws)
                };
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –±—É–¥—É—â–∏—Ö –∑–∞–≥—Ä—É–∑–æ–∫
                saveData();

                // –û–±–Ω–æ–≤–ª—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                updateStrategyCardsEfficiency();

                updateNumberTrends();
            }
        }

        // –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –Ω–æ–º–µ—Ä–∞–º –∏–∑ –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ —Ç–∏—Ä–∞–∂–µ–π
        function createNumberDataFromDraws(draws) {
            const numberData = {};
            for (let i = 1; i <= 49; i++) {
                numberData[i] = [];
            }
            
            draws.forEach(draw => {
                draw.numbers.forEach(number => {
                    numberData[number].push({
                        date: draw.date,
                        draw_number: draw.draw_number
                    });
                });
            });
            
            return numberData;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–∏ –Ω–æ–º–µ—Ä–æ–≤
        function updateNumberTrends() {
            if (!lottoData) return;

            for (let number = 1; number <= 49; number++) {
                const btn = document.querySelector(`.number-btn:nth-child(${number})`);
                if (!btn) continue;

                const trend = calculateNumberTrend(number).status;
                const trendClass = getTrendClass(trend);
                
                // –£–±–∏—Ä–∞–µ–º –≤—Å–µ –∫–ª–∞—Å—Å—ã —Ç—Ä–µ–Ω–¥–æ–≤ –∏ –≤—ã–¥–µ–ª–µ–Ω–∏–µ
                btn.classList.remove('trend-up-high', 'trend-up', 'trend-stable', 'trend-down', 'trend-down-low', 'selected-highlight');
                
                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π –∫–ª–∞—Å—Å —Ç—Ä–µ–Ω–¥–∞
                if (trendClass) {
                    btn.classList.add(trendClass);
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞
                if (number === selectedNumber) {
                    btn.classList.add('selected-highlight');
                }
            }
            
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç–∏–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞ (–∫–∞–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ)
        function createStyledNumber(number) {
            if (!lottoData || !number) return number.toString();
            
            const trend = calculateNumberTrend(number).status;
            const trendClass = getTrendClass(trend);
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ü–≤–µ—Ç –∏ —Å—Ç–∏–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç—Ä–µ–Ω–¥–∞
            let bgColor, textColor, boxShadow, animation = '';
            
            switch (trend) {
                case 'up-high':
                    bgColor = 'var(--trend-hot-high)';
                    textColor = 'var(--text-light)';
                    boxShadow = '0 0 15px rgba(255, 68, 68, 0.4)';
                    animation = 'animation: hotPulse 3s infinite;';
                    break;
                case 'up':
                    bgColor = 'var(--trend-hot)';
                    textColor = 'var(--text-light)';
                    boxShadow = '0 0 12px rgba(255, 136, 0, 0.4)';
                    break;
                case 'down':
                    bgColor = 'var(--trend-cold)';
                    textColor = 'var(--text-light)';
                    boxShadow = '0 0 12px rgba(68, 170, 68, 0.4)';
                    break;
                case 'down-low':
                    bgColor = 'var(--trend-cold-low)';
                    textColor = 'var(--text-light)';
                    boxShadow = '0 0 15px rgba(0, 102, 204, 0.4)';
                    animation = 'animation: coldGlow 4s infinite;';
                    break;
                default:
                    bgColor = 'var(--trend-stable)';
                    textColor = 'var(--text-light)';
                    boxShadow = '0 0 8px rgba(136, 136, 136, 0.3)';
                    break;
            }
            
            return `<span style="
                display: inline-flex;
                align-items: center;
                justify-content: center;
                width: 32px;
                height: 32px;
                background: ${bgColor};
                color: ${textColor};
                border-radius: var(--radius-lg);
                font-weight: 700;
                font-size: 16px;
                box-shadow: ${boxShadow};
                ${animation}
                margin: 0 4px;
                position: relative;
                overflow: hidden;
            ">${number}</span>`;
        }

                // –†–∞—Å—á–µ—Ç —Ç—Ä–µ–Ω–¥–∞ –¥–ª—è –Ω–æ–º–µ—Ä–∞
        function calculateNumberTrend(number) {
            const numberData = lottoData.number_data[number] || [];
            if (numberData.length < 3) return { status: 'stable', ratio: 1 };

            const totalDraws = lottoData.draws.length;
            const overallFrequency = numberData.length / totalDraws;
            if (overallFrequency === 0) return { status: 'stable', ratio: 1 };

            // –í—ã—á–∏—Å–ª—è–µ–º —á–∞—Å—Ç–æ—Ç—É –≤ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 20 —Ç–∏—Ä–∞–∂–∞—Ö
            const recentDraws = lottoData.draws.slice(0, Math.min(20, totalDraws));
            let recentCount = 0;
            recentDraws.forEach(draw => {
                if (draw.numbers.includes(number)) {
                    recentCount++;
                }
            });
            
            const recentFrequency = recentCount / recentDraws.length;
            const ratio = recentFrequency / overallFrequency;

            let status = 'stable';
            if (ratio > 1.8) status = 'up-high'; // –í—ã–ø–∞–¥–∞–µ—Ç –≤ 1.8+ —Ä–∞–∑–∞ —á–∞—â–µ —á–µ–º –æ–±—ã—á–Ω–æ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Ç–∏—Ä–∞–∂–µ–π
            else if (ratio > 1.3) status = 'up'; // –í—ã–ø–∞–¥–∞–µ—Ç –≤ 1.3+ —Ä–∞–∑–∞ —á–∞—â–µ —á–µ–º –æ–±—ã—á–Ω–æ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Ç–∏—Ä–∞–∂–µ–π
            else if (ratio < 0.4) status = 'down-low'; // –í—ã–ø–∞–¥–∞–µ—Ç –≤ 0.4 —Ä–∞–∑–∞ —Ä–µ–∂–µ —á–µ–º –æ–±—ã—á–Ω–æ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Ç–∏—Ä–∞–∂–µ–π
            else if (ratio < 0.7) status = 'down'; // –í—ã–ø–∞–¥–∞–µ—Ç –≤ 0.7 —Ä–∞–∑–∞ —Ä–µ–∂–µ —á–µ–º –æ–±—ã—á–Ω–æ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Ç–∏—Ä–∞–∂–µ–π

            return { status, ratio };
        }


        // RSI (Relative Strength Index) –¥–ª—è –ª–æ—Ç–µ—Ä–µ–∏ - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è
        function calculateRSI(number, period = 14) {
            const numberData = lottoData.number_data[number] || [];
            if (numberData.length < 3) {
                return { rsi: 50, status: '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö' };
            }

            // –í—ã—á–∏—Å–ª—è–µ–º —á–∞—Å—Ç–æ—Ç—É –≤—ã–ø–∞–¥–µ–Ω–∏–π –≤ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Ç–∏—Ä–∞–∂–∞—Ö
            const recentDraws = lottoData.draws.slice(0, Math.min(period, lottoData.draws.length));
            let recentCount = 0;
            recentDraws.forEach(draw => {
                if (draw.numbers.includes(number)) recentCount++;
            });
            
            const recentFrequency = recentCount / recentDraws.length;
            const overallFrequency = numberData.length / lottoData.draws.length;
            
            // –í—ã—á–∏—Å–ª—è–µ–º RSI –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è –Ω–µ–¥–∞–≤–Ω–µ–π –∏ –æ–±—â–µ–π —á–∞—Å—Ç–æ—Ç—ã
            let rsi;
            if (overallFrequency === 0) {
                rsi = recentFrequency > 0 ? 100 : 0;
            } else {
                const ratio = recentFrequency / overallFrequency;
                // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –≤ –¥–∏–∞–ø–∞–∑–æ–Ω 0-100
                rsi = Math.min(100, Math.max(0, (ratio - 0.5) * 100 + 50));
            }

            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
            let status;
            if (rsi > 70) status = '–û—á–µ–Ω—å —á–∞—Å—Ç–æ –≤—ã–ø–∞–¥–∞–µ—Ç (–ø–µ—Ä–µ–≥—Ä–µ—Ç)';
            else if (rsi < 30) status = '–û—á–µ–Ω—å —Ä–µ–¥–∫–æ –≤—ã–ø–∞–¥–∞–µ—Ç (–ø–µ—Ä–µ–æ—Ö–ª–∞–∂–¥–µ–Ω)';
            else if (rsi > 60) status = '–ß–∞—Å—Ç–æ –≤—ã–ø–∞–¥–∞–µ—Ç (–≥–æ—Ä—è—á–∏–π)';
            else if (rsi < 40) status = '–†–µ–¥–∫–æ –≤—ã–ø–∞–¥–∞–µ—Ç (—Ö–æ–ª–æ–¥–Ω—ã–π)';
            else status = '–í—ã–ø–∞–¥–∞–µ—Ç –æ–±—ã—á–Ω–æ (–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π)';

            return { rsi: Math.round(rsi), status };
        }

        // –°–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ä–µ–¥–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è
        function calculateMovingAverages(number, periods = [5, 10, 20]) {
            const numberData = lottoData.number_data[number] || [];
            const results = {};

            periods.forEach(period => {
                // –ë–µ—Ä–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Ç–∏—Ä–∞–∂–µ–π
                const recentDraws = lottoData.draws.slice(0, Math.min(period, lottoData.draws.length));
                let count = 0;
                recentDraws.forEach(draw => {
                    if (draw.numbers.includes(number)) count++;
                });
                
                const ma = count / recentDraws.length;
                const maPercent = Math.round(ma * 100);
                
                let trend;
                if (maPercent > 15) trend = '–û—á–µ–Ω—å —á–∞—Å—Ç–æ';
                else if (maPercent > 10) trend = '–ß–∞—Å—Ç–æ';
                else if (maPercent > 5) trend = '–ò–Ω–æ–≥–¥–∞';
                else if (maPercent > 0) trend = '–†–µ–¥–∫–æ';
                else trend = '–ù–µ –≤—ã–ø–∞–¥–∞–ª';

                results[`MA${period}`] = { 
                    value: `${maPercent}%`, 
                    trend: trend
                };
            });

            return results;
        }

        // –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä "–¥–æ–ª–≥–∞" - —Å–∫–æ–ª—å–∫–æ —Ç–∏—Ä–∞–∂–µ–π –Ω–µ –≤—ã–ø–∞–¥–∞–ª - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è
        function calculateDebtIndicator(number) {
            const numberData = lottoData.number_data[number] || [];
            if (numberData.length === 0) {
                return { debt: lottoData.draws.length, status: '–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–ø–∞–¥–∞–ª' };
            }

            // –ù–∞—Ö–æ–¥–∏–º –ü–û–°–õ–ï–î–ù–ò–ô (—Å–∞–º—ã–π –Ω–æ–≤—ã–π) —Ç–∏—Ä–∞–∂, –≥–¥–µ –≤—ã–ø–∞–¥–∞–ª –Ω–æ–º–µ—Ä. –û–Ω –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞.
            const lastAppearance = numberData[0];
            const lastDrawNumber = parseInt(lastAppearance.draw_number);
            const currentDrawNumber = parseInt(lottoData.draws[0].draw_number);
            
            const debt = currentDrawNumber - lastDrawNumber;
            
            let status;
            if (debt > 20) status = '–û—á–µ–Ω—å –¥–∞–≤–Ω–æ –Ω–µ –≤—ã–ø–∞–¥–∞–ª';
            else if (debt > 15) status = '–î–∞–≤–Ω–æ –Ω–µ –≤—ã–ø–∞–¥–∞–ª';
            else if (debt > 10) status = '–ù–µ–¥–∞–≤–Ω–æ –Ω–µ –≤—ã–ø–∞–¥–∞–ª';
            else if (debt > 5) status = '–ù–µ–¥–∞–≤–Ω–æ –≤—ã–ø–∞–¥–∞–ª';
            else if (debt === 0) status = '–í—ã–ø–∞–ª –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º —Ç–∏—Ä–∞–∂–µ';
            else status = '–ù–µ–¥–∞–≤–Ω–æ –≤—ã–ø–∞–¥–∞–ª';

            return { debt, status };
        }

        // –†–∞—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–æ–º–µ–∂—É—Ç–∫–æ–≤ –º–µ–∂–¥—É –≤—ã–ø–∞–¥–µ–Ω–∏—è–º–∏
        function calculateGapStats(numberData) {
            if (numberData.length < 2) {
                return { avgGap: 0, cv: 0 };
            }

            const gaps = [];
            for (let i = 1; i < numberData.length; i++) {
                const gap = Math.abs(parseInt(numberData[i-1].draw_number) - parseInt(numberData[i].draw_number));
                gaps.push(gap);
            }

            const avgGap = gaps.reduce((sum, gap) => sum + gap, 0) / gaps.length;
            const variance = gaps.reduce((sum, gap) => sum + Math.pow(gap - avgGap, 2), 0) / gaps.length;
            const cv = avgGap > 0 ? Math.sqrt(variance) / avgGap : 0;

            return { avgGap: Math.round(avgGap * 10) / 10, cv: Math.round(cv * 100) / 100 };
        }

        

        // –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤—ã—Ö –ª–∏–Ω–∏–π
        function analyzeTrendLines(number) {
            const recentDraws = lottoData.draws.slice(0, 20);
            const frequencies = [];
            
            // –í—ã—á–∏—Å–ª—è–µ–º —á–∞—Å—Ç–æ—Ç—É –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–∫–Ω–∞ –∏–∑ 5 —Ç–∏—Ä–∞–∂–µ–π
            for (let i = 0; i < recentDraws.length - 4; i++) {
                const window = recentDraws.slice(i, i + 5);
                let count = 0;
                window.forEach(draw => {
                    if (draw.numbers.includes(number)) count++;
                });
                frequencies.push(count / 5);
            }

            if (frequencies.length < 3) return null;

            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç—Ä–µ–Ω–¥
            const first = frequencies[0];
            const middle = frequencies[Math.floor(frequencies.length / 2)];
            const last = frequencies[frequencies.length - 1];

            if (first < middle && middle < last) {
                return {
                    name: 'üìà –í–æ—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–µ–Ω–¥',
                    description: '–ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–ø–∞–¥–µ–Ω–∏–π —Ä–∞—Å—Ç–µ—Ç',
                    signal: '–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–æ—Å—Ç–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ',
                    color: '#4caf50'
                };
            } else if (first > middle && middle > last) {
                return {
                    name: 'üìâ –ù–∏—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–µ–Ω–¥',
                    description: '–ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–ø–∞–¥–µ–Ω–∏–π –ø–∞–¥–∞–µ—Ç',
                    signal: '–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø–∞–¥–µ–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ',
                    color: '#f44336'
                };
            }

            return null;
        }

        // –ê–Ω–∞–ª–∏–∑ –ø–∏–∫–æ–≤ –∏ –≤–ø–∞–¥–∏–Ω (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞)
        function analyzePeaksAndValleys(number) {
            const recentDraws = lottoData.draws.slice(0, 20);
            const frequencies = [];
            
            // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —á–∞—Å—Ç–æ—Ç—É –≤ –æ–∫–Ω–∞—Ö –ø–æ 5 —Ç–∏—Ä–∞–∂–µ–π
            for (let i = 0; i < recentDraws.length - 4; i++) {
                const window = recentDraws.slice(i, i + 5);
                let count = 0;
                window.forEach(draw => {
                    if (draw.numbers.includes(number)) count++;
                });
                frequencies.push(count); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ø–∞–¥–µ–Ω–∏–π, –∞ –Ω–µ –ø—Ä–æ—Ü–µ–Ω—Ç
            }

            if (frequencies.length < 5) return null;

            // –ò—â–µ–º –ø–∏–∫–∏ –∏ –≤–ø–∞–¥–∏–Ω—ã
            const maxCount = Math.max(...frequencies);
            const minCount = Math.min(...frequencies);
            const avgCount = frequencies.reduce((a, b) => a + b, 0) / frequencies.length;

            // –ü–∏–∫: –µ—Å–ª–∏ –≤ –∫–∞–∫–æ–º-—Ç–æ –æ–∫–Ω–µ –≤—ã–ø–∞–ª 4-5 —Ä–∞–∑ –∏–∑ 5
            if (maxCount >= 4) {
                return {
                    name: 'üî∫ –ü–∏–∫ —á–∞—Å—Ç–æ—Ç—ã',
                    description: `–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞: ${maxCount}/5 —Ç–∏—Ä–∞–∂–µ–π (${(maxCount/5*100).toFixed(1)}%)`,
                    signal: '–í–æ–∑–º–æ–∂–µ–Ω –æ—Ç–∫–∞—Ç (—Å–Ω–∏–∂–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã)',
                    color: '#ff9800'
                };
            }
            // –í–ø–∞–¥–∏–Ω–∞: –µ—Å–ª–∏ –≤ –∫–∞–∫–æ–º-—Ç–æ –æ–∫–Ω–µ –≤—ã–ø–∞–ª 0-1 —Ä–∞–∑ –∏–∑ 5
            else if (minCount <= 1 && avgCount < 2) {
                return {
                    name: 'üîª –í–ø–∞–¥–∏–Ω–∞ —á–∞—Å—Ç–æ—Ç—ã',
                    description: `–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞: ${minCount}/5 —Ç–∏—Ä–∞–∂–µ–π (${(minCount/5*100).toFixed(1)}%)`,
                    signal: '–í–æ–∑–º–æ–∂–µ–Ω –æ—Ç—Å–∫–æ–∫ (—Ä–æ—Å—Ç —á–∞—Å—Ç–æ—Ç—ã)',
                    color: '#2196f3'
                };
            }

            return null;
        }

        // –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–æ–µ–≤ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞)
        function analyzeBreakouts(number) {
            const numberData = lottoData.number_data[number] || [];
            if (numberData.length < 10) return null;

            const overallFrequency = numberData.length / lottoData.draws.length;
            const recentDraws = lottoData.draws.slice(0, 10);
            let recentCount = 0;
            recentDraws.forEach(draw => {
                if (draw.numbers.includes(number)) recentCount++;
            });
            const recentFrequency = recentCount / recentDraws.length;

            // –ü—Ä–æ–±–æ–π –≤–≤–µ—Ä—Ö: –µ—Å–ª–∏ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 —Ç–∏—Ä–∞–∂–∞—Ö –≤—ã–ø–∞–ª –≤ 6+ —Ç–∏—Ä–∞–∂–∞—Ö (60%+)
            if (recentCount >= 6) {
                return {
                    name: 'üöÄ –ü—Ä–æ–±–æ–π –≤–≤–µ—Ä—Ö',
                    description: `–ù–µ–¥–∞–≤–Ω—è—è —á–∞—Å—Ç–æ—Ç–∞: ${recentCount}/10 —Ç–∏—Ä–∞–∂–µ–π (${(recentFrequency * 100).toFixed(1)}%) vs –æ–±—ã—á–Ω–∞—è: ${(overallFrequency * 100).toFixed(1)}%`,
                    signal: '–°–∏–ª—å–Ω—ã–π —Ä–æ—Å—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
                    color: '#4caf50'
                };
            }
            // –ü—Ä–æ–±–æ–π –≤–Ω–∏–∑: –µ—Å–ª–∏ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 —Ç–∏—Ä–∞–∂–∞—Ö –≤—ã–ø–∞–ª –≤ 1-2 —Ç–∏—Ä–∞–∂–∞—Ö (20%-)
            else if (recentCount <= 2) {
                return {
                    name: 'üí• –ü—Ä–æ–±–æ–π –≤–Ω–∏–∑',
                    description: `–ù–µ–¥–∞–≤–Ω—è—è —á–∞—Å—Ç–æ—Ç–∞: ${recentCount}/10 —Ç–∏—Ä–∞–∂–µ–π (${(recentFrequency * 100).toFixed(1)}%) vs –æ–±—ã—á–Ω–∞—è: ${(overallFrequency * 100).toFixed(1)}%`,
                    signal: '–°–∏–ª—å–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
                    color: '#f44336'
                };
            }

            return null;
        }

        // –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏–∏
        function analyzeConsolidation(number) {
            const recentDraws = lottoData.draws.slice(0, 15);
            const frequencies = [];
            
            for (let i = 0; i < recentDraws.length - 4; i++) {
                const window = recentDraws.slice(i, i + 5);
                let count = 0;
                window.forEach(draw => {
                    if (draw.numbers.includes(number)) count++;
                });
                frequencies.push(count / 5);
            }

            if (frequencies.length < 3) return null;

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
            const avgFreq = frequencies.reduce((a, b) => a + b, 0) / frequencies.length;
            const variance = frequencies.reduce((sum, freq) => sum + Math.pow(freq - avgFreq, 2), 0) / frequencies.length;
            const stdDev = Math.sqrt(variance);

            if (stdDev < avgFreq * 0.2) {
                return {
                    name: 'üìä –ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è',
                    description: `–°—Ç–∞–±–∏–ª—å–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞: ${(avgFreq * 100).toFixed(1)}% ¬± ${(stdDev * 100).toFixed(1)}%`,
                    signal: '–û–∂–∏–¥–∞–Ω–∏–µ –ø—Ä–æ–±–æ—è –≤ –ª—é–±—É—é —Å—Ç–æ—Ä–æ–Ω—É',
                    color: '#9c27b0'
                };
            }

            return null;
        }

        // –í—ã–±–æ—Ä –Ω–æ–º–µ—Ä–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
        function selectNumber(number) {
            // –ï—Å–ª–∏ –∫–ª–∏–∫–Ω—É–ª–∏ –Ω–∞ —É–∂–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–µ —á–∏—Å–ª–æ - —Å–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            if (selectedNumber === number) {
                hideChart();
                selectedNumber = null;
                return;
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
            document.querySelectorAll('.number-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            const targetBtn = document.querySelector(`.number-btn:nth-child(${number})`);
            if (targetBtn) {
                targetBtn.classList.add('active');
            }

            selectedNumber = number;
            updateNumberTrends(); // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞
            updateChart();
        }

        // –í—ã–±–æ—Ä –Ω–æ–º–µ—Ä–∞ –∏–∑ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
        function selectNumberFromGenerator(number) {
            // –í—ã–±–∏—Ä–∞–µ–º –Ω–æ–º–µ—Ä (—Ç–µ–ø–µ—Ä—å —Å –ª–æ–≥–∏–∫–æ–π –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è)
            selectNumber(number);

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∫–∞–∑–∞–Ω–∞
            if (selectedNumber === number) {
                showSuccess(`–í—ã–±—Ä–∞–Ω –Ω–æ–º–µ—Ä ${number} –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞`);
            }
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ—Ä—Ç—Ä–µ—Ç–∞
        function generateAndDisplayStatisticalPortrait(number) {
            const numberData = lottoData.number_data[number] || [];
            const portraitContainer = document.getElementById('portrait-panel');
            
            if (numberData.length < 2) {
                portraitContainer.innerHTML = '<div class="stat-portrait"><h4>–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –ü–æ—Ä—Ç—Ä–µ—Ç –ù–æ–º–µ—Ä–∞</h4><p>–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø–æ—Ä—Ç—Ä–µ—Ç–∞.</p></div>';
                return;
            }

            // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
            const trend = calculateNumberTrend(number);
            const { debt } = calculateDebtIndicator(number);
            const { avgGap, cv } = calculateGapStats(numberData);
            const rsiData = calculateRSI(number);
            const rsi = (rsiData && rsiData.rsi !== undefined) ? rsiData.rsi : 50;

            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∏ —Ü–≤–µ—Ç
            const getStatusInfo = () => {
            if (trend.status === 'very-hot' || trend.status === 'hot') {
                    return { text: '–ì–û–†–Ø–ß–ò–ô', icon: 'üî•', color: '#ff4444', bg: '#ffebee' };
            } else if (trend.status === 'very-cold' || trend.status === 'cold') {
                    return { text: '–•–û–õ–û–î–ù–´–ô', icon: '‚ùÑÔ∏è', color: '#2196f3', bg: '#e3f2fd' };
            } else {
                    return { text: '–°–¢–ê–ë–ò–õ–¨–ù–´–ô', icon: '‚öñÔ∏è', color: '#757575', bg: '#f5f5f5' };
                }
            };

            const statusInfo = getStatusInfo();
            const activityLevel = Math.round((trend.ratio - 1) * 100);

            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–ø–∞–¥–µ–Ω–∏—è
            const probability = calculateNumberProbability(number, debt, avgGap, trend.status, cv);

            // –°–æ–∑–¥–∞–µ–º –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –≤–∏–∑—É–∞–ª—å–Ω—ã–π –ø–æ—Ä—Ç—Ä–µ—Ç
            const html = `
                <div class="stat-portrait">
                    <div class="portrait-header">
                        <div class="status-badge" style="background: ${statusInfo.bg}; color: ${statusInfo.color};">
                            <span class="status-icon">${statusInfo.icon}</span>
                            <span class="status-text">${statusInfo.text}</span>
                        </div>
                        <div class="number-container ${getTrendClass(trend.status)}">
                            <span class="number-text">${number}</span>
                        </div>
                        <div class="stats-container">
                            <div class="stats-frame">
                                <strong>${numberData.length}</strong> <span style="font-weight: bold; font-size: 1em; color: #000;">–≤—ã–ø–∞–¥–µ–Ω–∏–π</span> (–∑–∞ –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é) ‚Ä¢ <span style="font-weight: bold; font-size: 1em; color: #000;">–ò–Ω—Ç–µ—Ä–≤–∞–ª</span> <strong>${avgGap.toFixed(1)}</strong> (—Ç–∏—Ä–∞–∂–µ–π –º–µ–∂–¥—É –≤—ã–ø–∞–¥–µ–Ω–∏—è–º–∏) ‚Ä¢ <span style="font-weight: bold; font-size: 1em; color: #000;">RSI</span> <strong>${rsi}</strong> (–∏–Ω–¥–µ–∫—Å —Å–∏–ª—ã 0-100)
                            </div>
                        </div>
                    </div>

                    <div class="metrics-grid">
                        <div class="metric-card" title="–ù–∞ —Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –Ω–æ–º–µ—Ä –≤—ã–ø–∞–¥–∞–ª —á–∞—â–µ/—Ä–µ–∂–µ —Å—Ä–µ–¥–Ω–µ–≥–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è –∏–º–µ–Ω–Ω–æ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Ç–∏—Ä–∞–∂–µ–π (–Ω–µ –∑–∞ –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é)">
                            <div class="metric-label">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</div>
                            <div class="metric-value">${activityLevel > 0 ? '+' : ''}${activityLevel}%</div>
                            <div class="metric-desc">–ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Ç–∏—Ä–∞–∂–µ–π</div>
                            <div class="metric-bar">
                                <div class="metric-fill" style="width: ${Math.min(Math.abs(activityLevel), 100)}%; background: ${activityLevel > 0 ? '#4caf50' : '#f44336'};"></div>
                            </div>
                        </div>

                        <div class="metric-card" title="–°–∫–æ–ª—å–∫–æ —Ç–∏—Ä–∞–∂–µ–π –ø—Ä–æ—à–ª–æ —Å –º–æ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤—ã–ø–∞–¥–µ–Ω–∏—è –Ω–æ–º–µ—Ä–∞">
                            <div class="metric-label">–ü–∞—É–∑–∞</div>
                            <div class="metric-value">${debt}</div>
                            <div class="metric-desc">–¢–µ–∫—É—â–∞—è –ø–∞—É–∑–∞ (—Ç–∏—Ä–∞–∂–µ–π)</div>
                            <div class="metric-bar">
                                <div class="metric-fill" style="width: ${Math.min((debt / avgGap) * 50, 100)}%; background: ${debt > avgGap * 1.2 ? '#ff9800' : '#4caf50'};"></div>
                            </div>
                        </div>

                        <div class="metric-card" title="–ù–∞—Å–∫–æ–ª—å–∫–æ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º —Ä–∏—Ç–º –≤—ã–ø–∞–¥–µ–Ω–∏–π –Ω–æ–º–µ—Ä–∞ (—á–µ–º –Ω–∏–∂–µ %, —Ç–µ–º —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ)">
                            <div class="metric-label">–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å</div>
                            <div class="metric-value">${(cv * 100).toFixed(0)}%</div>
                            <div class="metric-desc">–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–∞—Ä–∏–∞—Ü–∏–∏</div>
                            <div class="metric-bar">
                                <div class="metric-fill" style="width: ${Math.max(100 - (cv * 100), 10)}%; background: ${cv < 0.6 ? '#4caf50' : cv < 1.0 ? '#ff9800' : '#f44336'};"></div>
                            </div>
                        </div>

                        <div class="metric-card" title="–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–ø–∞–¥–µ–Ω–∏—è —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ: —Ç–µ–∫—É—â–µ–π –ø–∞—É–∑—ã vs —Å—Ä–µ–¥–Ω–µ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ + —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä–∏—Ç–º–∞ + –Ω–µ–¥–∞–≤–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏">
                            <div class="metric-label">–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å</div>
                            <div class="metric-value">${probability.toFixed(0)}%</div>
                            <div class="metric-desc">–ù–∞ 5 —Ç–∏—Ä–∞–∂–µ–π</div>
                            <div class="metric-bar">
                                <div class="metric-fill" style="width: ${probability}%; background: ${probability > 60 ? '#4caf50' : probability > 40 ? '#ff9800' : '#f44336'};"></div>
                            </div>
                        </div>
                    </div>


                </div>
            `;

            portraitContainer.innerHTML = html;
        }

        // –†–∞—Å—á–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤—ã–ø–∞–¥–µ–Ω–∏—è –Ω–æ–º–µ—Ä–∞ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
        function calculateNumberProbability(number, debt, avgGap, status, cv) {
            if (avgGap <= 0) return 50; // –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö

            // 1. –ë–∞–∑–æ–≤–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –ø–∞—É–∑—ã –∫ —Å—Ä–µ–¥–Ω–µ–º—É –∏–Ω—Ç–µ—Ä–≤–∞–ª—É
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –±–æ–ª–µ–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
            const normalizedPause = (debt - avgGap) / avgGap; // –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ
            const baseProbability = 100 / (1 + Math.exp(-normalizedPause * 2)); // –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è

            // 2. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —É—Å–∏–ª–µ–Ω–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä–∏—Ç–º–∞
            let stabilityBonus = 0;
            if (cv < 0.6 && debt > avgGap) {
                // –°—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä–∏—Ç–º + –ø–∞—É–∑–∞ –ø—Ä–µ–≤—ã—Å–∏–ª–∞ —Å—Ä–µ–¥–Ω–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
                stabilityBonus = Math.min(60, (1 - cv) * 120 + (debt / avgGap - 1) * 25); // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —É—Å–∏–ª–µ–Ω –±–æ–Ω—É—Å
            } else if (cv < 0.7 && debt > avgGap * 0.8) {
                // –•–æ—Ä–æ—à–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å + —É–º–µ—Ä–µ–Ω–Ω–∞—è –ø–∞—É–∑–∞
                stabilityBonus = Math.min(50, (1 - cv) * 100 + (debt / avgGap - 1) * 20);
            } else if (cv < 0.8 && debt <= avgGap) {
                // –°—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä–∏—Ç–º + –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è/–∫–æ—Ä–æ—Ç–∫–∞—è –ø–∞—É–∑–∞
                stabilityBonus = Math.min(40, (1 - cv) * 80 + (avgGap / debt - 1) * 15); // –£—Å–∏–ª–µ–Ω –±–æ–Ω—É—Å –∑–∞ –∫–æ—Ä–æ—Ç–∫–∏–µ –ø–∞—É–∑—ã
            } else if (cv < 1.0 && debt <= avgGap) {
                // –£–º–µ—Ä–µ–Ω–Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä–∏—Ç–º + –∫–æ—Ä–æ—Ç–∫–∞—è –ø–∞—É–∑–∞
                stabilityBonus = Math.min(30, (1 - cv) * 50 + (avgGap / debt - 1) * 10); // –î–æ–±–∞–≤–ª–µ–Ω –±–æ–Ω—É—Å
            } else if (cv > 1.4) {
                // –•–∞–æ—Ç–∏—á–Ω—ã–π —Ä–∏—Ç–º —Å–Ω–∏–∂–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å
                stabilityBonus = -25; // –£—Å–∏–ª–µ–Ω —à—Ç—Ä–∞—Ñ
            } else if (cv > 1.2) {
                // –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
                stabilityBonus = -15; // –£—Å–∏–ª–µ–Ω —à—Ç—Ä–∞—Ñ
            }

            // 3. –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–µ–∫—É—â–µ–º—É —Å—Ç–∞—Ç—É—Å—É (–º–µ–Ω—å—à–µ –≤–ª–∏—è–µ—Ç)
            let statusAdjustment = 0;
            if (status === 'very-hot' || status === 'hot') {
                statusAdjustment = 10; // –ù–µ–±–æ–ª—å—à–æ–π –±–æ–Ω—É—Å –∑–∞ –≥–æ—Ä—è—á—É—é —Ñ–∞–∑—É
            } else if (status === 'very-cold' || status === 'cold') {
                statusAdjustment = -10; // –ù–µ–±–æ–ª—å—à–æ–π —à—Ç—Ä–∞—Ñ –∑–∞ —Ö–æ–ª–æ–¥–Ω—É—é —Ñ–∞–∑—É
            }

            // 4. –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞—Å—á—ë—Ç
            const probability = Math.max(5, Math.min(95, baseProbability + stabilityBonus + statusAdjustment));

            return probability;
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞—Ü–µ–ø–æ–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function generatePracticalHints(number, debt, avgGap, statusText, stabilityText) {
            const hints = [];
            
            // –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
            const isHot = statusText.includes('–ì–æ—Ä—è—á–∏–π') || statusText.includes('–û—á–µ–Ω—å –≥–æ—Ä—è—á–∏–π');
            const isCold = statusText.includes('–•–æ–ª–æ–¥–Ω—ã–π') || statusText.includes('–û—á–µ–Ω—å —Ö–æ–ª–æ–¥–Ω—ã–π');
            const isStable = statusText.includes('–°—Ç–∞–±–∏–ª—å–Ω—ã–π');
            
            // –ê–Ω–∞–ª–∏–∑ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä–∏—Ç–º–∞
            const isStableRhythm = stabilityText.includes('–í—ã—Å–æ–∫–∞—è') || stabilityText.includes('–°—Ä–µ–¥–Ω—è—è');
            const isChaoticRhythm = stabilityText.includes('–ù–∏–∑–∫–∞—è') || stabilityText.includes('–•–∞–æ—Ç–∏—á–Ω–∞—è');
            
            // –†–∞—Å—á–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–π –ø–∞—É–∑—ã
            const pauseRatio = avgGap > 0 ? (debt / avgGap) : 0;
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞)
            let mainScenario = '';
            let probability = 0;
            let timeFrame = '';
            let strategy = '';
            
            if (debt === 0) {
                // –ù–æ–º–µ—Ä —Ç–æ–ª—å–∫–æ —á—Ç–æ –≤—ã–ø–∞–ª
                mainScenario = 'recently_appeared';
                probability = 15;
                timeFrame = '3-5 —Ç–∏—Ä–∞–∂–µ–π';
                strategy = '–ù–æ–º–µ—Ä —Ç–æ–ª—å–∫–æ —á—Ç–æ –≤—ã–ø–∞–ª - –æ–∂–∏–¥–∞–µ—Ç—Å—è –ø–∞—É–∑–∞';
            } else if (isHot && debt < 2) {
                // –ì–æ—Ä—è—á–∏–π –Ω–æ–º–µ—Ä –Ω–µ–¥–∞–≤–Ω–æ –≤—ã–ø–∞–ª
                mainScenario = 'hot_recent';
                probability = 20;
                timeFrame = '3-4 —Ç–∏—Ä–∞–∂–∞';
                strategy = '–ì–æ—Ä—è—á–∏–π –Ω–æ–º–µ—Ä –≤ "–ø–µ—Ä–µ–≥—Ä–µ–≤–µ" - –ª—É—á—à–µ –ø–æ–¥–æ–∂–¥–∞—Ç—å –æ—Å—Ç—ã–≤–∞–Ω–∏—è';
            } else if (isHot && debt >= 2 && debt < 4) {
                // –ì–æ—Ä—è—á–∏–π –Ω–æ–º–µ—Ä –≤ –∞–∫—Ç–∏–≤–Ω–æ–π —Ñ–∞–∑–µ
                mainScenario = 'hot_active';
                probability = 75;
                timeFrame = '2-3 —Ç–∏—Ä–∞–∂–∞';
                strategy = '–ì–æ—Ä—è—á–∏–π –Ω–æ–º–µ—Ä –≤ –∞–∫—Ç–∏–≤–Ω–æ–π —Ñ–∞–∑–µ - –≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å';
            } else if (isCold && pauseRatio > 2.5) {
                // –•–æ–ª–æ–¥–Ω—ã–π –Ω–æ–º–µ—Ä –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —Ç–æ—á–∫–µ
                mainScenario = 'cold_critical';
                probability = 65;
                timeFrame = '5-7 —Ç–∏—Ä–∞–∂–µ–π';
                strategy = '–•–æ–ª–æ–¥–Ω—ã–π –Ω–æ–º–µ—Ä –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —Ç–æ—á–∫–µ - –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è';
            } else if (isCold && pauseRatio > 1.5) {
                // –•–æ–ª–æ–¥–Ω—ã–π –Ω–æ–º–µ—Ä –ø—Ä–µ–≤—ã—Å–∏–ª –Ω–æ—Ä–º—É
                mainScenario = 'cold_overdue';
                probability = 50;
                timeFrame = '4-6 —Ç–∏—Ä–∞–∂–µ–π';
                strategy = '–•–æ–ª–æ–¥–Ω—ã–π –Ω–æ–º–µ—Ä –ø—Ä–µ–≤—ã—Å–∏–ª –Ω–æ—Ä–º—É - —Ö–æ—Ä–æ—à–∏–µ —à–∞–Ω—Å—ã';
            } else if (isStable && pauseRatio > 1.5) {
                // –°—Ç–∞–±–∏–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –ø—Ä–µ–≤—ã—Å–∏–ª –Ω–æ—Ä–º—É
                mainScenario = 'stable_overdue';
                probability = 55;
                timeFrame = '3-5 —Ç–∏—Ä–∞–∂–µ–π';
                strategy = '–°—Ç–∞–±–∏–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –ø—Ä–µ–≤—ã—Å–∏–ª –Ω–æ—Ä–º—É - –æ–∂–∏–¥–∞–µ—Ç—Å—è –≤–æ–∑–≤—Ä–∞—Ç';
            } else {
                // –û–±—ã—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
                mainScenario = 'normal';
                probability = 40;
                timeFrame = '4-6 —Ç–∏—Ä–∞–∂–µ–π';
                strategy = '–ù–æ–º–µ—Ä –≤ –æ–±—ã—á–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å';
            }
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è
            switch (mainScenario) {
                case 'recently_appeared':
                    hints.push(`<p><strong>–û–∂–∏–¥–∞–Ω–∏—è:</strong> –ù–æ–º–µ—Ä —Ç–æ–ª—å–∫–æ —á—Ç–æ –≤—ã–ø–∞–ª - —Å–ª–µ–¥—É—é—â–µ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ –º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ –≤ –±–ª–∏–∂–∞–π—à–∏–µ ${timeFrame}</p>`);
                    hints.push(`<p><strong>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:</strong> ${probability}% –≤ –±–ª–∏–∂–∞–π—à–∏–µ 5 —Ç–∏—Ä–∞–∂–µ–π</p>`);
                    hints.push(`<p><strong>–°—Ç—Ä–∞—Ç–µ–≥–∏—è:</strong> ${strategy}</p>`);
                    break;
                    
                case 'hot_recent':
                    hints.push(`<p><strong>–û–∂–∏–¥–∞–Ω–∏—è:</strong> –ì–æ—Ä—è—á–∏–π –Ω–æ–º–µ—Ä –Ω–µ–¥–∞–≤–Ω–æ –≤—ã–ø–∞–ª - —Å–ª–µ–¥—É—é—â–µ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ –º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ –≤ –±–ª–∏–∂–∞–π—à–∏–µ ${timeFrame}</p>`);
                    hints.push(`<p><strong>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:</strong> ${probability}% –≤ –±–ª–∏–∂–∞–π—à–∏–µ 5 —Ç–∏—Ä–∞–∂–µ–π</p>`);
                    hints.push(`<p><strong>–°—Ç—Ä–∞—Ç–µ–≥–∏—è:</strong> ${strategy}</p>`);
                    break;
                    
                case 'hot_active':
                    hints.push(`<p><strong>–û–∂–∏–¥–∞–Ω–∏—è:</strong> –ù–æ–º–µ—Ä –≤ "–≥–æ—Ä—è—á–µ–π —Ñ–∞–∑–µ" - –≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–æ—è–≤–ª–µ–Ω–∏—è –≤ –±–ª–∏–∂–∞–π—à–∏–µ ${timeFrame}</p>`);
                    hints.push(`<p><strong>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:</strong> ${probability}% –≤ –±–ª–∏–∂–∞–π—à–∏–µ 5 —Ç–∏—Ä–∞–∂–µ–π</p>`);
                    hints.push(`<p><strong>–°—Ç—Ä–∞—Ç–µ–≥–∏—è:</strong> ${strategy}</p>`);
                    break;
                    
                case 'cold_critical':
                    hints.push(`<p><strong>–û–∂–∏–¥–∞–Ω–∏—è:</strong> –ù–æ–º–µ—Ä "–ø–µ—Ä–µ–≥—Ä–µ–ª—Å—è" –æ—Ç –¥–æ–ª–≥–æ–≥–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Ç–æ—á–∫–∞ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞!</p>`);
                    hints.push(`<p><strong>–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–º–∫–∏:</strong> –û–∂–∏–¥–∞–µ—Ç—Å—è –ø–æ—è–≤–ª–µ–Ω–∏–µ –≤ –±–ª–∏–∂–∞–π—à–∏–µ ${timeFrame}</p>`);
                    hints.push(`<p><strong>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:</strong> ${probability}% –≤ –±–ª–∏–∂–∞–π—à–∏–µ 5 —Ç–∏—Ä–∞–∂–µ–π</p>`);
                    hints.push(`<p><strong>–°—Ç—Ä–∞—Ç–µ–≥–∏—è:</strong> ${strategy}</p>`);
                    if (isStableRhythm) {
                        hints.push(`<p><strong>–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∏–≥–Ω–∞–ª:</strong> –°—Ç–∞–±–∏–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –ø—Ä–µ–≤—ã—Å–∏–ª –Ω–æ—Ä–º—É –≤ ${pauseRatio.toFixed(1)} —Ä–∞–∑–∞ - —Å–∏–ª—å–Ω—ã–π —Å–∏–≥–Ω–∞–ª –∫ –ø–æ—è–≤–ª–µ–Ω–∏—é</p>`);
                    }
                    break;
                    
                case 'cold_overdue':
                    hints.push(`<p><strong>–û–∂–∏–¥–∞–Ω–∏—è:</strong> –•–æ–ª–æ–¥–Ω—ã–π –Ω–æ–º–µ—Ä –ø—Ä–µ–≤—ã—Å–∏–ª —Å—Ä–µ–¥–Ω–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª - –æ–∂–∏–¥–∞–µ—Ç—Å—è –≤–æ–∑–≤—Ä–∞—Ç –∫ –Ω–æ—Ä–º–µ</p>`);
                    hints.push(`<p><strong>–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–º–∫–∏:</strong> –û–∂–∏–¥–∞–µ—Ç—Å—è –ø–æ—è–≤–ª–µ–Ω–∏–µ –≤ –±–ª–∏–∂–∞–π—à–∏–µ ${timeFrame}</p>`);
                    hints.push(`<p><strong>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:</strong> ${probability}% –≤ –±–ª–∏–∂–∞–π—à–∏–µ 5 —Ç–∏—Ä–∞–∂–µ–π</p>`);
                    hints.push(`<p><strong>–°—Ç—Ä–∞—Ç–µ–≥–∏—è:</strong> ${strategy}</p>`);
                    break;
                    
                case 'stable_overdue':
                    hints.push(`<p><strong>–û–∂–∏–¥–∞–Ω–∏—è:</strong> –°—Ç–∞–±–∏–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –ø—Ä–µ–≤—ã—Å–∏–ª —Å—Ä–µ–¥–Ω–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª - –æ–∂–∏–¥–∞–µ—Ç—Å—è –≤–æ–∑–≤—Ä–∞—Ç –∫ –Ω–æ—Ä–º–µ</p>`);
                    if (isStableRhythm) {
                        const expectedRange = Math.round(avgGap * 0.3);
                        hints.push(`<p><strong>–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–º–∫–∏:</strong> –°—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä–∏—Ç–º –Ω–∞—Ä—É—à–µ–Ω - –æ–∂–∏–¥–∞–µ—Ç—Å—è –ø–æ—è–≤–ª–µ–Ω–∏–µ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ ${Math.round(avgGap - expectedRange)}-${Math.round(avgGap + expectedRange)} —Ç–∏—Ä–∞–∂–µ–π</p>`);
                    } else {
                        hints.push(`<p><strong>–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–º–∫–∏:</strong> –û–∂–∏–¥–∞–µ—Ç—Å—è –ø–æ—è–≤–ª–µ–Ω–∏–µ –≤ –±–ª–∏–∂–∞–π—à–∏–µ ${timeFrame}</p>`);
                    }
                    hints.push(`<p><strong>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:</strong> ${probability}% –≤ –±–ª–∏–∂–∞–π—à–∏–µ 5 —Ç–∏—Ä–∞–∂–µ–π</p>`);
                    hints.push(`<p><strong>–°—Ç—Ä–∞—Ç–µ–≥–∏—è:</strong> ${strategy}</p>`);
                    break;
                    
                default: // normal
                    hints.push(`<p><strong>–û–∂–∏–¥–∞–Ω–∏—è:</strong> –ù–æ–º–µ—Ä –≤ –æ–±—ã—á–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–æ—è–≤–ª–µ–Ω–∏—è</p>`);
                    hints.push(`<p><strong>–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–º–∫–∏:</strong> –û–∂–∏–¥–∞–µ—Ç—Å—è –ø–æ—è–≤–ª–µ–Ω–∏–µ –≤ –±–ª–∏–∂–∞–π—à–∏–µ ${timeFrame}</p>`);
                    hints.push(`<p><strong>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:</strong> ${probability}% –≤ –±–ª–∏–∂–∞–π—à–∏–µ 5 —Ç–∏—Ä–∞–∂–µ–π</p>`);
                    hints.push(`<p><strong>–°—Ç—Ä–∞—Ç–µ–≥–∏—è:</strong> ${strategy}</p>`);
                    break;
            }
            
            return hints.join('');
        }

        // –†–∞—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º
        function calculateGapStats(numberData) {
            if (numberData.length < 2) {
                return { avgGap: 0, stdDev: 0, cv: 0 };
            }

            const gaps = [];
            for (let i = 0; i < numberData.length - 1; i++) {
                const gap = Math.abs(parseInt(numberData[i].draw_number) - parseInt(numberData[i+1].draw_number));
                gaps.push(gap);
            }

            if (gaps.length === 0) {
                return { avgGap: 0, stdDev: 0, cv: 0 };
            }

            const avgGap = gaps.reduce((a, b) => a + b, 0) / gaps.length;
            
            const variance = gaps.reduce((sum, gap) => sum + Math.pow(gap - avgGap, 2), 0) / gaps.length;
            const stdDev = Math.sqrt(variance);
            
            const cv = avgGap > 0 ? stdDev / avgGap : 0;

            return {
                avgGap: avgGap,
                stdDev: stdDev,
                cv: cv
            };
        }

        // –ù–æ–≤—ã–π —Ö–µ–ª–ø–µ—Ä –¥–ª—è –ø–ª–∞–≤–Ω–æ–π –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –∫ –≥—Ä–∞—Ñ–∏–∫—É
        function scrollToChart() {
            const chartContainer = document.getElementById('chartContainer');
            if (chartContainer && chartContainer.style.display !== 'none') {
                // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞, —á—Ç–æ–±—ã –±—Ä–∞—É–∑–µ—Ä —É—Å–ø–µ–ª –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –ø–µ—Ä–µ–¥ –ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π
                setTimeout(() => {
                    chartContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }, 100);
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
        function updateChart() {
            if (!lottoData || !selectedNumber) return;

            const chartContainer = document.getElementById('chartContainer');
            const chartTitle = document.getElementById('chartTitle');
            const observationPanel = document.getElementById('portrait-panel');

            chartContainer.style.display = 'block';
            observationPanel.style.display = 'block';
            chartTitle.innerHTML = `–ì—Ä–∞—Ñ–∏–∫ –∏ –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –ü–æ—Ä—Ç—Ä–µ—Ç –ù–æ–º–µ—Ä–∞ ${createStyledNumber(selectedNumber)}`;

            // –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
            const numberData = lottoData.number_data[selectedNumber] || [];
            const chartData = prepareChartData(numberData);
            
            // –°–æ–∑–¥–∞–µ–º –≥—Ä–∞—Ñ–∏–∫
            createChart(chartData);
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø–æ—Ä—Ç—Ä–µ—Ç
            generateAndDisplayStatisticalPortrait(selectedNumber);

            // –ü–ª–∞–≤–Ω–æ –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ –≥—Ä–∞—Ñ–∏–∫—É
            scrollToChart();
        }

        // –§—É–Ω–∫—Ü–∏—è —Å–∫—Ä—ã—Ç–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –Ω–æ–º–µ—Ä–∞
        function hideChart() {
            const chartContainer = document.getElementById('chartContainer');
            const observationPanel = document.getElementById('portrait-panel');

            if (chartContainer) {
                chartContainer.style.display = 'none';
            }
            if (observationPanel) {
                observationPanel.style.display = 'none';
            }

            // –û—á–∏—â–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
            document.querySelectorAll('.number-btn').forEach(btn => {
                btn.classList.remove('active');
            });
        }

        // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
        function prepareChartData(numberData) {
            const labels = [];
            const data = [];
            const volumes = [];

            // –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é —à–∫–∞–ª—É –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Å–µ—Ö —Ç–∏—Ä–∞–∂–µ–π
            const allDraws = lottoData.draws;
            let appearanceIndex = 0;

            for (let i = 0; i < allDraws.length; i++) {
                const draw = allDraws[i];
                const date = new Date(draw.date.split('.').reverse().join('-'));
                labels.push(date);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—ã–ø–∞–ª –ª–∏ –Ω–æ–º–µ—Ä –≤ —ç—Ç–æ–º —Ç–∏—Ä–∞–∂–µ
                const appeared = draw.numbers.includes(selectedNumber);
                data.push(appeared ? 1 : 0);
                
                // –û–±—ä–µ–º (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ø–∞–¥–µ–Ω–∏–π –≤ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 —Ç–∏—Ä–∞–∂–∞—Ö)
                const recentAppearances = countRecentAppearances(selectedNumber, i, 10);
                volumes.push(recentAppearances);
            }

            return { labels, data, volumes };
        }

        // –ü–æ–¥—Å—á–µ—Ç –Ω–µ–¥–∞–≤–Ω–∏—Ö –≤—ã–ø–∞–¥–µ–Ω–∏–π
        function countRecentAppearances(number, currentIndex, window) {
            let count = 0;
            const start = Math.max(0, currentIndex - window + 1);
            
            for (let i = start; i <= currentIndex; i++) {
                if (lottoData.draws[i].numbers.includes(number)) {
                    count++;
                }
            }
            return count;
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
        function createChart(chartData) {
            const ctx = document.getElementById('numberChart').getContext('2d');
            
            if (currentChart) {
                currentChart.destroy();
            }

            currentChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: chartData.labels,
                    datasets: [{
                        label: '–í—ã–ø–∞–¥–µ–Ω–∏—è',
                        data: chartData.data,
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 3,
                        pointHoverRadius: 6
                    }, {
                        label: '–ß–∞—Å—Ç–æ—Ç–∞ (10 —Ç–∏—Ä–∞–∂–µ–π)',
                        data: chartData.volumes,
                        borderColor: '#ff9a9e',
                        backgroundColor: 'rgba(255, 154, 158, 0.1)',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.4,
                        yAxisID: 'y1'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    scales: {
                        x: {
                            type: 'time',
                            time: {
                                unit: 'day'
                            },
                            title: {
                                display: true,
                                text: '–î–∞—Ç–∞'
                            }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: '–í—ã–ø–∞–¥–µ–Ω–∏–µ (0/1)'
                            },
                            min: -0.1,
                            max: 1.1
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: '–ß–∞—Å—Ç–æ—Ç–∞'
                            },
                            grid: {
                                drawOnChartArea: false,
                            },
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    if (context.datasetIndex === 0) {
                                        return context.parsed.y === 1 ? '–í—ã–ø–∞–ª' : '–ù–µ –≤—ã–ø–∞–ª';
                                    } else {
                                        return `–ß–∞—Å—Ç–æ—Ç–∞: ${context.parsed.y}`;
                                    }
                                }
                            }
                        }
                    }
                }
            });
        }

        // –†–∞—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º
        function calculateGapStats(numberData) {
            if (numberData.length < 2) {
                return { avgGap: 0, stdDev: 0, cv: 0 };
            }

                const gaps = [];
            for (let i = 0; i < numberData.length - 1; i++) {
                const gap = Math.abs(parseInt(numberData[i].draw_number) - parseInt(numberData[i+1].draw_number));
                        gaps.push(gap);
                    }

            if (gaps.length === 0) {
                return { avgGap: 0, stdDev: 0, cv: 0 };
            }

            const avgGap = gaps.reduce((a, b) => a + b, 0) / gaps.length;
            
            const variance = gaps.reduce((sum, gap) => sum + Math.pow(gap - avgGap, 2), 0) / gaps.length;
            const stdDev = Math.sqrt(variance);
            
            const cv = avgGap > 0 ? stdDev / avgGap : 0;

            return {
                avgGap: avgGap,
                stdDev: stdDev,
                cv: cv
            };
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤
        function updatePredictions(numberData) {
            const predictionsDiv = document.getElementById('predictions');
            const predictions = generatePredictions(numberData);
            
            predictionsDiv.innerHTML = predictions.map(pred => `
                <div class="prediction-item">
                    <h4>${pred.title}</h4>
                    <p>${pred.description}</p>
                    <div style="color: ${pred.color}; font-weight: bold; font-size: 1.1em;">${pred.value}</div>
                </div>
            `).join('');
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–≥–Ω–æ–∑–æ–≤
        function generatePredictions(numberData) {
            const predictions = [];
            const appearances = numberData.length;
            const totalDraws = lottoData.draws.length;
            
            if (appearances === 0) {
                predictions.push({
                    title: '–ù–æ–º–µ—Ä –Ω–µ –≤—ã–ø–∞–¥–∞–ª',
                    description: '–≠—Ç–æ—Ç –Ω–æ–º–µ—Ä –µ—â–µ –Ω–µ –≤—ã–ø–∞–¥–∞–ª –≤ –∏—Å—Ç–æ—Ä–∏–∏',
                    value: '–í—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–ø–∞–¥–µ–Ω–∏—è',
                    color: '#4caf50'
                });
                return predictions;
            }

            // RSI –∞–Ω–∞–ª–∏–∑
            const rsiData = calculateRSI(selectedNumber);
            predictions.push({
                title: 'üìä –ù–ê–°–ö–û–õ–¨–ö–û "–†–ê–ó–û–ì–†–ï–¢" –ù–û–ú–ï–†',
                description: `–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ —á–∞—Å—Ç–æ –Ω–æ–º–µ—Ä –≤—ã–ø–∞–¥–∞–ª –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è (0-100)`,
                value: rsiData.status,
                color: rsiData.rsi > 70 ? '#ff4444' : rsiData.rsi < 30 ? '#44aa44' : '#ff9800'
            });

            // –°–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ä–µ–¥–Ω–∏–µ
            const maData = calculateMovingAverages(selectedNumber);


            // –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–æ–ª–≥–∞
            const debtData = calculateDebtIndicator(selectedNumber);
            predictions.push({
                title: '‚è∞ –ö–û–ì–î–ê –ü–û–°–õ–ï–î–ù–ò–ô –†–ê–ó –í–´–ü–ê–î–ê–õ',
                description: `–ù–µ –≤—ã–ø–∞–¥–∞–ª ${debtData.debt} —Ç–∏—Ä–∞–∂–µ–π –ø–æ–¥—Ä—è–¥`,
                value: debtData.status,
                color: debtData.debt > 15 ? '#44aa44' : debtData.debt > 10 ? '#ff9800' : '#ff4444'
            });

            // –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
            const patternData = analyzeChartPatterns(selectedNumber);
            if (patternData.patterns.length > 0) {
                patternData.patterns.forEach(pattern => {
                    predictions.push({
                        title: pattern.name,
                        description: pattern.description,
                        value: pattern.signal,
                        color: pattern.color
                    });
                });
            } else {
                predictions.push({
                    title: 'üìä –ì–†–ê–§–ò–ß–ï–°–ö–ò–ï –ü–ê–¢–¢–ï–†–ù–´',
                    description: '–ê–Ω–∞–ª–∏–∑ —Ñ–∏–≥—É—Ä –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ —á–∞—Å—Ç–æ—Ç—ã',
                    value: patternData.summary,
                    color: '#9c27b0'
                });
            }

            // –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –æ–∂–∏–¥–∞–Ω–∏–π
            const statisticalAnalysis = calculateStatisticalExpectations(selectedNumber);
            predictions.push({
                title: 'üìà –ú–ê–¢–ï–ú–ê–¢–ò–ß–ï–°–ö–û–ï –û–ñ–ò–î–ê–ù–ò–ï',
                description: '–°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∏—Ä–∞–∂–µ–π –º–µ–∂–¥—É –≤—ã–ø–∞–¥–µ–Ω–∏—è–º–∏',
                value: statisticalAnalysis.expectedGap,
                color: '#673ab7'
            });

            predictions.push({
                title: 'üìä –î–û–í–ï–†–ò–¢–ï–õ–¨–ù–´–ï –ò–ù–¢–ï–†–í–ê–õ–´',
                description: '–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤—ã–ø–∞–¥–µ–Ω–∏—è',
                value: statisticalAnalysis.confidenceIntervals,
                color: '#3f51b5'
            });

            predictions.push({
                title: 'üéØ –°–¢–ê–¢–ò–°–¢–ò–ß–ï–°–ö–ò–ô –†–ï–ô–¢–ò–ù–ì',
                description: '–ü–æ–∑–∏—Ü–∏—è –Ω–æ–º–µ—Ä–∞ —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö 49 –Ω–æ–º–µ—Ä–æ–≤',
                value: statisticalAnalysis.ranking,
                color: '#2196f3'
            });

            predictions.push({
                title: 'üìâ –ê–ù–ê–õ–ò–ó –°–¢–ê–ë–ò–õ–¨–ù–û–°–¢–ò',
                description: '–ù–∞—Å–∫–æ–ª—å–∫–æ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º –Ω–æ–º–µ—Ä (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–∞—Ä–∏–∞—Ü–∏–∏)',
                value: statisticalAnalysis.stability,
                color: '#00bcd4'
            });

            predictions.push({
                title: 'üìä –ö–í–ê–ù–¢–ò–õ–ò –í–ï–†–û–Ø–¢–ù–û–°–¢–ò',
                description: '25%, 50%, 75% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤—ã–ø–∞–¥–µ–Ω–∏—è',
                value: statisticalAnalysis.quantiles,
                color: '#ff9800'
            });

            predictions.push({
                title: 'üéØ –î–û–í–ï–†–ò–¢–ï–õ–¨–ù–´–ï –ò–ù–¢–ï–†–í–ê–õ–´',
                description: '–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã —Å 95% —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é',
                value: statisticalAnalysis.confidence95,
                color: '#e91e63'
            });

            predictions.push({
                title: 'üìà –°–†–ê–í–ù–ò–¢–ï–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó',
                description: '–ü–æ–∑–∏—Ü–∏—è —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö 49 –Ω–æ–º–µ—Ä–æ–≤',
                value: statisticalAnalysis.comparative,
                color: '#9c27b0'
            });

            predictions.push({
                title: 'üìÖ –ê–ù–ê–õ–ò–ó –°–ï–ó–û–ù–ù–û–°–¢–ò',
                description: '–ó–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏ –∏ –º–µ—Å—è—Ü–∞–º',
                value: statisticalAnalysis.seasonality,
                color: '#795548'
            });

            // –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–∞
            const recentAppearances = numberData.slice(-5);
            const trend = analyzeTrend(recentAppearances);
            
            predictions.push({
                title: 'üìâ –¢–†–ï–ù–î',
                description: '–ê–Ω–∞–ª–∏–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤—ã–ø–∞–¥–µ–Ω–∏–π',
                value: trend,
                color: trend.includes('–£—Å–∫–æ—Ä—è–µ—Ç—Å—è') ? '#4caf50' : trend.includes('–ó–∞–º–µ–¥–ª—è–µ—Ç—Å—è') ? '#f44336' : '#ff9800'
            });

            // –ü—Ä–æ–≥–Ω–æ–∑ —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤—ã–ø–∞–¥–µ–Ω–∏—è
            const nextPrediction = predictNextAppearance(numberData);
            predictions.push({
                title: 'üîÆ –ü–†–û–ì–ù–û–ó',
                description: '–û–∂–∏–¥–∞–µ–º—ã–π —Ç–∏—Ä–∞–∂',
                value: nextPrediction,
                color: '#9c27b0'
            });

            // –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è
            const recommendation = getRecommendation(numberData);
            predictions.push({
                title: 'üéØ –°–¢–ê–¢–£–° –ù–û–ú–ï–†–ê',
                description: recommendation.description,
                value: recommendation.text,
                color: recommendation.color
            });
            
            predictions.push({
                title: 'üìà –í–ï–†–û–Ø–¢–ù–û–°–¢–¨ –í–´–ü–ê–î–ï–ù–ò–Ø',
                description: '–û—Ü–µ–Ω–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–µ–¥–∞–≤–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
                value: recommendation.probability,
                color: recommendation.color
            });
            
            predictions.push({
                title: 'üí° –ß–¢–û –î–ï–õ–ê–¢–¨',
                description: '–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã',
                value: recommendation.action,
                color: '#9c27b0'
            });

            return predictions;
        }

        // –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–∞ (–ø–æ–Ω—è—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞)
        function analyzeTrend(recentAppearances) {
            if (recentAppearances.length < 3) {
                return '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö';
            }

            // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –≤—ã–ø–∞–¥–µ–Ω–∏–π
            const lastFive = recentAppearances.slice(-5);
            if (lastFive.length < 3) {
                return '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö';
            }

            const gaps = [];
            for (let i = 1; i < lastFive.length; i++) {
                if (lastFive[i].draw_number && lastFive[i-1].draw_number) {
                    const gap = parseInt(lastFive[i].draw_number) - parseInt(lastFive[i-1].draw_number);
                    gaps.push(gap);
                }
            }

            if (gaps.length < 2) {
                return '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö';
            }

            const avgGap = gaps.reduce((a, b) => a + b, 0) / gaps.length;
            const lastGap = gaps[gaps.length - 1];

            // –ü–û–ù–Ø–¢–ù–ê–Ø –õ–û–ì–ò–ö–ê:
            // –ï—Å–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ –º–µ–Ω—å—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ = –Ω–æ–º–µ—Ä –≤—ã–ø–∞–¥–∞–µ—Ç –ß–ê–©–ï
            // –ï—Å–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ –±–æ–ª—å—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ = –Ω–æ–º–µ—Ä –≤—ã–ø–∞–¥–∞–µ—Ç –†–ï–ñ–ï
            if (lastGap < avgGap * 0.8) {
                return '–£—Å–∫–æ—Ä—è–µ—Ç—Å—è (–≤—ã–ø–∞–¥–∞–µ—Ç —á–∞—â–µ)';
            } else if (lastGap > avgGap * 1.2) {
                return '–ó–∞–º–µ–¥–ª—è–µ—Ç—Å—è (–≤—ã–ø–∞–¥–∞–µ—Ç —Ä–µ–∂–µ)';
            } else {
                return '–°—Ç–∞–±–∏–ª—å–Ω—ã–π';
            }
        }

        // –ü—Ä–æ–≥–Ω–æ–∑ —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤—ã–ø–∞–¥–µ–Ω–∏—è —Å –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é
        function predictNextAppearance(numberData) {
            if (numberData.length < 2) {
                return '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö';
            }

            const gaps = [];
            for (let i = 1; i < numberData.length; i++) {
                if (numberData[i].draw_number && numberData[i-1].draw_number) {
                    const gap = parseInt(numberData[i].draw_number) - parseInt(numberData[i-1].draw_number);
                    gaps.push(gap);
                }
            }

            if (gaps.length === 0) {
                return '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö';
            }

            const avgGap = gaps.reduce((a, b) => a + b, 0) / gaps.length;
            const lastDrawNumber = parseInt(numberData[numberData.length - 1].draw_number);
            const predictedDraw = Math.round(lastDrawNumber + avgGap);
            const range = Math.round(avgGap * 0.3);
            
            // –†–∞—Å—á–µ—Ç –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
            const probability = calculateMathematicalProbability(selectedNumber, predictedDraw, range);
            
            return `–¢–∏—Ä–∞–∂ ‚Ññ${predictedDraw} (¬±${range}) —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é ${probability}%`;
        }

        // –†–∞—Å—á–µ—Ç –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø–æ—è–≤–ª–µ–Ω–∏—è –Ω–æ–º–µ—Ä–∞
        function calculateMathematicalProbability(number, predictedDraw, range) {
            const numberData = lottoData.number_data[number] || [];
            const totalDraws = lottoData.draws.length;
            
            // –ë–∞–∑–æ–≤–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å (—á–∞—Å—Ç–æ—Ç–∞ –≤—ã–ø–∞–¥–µ–Ω–∏–π)
            const baseProbability = (numberData.length / totalDraws) * 100;
            
            // –ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞
            let statusModifier = 0;
            const recentDraws = lottoData.draws.slice(0, 20);
            let recentCount = 0;
            recentDraws.forEach(draw => {
                if (draw.numbers.includes(number)) recentCount++;
            });
            const recentFrequency = recentCount / recentDraws.length;
            const expectedFrequency = numberData.length / totalDraws;
            
            // –ï—Å–ª–∏ –Ω–æ–º–µ—Ä —Ö–æ–ª–æ–¥–Ω—ã–π (–≤—ã–ø–∞–¥–∞–µ—Ç —Ä–µ–∂–µ –æ–±—ã—á–Ω–æ–≥–æ)
            if (recentFrequency < expectedFrequency * 0.5) {
                statusModifier = 25; // +25% –∫ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
            }
            // –ï—Å–ª–∏ –Ω–æ–º–µ—Ä –≥–æ—Ä—è—á–∏–π (–≤—ã–ø–∞–¥–∞–µ—Ç —á–∞—â–µ –æ–±—ã—á–Ω–æ–≥–æ)
            else if (recentFrequency > expectedFrequency * 1.5) {
                statusModifier = -20; // -20% –∫ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
            }
            
            // –ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ "–¥–æ–ª–≥–∞" (—Å–∫–æ–ª—å–∫–æ —Ç–∏—Ä–∞–∂–µ–π –Ω–µ –≤—ã–ø–∞–¥–∞–ª)
            const debtData = calculateDebtIndicator(number);
            let debtModifier = 0;
            if (debtData.debt > 20) {
                debtModifier = 30; // +30% –µ—Å–ª–∏ –æ—á–µ–Ω—å –¥–∞–≤–Ω–æ –Ω–µ –≤—ã–ø–∞–¥–∞–ª
            } else if (debtData.debt > 15) {
                debtModifier = 20; // +20% –µ—Å–ª–∏ –¥–∞–≤–Ω–æ –Ω–µ –≤—ã–ø–∞–¥–∞–ª
            } else if (debtData.debt > 10) {
                debtModifier = 10; // +10% –µ—Å–ª–∏ –Ω–µ–¥–∞–≤–Ω–æ –Ω–µ –≤—ã–ø–∞–¥–∞–ª
            } else if (debtData.debt < 3) {
                debtModifier = -15; // -15% –µ—Å–ª–∏ –Ω–µ–¥–∞–≤–Ω–æ –≤—ã–ø–∞–¥–∞–ª
            }
            
            // –ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç—Ä–µ–Ω–¥–∞ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞)
            let trendModifier = 0;
            const trend = calculateNumberTrend(number);
            if (trend === 'up') {
                // –ï—Å–ª–∏ —Ç—Ä–µ–Ω–¥ —É—Å–∫–æ—Ä—è–µ—Ç—Å—è –ò –Ω–æ–º–µ—Ä —Ö–æ–ª–æ–¥–Ω—ã–π - –≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å
                if (recentFrequency < expectedFrequency * 0.7) {
                    trendModifier = 15; // +15%
                } else {
                    trendModifier = -10; // -10% –µ—Å–ª–∏ –≥–æ—Ä—è—á–∏–π –Ω–æ–º–µ—Ä —É—Å–∫–æ—Ä—è–µ—Ç—Å—è
                }
            } else if (trend === 'down') {
                // –ï—Å–ª–∏ —Ç—Ä–µ–Ω–¥ –∑–∞–º–µ–¥–ª—è–µ—Ç—Å—è –ò –Ω–æ–º–µ—Ä —Ö–æ–ª–æ–¥–Ω—ã–π - –∏—â–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é —Ç–æ—á–∫—É
                if (recentFrequency < expectedFrequency * 0.5 && debtData.debt > 15) {
                    trendModifier = 20; // +20% - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Ç–æ—á–∫–∞ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞
                } else {
                    trendModifier = -5; // -5% –≤ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö
                }
            }
            
            // –ò—Ç–æ–≥–æ–≤–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å
            let finalProbability = baseProbability + statusModifier + debtModifier + trendModifier;
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç 5% –¥–æ 95%
            finalProbability = Math.max(5, Math.min(95, finalProbability));
            
            return Math.round(finalProbability);
        }

        // –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –æ–∂–∏–¥–∞–Ω–∏–π (—á–µ—Å—Ç–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞)
        function calculateStatisticalExpectations(number) {
            const numberData = lottoData.number_data[number] || [];
            if (numberData.length < 3) {
                return {
                    expectedGap: '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö',
                    confidenceIntervals: '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö',
                    ranking: '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö',
                    stability: '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö'
                };
            }

            // 1. –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ (—Å—Ä–µ–¥–Ω–∏–π –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫)
            const gaps = [];
            for (let i = 1; i < numberData.length; i++) {
                if (numberData[i].draw_number && numberData[i-1].draw_number) {
                    const gap = Math.abs(parseInt(numberData[i].draw_number) - parseInt(numberData[i-1].draw_number));
                    gaps.push(gap);
                }
            }
            
            const expectedGap = gaps.length > 0 ? (gaps.reduce((a, b) => a + b, 0) / gaps.length).toFixed(1) : 0;
            
            // 2. –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã (25%, 50%, 75% –∫–≤–∞–Ω—Ç–∏–ª–∏)
            const sortedGaps = gaps.sort((a, b) => a - b);
            const q25 = sortedGaps[Math.floor(sortedGaps.length * 0.25)];
            const q50 = sortedGaps[Math.floor(sortedGaps.length * 0.5)];
            const q75 = sortedGaps[Math.floor(sortedGaps.length * 0.75)];
            
            const confidenceIntervals = `25%: ${q25}, 50%: ${q50}, 75%: ${q75} —Ç–∏—Ä–∞–∂–µ–π`;
            
            // 3. –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–π—Ç–∏–Ω–≥ —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö –Ω–æ–º–µ—Ä–æ–≤
            const allFrequencies = [];
            for (let i = 1; i <= 49; i++) {
                const numData = lottoData.number_data[i] || [];
                const frequency = numData.length / lottoData.draws.length;
                allFrequencies.push({ number: i, frequency: frequency });
            }
            
            allFrequencies.sort((a, b) => b.frequency - a.frequency);
            const currentFrequency = numberData.length / lottoData.draws.length;
            const rank = allFrequencies.findIndex(item => item.number === number) + 1;
            const percentile = Math.round((1 - (rank - 1) / 49) * 100);
            
            const ranking = `–†–∞–Ω–≥: ${rank}/49 (${percentile}% –ª—É—á—à–∏—Ö)`;
            
            // 4. –ê–Ω–∞–ª–∏–∑ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–∞—Ä–∏–∞—Ü–∏–∏)
            const mean = gaps.reduce((a, b) => a + b, 0) / gaps.length;
            const variance = gaps.reduce((sum, gap) => sum + Math.pow(gap - mean, 2), 0) / gaps.length;
            const stdDev = Math.sqrt(variance);
            const coefficientOfVariation = (stdDev / mean * 100).toFixed(1);
            
            let stabilityLevel;
            if (coefficientOfVariation < 30) stabilityLevel = '–û—á–µ–Ω—å —Å—Ç–∞–±–∏–ª—å–Ω—ã–π';
            else if (coefficientOfVariation < 50) stabilityLevel = '–°—Ç–∞–±–∏–ª—å–Ω—ã–π';
            else if (coefficientOfVariation < 70) stabilityLevel = '–£–º–µ—Ä–µ–Ω–Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π';
            else stabilityLevel = '–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–π';
            
            const stability = `${stabilityLevel} (CV: ${coefficientOfVariation}%)`;

            // 5. –ö–≤–∞–Ω—Ç–∏–ª–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (–±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω—ã–µ)
            const q10 = sortedGaps[Math.floor(sortedGaps.length * 0.1)];
            const q90 = sortedGaps[Math.floor(sortedGaps.length * 0.9)];
            const quantiles = `10%: ${q10}, 25%: ${q25}, 50%: ${q50}, 75%: ${q75}, 90%: ${q90} —Ç–∏—Ä–∞–∂–µ–π`;

            // 6. –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã (95% —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å)
            const z95 = 1.96; // Z-–∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è 95% –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞
            const marginOfError = z95 * (stdDev / Math.sqrt(gaps.length));
            const lowerBound = Math.max(1, Math.round(mean - marginOfError));
            const upperBound = Math.round(mean + marginOfError);
            const confidence95 = `95% —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: ${lowerBound}-${upperBound} —Ç–∏—Ä–∞–∂–µ–π`;

            // 7. –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑
            const totalNumbers = 49;
            const betterThan = allFrequencies.filter(item => item.frequency < currentFrequency).length;
            const worseThan = allFrequencies.filter(item => item.frequency > currentFrequency).length;
            const comparative = `–õ—É—á—à–µ ${betterThan} –Ω–æ–º–µ—Ä–æ–≤, —Ö—É–∂–µ ${worseThan} –Ω–æ–º–µ—Ä–æ–≤ –∏–∑ ${totalNumbers}`;

            // 8. –ê–Ω–∞–ª–∏–∑ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏ (–ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏ –∏ –º–µ—Å—è—Ü–∞–º)
            const seasonality = analyzeSeasonality(number);

            return {
                expectedGap: `${expectedGap} —Ç–∏—Ä–∞–∂–µ–π`,
                confidenceIntervals: confidenceIntervals,
                ranking: ranking,
                stability: stability,
                quantiles: quantiles,
                confidence95: confidence95,
                comparative: comparative,
                seasonality: seasonality
            };
        }

        // –ê–Ω–∞–ª–∏–∑ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏ (–∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏)
        function analyzeSeasonality(number) {
            const numberData = lottoData.number_data[number] || [];
            if (numberData.length < 10) {
                return '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏';
            }

            // –ê–Ω–∞–ª–∏–∑ –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏
            const dayStats = {};
            const monthStats = {};
            
            numberData.forEach(appearance => {
                if (appearance.date) {
                    const date = new Date(appearance.date);
                    const dayOfWeek = date.getDay(); // 0 = –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ, 1 = –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, etc.
                    const month = date.getMonth(); // 0 = —è–Ω–≤–∞—Ä—å, 1 = —Ñ–µ–≤—Ä–∞–ª—å, etc.
                    
                    const dayNames = ['–í—Å', '–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±'];
                    const monthNames = ['–Ø–Ω–≤', '–§–µ–≤', '–ú–∞—Ä', '–ê–ø—Ä', '–ú–∞–π', '–ò—é–Ω', 
                                     '–ò—é–ª', '–ê–≤–≥', '–°–µ–Ω', '–û–∫—Ç', '–ù–æ—è', '–î–µ–∫'];
                    
                    const dayName = dayNames[dayOfWeek];
                    const monthName = monthNames[month];
                    
                    dayStats[dayName] = (dayStats[dayName] || 0) + 1;
                    monthStats[monthName] = (monthStats[monthName] || 0) + 1;
                }
            });

            // –ù–∞—Ö–æ–¥–∏–º –Ω–∞–∏–±–æ–ª–µ–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –¥–Ω–∏ –∏ –º–µ—Å—è—Ü—ã
            const bestDay = Object.entries(dayStats).reduce((a, b) => dayStats[a[0]] > dayStats[b[0]] ? a : b);
            const bestMonth = Object.entries(monthStats).reduce((a, b) => monthStats[a[0]] > monthStats[b[0]] ? a : b);
            
            const totalAppearances = numberData.length;
            const dayPercentage = ((bestDay[1] / totalAppearances) * 100).toFixed(1);
            const monthPercentage = ((bestMonth[1] / totalAppearances) * 100).toFixed(1);

            return `–õ—É—á—à–∏–π –¥–µ–Ω—å: ${bestDay[0]} (${dayPercentage}%), –ª—É—á—à–∏–π –º–µ—Å—è—Ü: ${bestMonth[0]} (${monthPercentage}%)`;
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (—É–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞)
        function getRecommendation(numberData) {
            const appearances = numberData.length;
            const totalDraws = lottoData.draws.length;
            const overallFrequency = appearances / totalDraws;
            const trend = calculateNumberTrend(selectedNumber);

            // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Ç–∏—Ä–∞–∂–µ–π
            const recentDraws = lottoData.draws.slice(0, 20);
            let recentCount = 0;
            recentDraws.forEach(draw => {
                if (draw.numbers.includes(selectedNumber)) {
                    recentCount++;
                }
            });

            const recentFrequency = recentCount / recentDraws.length;
            const frequencyRatio = recentFrequency / overallFrequency;

            // –õ–û–ì–ò–ß–ù–ê–Ø –°–ò–°–¢–ï–ú–ê –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ô:
            // –û—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ –Ω–µ–¥–∞–≤–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å –æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
            
            if (trend === 'very-hot') {
                return {
                    text: 'üî• –û–ß–ï–ù–¨ –ì–û–†–Ø–ß–ò–ô!',
                    description: `–í—ã–ø–∞–¥–∞–µ—Ç –≤ ${frequencyRatio.toFixed(1)} —Ä–∞–∑–∞ —á–∞—â–µ –æ–±—ã—á–Ω–æ–≥–æ. –ü–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Ç–∏—Ä–∞–∂–µ–π: ${recentCount} —Ä–∞–∑.`,
                    action: '‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –ù–æ–º–µ—Ä "–ø–µ—Ä–µ–≥—Ä–µ—Ç"! –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ –ø–∞—É–∑—ã. –õ—É—á—à–µ –ø–æ–¥–æ–∂–¥–∞—Ç—å.',
                    color: '#ff4444',
                    probability: '–ù–ò–ó–ö–ê–Ø –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤ –±–ª–∏–∂–∞–π—à–∏—Ö —Ç–∏—Ä–∞–∂–∞—Ö'
                };
            } else if (trend === 'hot') {
                return {
                    text: 'üü† –ì–û–†–Ø–ß–ò–ô',
                    description: `–í—ã–ø–∞–¥–∞–µ—Ç –≤ ${frequencyRatio.toFixed(1)} —Ä–∞–∑–∞ —á–∞—â–µ –æ–±—ã—á–Ω–æ–≥–æ. –ü–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Ç–∏—Ä–∞–∂–µ–π: ${recentCount} —Ä–∞–∑.`,
                    action: '‚ö° –û–°–¢–û–†–û–ñ–ù–û: –ú–æ–∂–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –Ω–æ —Ä–∏—Å–∫ –æ—Å—Ç—ã–≤–∞–Ω–∏—è —Ä–∞—Å—Ç–µ—Ç.',
                    color: '#ff8800',
                    probability: '–°–†–ï–î–ù–Ø–Ø –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤ –±–ª–∏–∂–∞–π—à–∏—Ö —Ç–∏—Ä–∞–∂–∞—Ö'
                };
            } else if (trend === 'cold') {
                return {
                    text: 'üü¢ –•–û–õ–û–î–ù–´–ô',
                    description: `–í—ã–ø–∞–¥–∞–µ—Ç –≤ ${frequencyRatio.toFixed(1)} —Ä–∞–∑–∞ —Ä–µ–∂–µ –æ–±—ã—á–Ω–æ–≥–æ. –ü–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Ç–∏—Ä–∞–∂–µ–π: ${recentCount} —Ä–∞–∑.`,
                    action: '‚úÖ –•–û–†–û–®–û: –ù–æ–º–µ—Ä "–¥–æ–ª–∂–µ–Ω" –≤—ã–ø–∞—Å—Ç—å –ø–æ —Ç–µ–æ—Ä–∏–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π.',
                    color: '#44aa44',
                    probability: '–í–´–°–û–ö–ê–Ø –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤ –±–ª–∏–∂–∞–π—à–∏—Ö —Ç–∏—Ä–∞–∂–∞—Ö'
                };
            } else if (trend === 'very-cold') {
                return {
                    text: 'üîµ –û–ß–ï–ù–¨ –•–û–õ–û–î–ù–´–ô!',
                    description: `–í—ã–ø–∞–¥–∞–µ—Ç –≤ ${frequencyRatio.toFixed(1)} —Ä–∞–∑–∞ —Ä–µ–∂–µ –æ–±—ã—á–Ω–æ–≥–æ. –ü–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Ç–∏—Ä–∞–∂–µ–π: ${recentCount} —Ä–∞–∑.`,
                    action: 'üéØ –û–¢–õ–ò–ß–ù–û: –ù–æ–º–µ—Ä "–ø–µ—Ä–µ–æ—Ö–ª–∞–∂–¥–µ–Ω"! –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–∫–æ—Ä–æ–≥–æ –ø–æ—è–≤–ª–µ–Ω–∏—è.',
                    color: '#0066cc',
                    probability: '–û–ß–ï–ù–¨ –í–´–°–û–ö–ê–Ø –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤ –±–ª–∏–∂–∞–π—à–∏—Ö —Ç–∏—Ä–∞–∂–∞—Ö'
                };
            } else {
                return {
                    text: '‚ö™ –°–¢–ê–ë–ò–õ–¨–ù–´–ô',
                    description: `–í—ã–ø–∞–¥–∞–µ—Ç —Å –æ–±—ã—á–Ω–æ–π —á–∞—Å—Ç–æ—Ç–æ–π. –ü–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Ç–∏—Ä–∞–∂–µ–π: ${recentCount} —Ä–∞–∑.`,
                    action: 'üìä –ù–ï–ô–¢–†–ê–õ–¨–ù–û: –°—Ç–∞–±–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –∏–≥—Ä—ã.',
                    color: '#888888',
                    probability: '–°–†–ï–î–ù–Ø–Ø –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤ –±–ª–∏–∂–∞–π—à–∏—Ö —Ç–∏—Ä–∞–∂–∞—Ö'
                };
            }
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–∏—Ä–∞–∂–∞
        function addNewDraw() {
            const date = document.getElementById('newDate').value;
            const drawNumber = document.getElementById('newDrawNumber').value;
            const numbersStr = document.getElementById('newNumbers').value;

            if (!date || !drawNumber || !numbersStr) {
                showError('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }

            try {
                // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–≤–æ–¥–∞ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é –∏–ª–∏ –ø—Ä–æ–±–µ–ª
            const numbers = numbersStr.split(/[,\s]+/).map(n => parseInt(n.trim())).filter(n => !isNaN(n));
                
                if (numbers.length !== 6 || numbers.some(n => isNaN(n) || n < 1 || n > 49)) {
                    showError('–í–≤–µ–¥–∏—Ç–µ 6 —á–∏—Å–µ–ª –æ—Ç 1 –¥–æ 49 —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é');
                    return;
                }

                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π —Ç–∏—Ä–∞–∂
                const newDraw = {
                    date: date.split('-').reverse().join('.'),
                    draw_number: drawNumber,
                    numbers: numbers
                };

                lottoData.draws.unshift(newDraw);

                // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –Ω–æ–º–µ—Ä–∞–º
                numbers.forEach(number => {
                    if (!lottoData.number_data[number]) {
                        lottoData.number_data[number] = [];
                    }
                    lottoData.number_data[number].unshift({
                        date: newDraw.date,
                        draw_number: drawNumber
                    });
                });

                // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                document.getElementById('newDate').value = '';
                document.getElementById('newDrawNumber').value = '';
                document.getElementById('newNumbers').value = '';

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ localStorage
                saveData();

                // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–≤–µ—Ç–æ–≤—É—é –∏–Ω–¥–∏–∫–∞—Ü–∏—é
                updateNumberTrends();

                // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫ –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω –Ω–æ–º–µ—Ä
                if (selectedNumber) {
                    updateChart();
                }

                showSuccess('–¢–∏—Ä–∞–∂ –¥–æ–±–∞–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ!');

            } catch (error) {
                showError('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ç–∏—Ä–∞–∂–∞: ' + error.message);
            }
        }

        // –ü–æ–∫–∞–∑ –æ—à–∏–±–∫–∏
        function showError(message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error';
            errorDiv.textContent = message;
            document.querySelector('.controls').appendChild(errorDiv);
            setTimeout(() => errorDiv.remove(), 5000);
        }

        // –ü–æ–∫–∞–∑ —É—Å–ø–µ—Ö–∞
        function showSuccess(message) {
            const successDiv = document.createElement('div');
            successDiv.style.cssText = `
                background: #e8f5e8;
                color: #2e7d32;
                padding: var(--space-md);
                border-radius: var(--radius-md);
                margin: var(--space-sm) 0;
                border-left: 4px solid #2e7d32;
            `;
            successDiv.textContent = message;
            document.querySelector('.controls').appendChild(successDiv);
            setTimeout(() => successDiv.remove(), 3000);
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–∏—Ä–∞–∂–µ–π
        function toggleEditDraws() {
            const editSection = document.getElementById('editDrawsSection');
            if (editSection.style.display === 'none') {
                editSection.style.display = 'block';
                loadDrawsList();
            } else {
                editSection.style.display = 'none';
            }
        }

        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ —Ç–∏—Ä–∞–∂–µ–π
        let currentDrawsPage = 0;
        let drawsPerPage = 100;
        let showingAllDraws = false;

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Ç–∏—Ä–∞–∂–µ–π –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
        function loadDrawsList() {
            const drawsList = document.getElementById('drawsList');
            if (!lottoData || !lottoData.draws) {
                drawsList.innerHTML = '<p>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ç–∏—Ä–∞–∂–∞—Ö</p>';
                return;
            }

            const totalDraws = lottoData.draws.length;
            const startIndex = showingAllDraws ? 0 : currentDrawsPage * drawsPerPage;
            const endIndex = showingAllDraws ? totalDraws : Math.min(startIndex + drawsPerPage, totalDraws);
            const drawsToShow = lottoData.draws.slice(startIndex, endIndex);

            let html = '<div style="max-height: 400px; overflow-y: auto;">';
            html += '<table style="width: 100%; border-collapse: collapse; margin-bottom: var(--space-lg);">';
            html += '<thead><tr style="background: var(--bg-light);">';
            html += `<th style="padding: var(--space-sm); border: 1px solid var(--bg-lighter);">–î–∞—Ç–∞</th>`;
            html += `<th style="padding: var(--space-sm); border: 1px solid var(--bg-lighter);">–ù–æ–º–µ—Ä</th>`;
            html += `<th style="padding: var(--space-sm); border: 1px solid var(--bg-lighter);">–í—ã–∏–≥—Ä—ã—à–Ω—ã–µ –Ω–æ–º–µ—Ä–∞</th>`;
            html += `<th style="padding: var(--space-sm); border: 1px solid var(--bg-lighter);">–î–µ–π—Å—Ç–≤–∏—è</th>`;
            html += '</tr></thead><tbody>';

            drawsToShow.forEach((draw, index) => {
                const actualIndex = startIndex + index;
                html += '<tr>';
                html += `<td style="padding: var(--space-xs); border: 1px solid var(--bg-lighter);">${draw.date}</td>`;
                html += `<td style="padding: var(--space-xs); border: 1px solid var(--bg-lighter);">${draw.draw_number}</td>`;
                html += `<td style="padding: var(--space-xs); border: 1px solid var(--bg-lighter);">${draw.numbers.join(', ')}</td>`;
                html += `<td style="padding: var(--space-xs); border: 1px solid var(--bg-lighter);">`;
                html += `<button onclick="editDraw(${actualIndex})" style="margin-right: var(--space-xs); padding: var(--space-xs) var(--space-sm); background: var(--primary-color); color: var(--text-light); border: none; border-radius: var(--radius-sm); cursor: pointer;">–ò–∑–º–µ–Ω–∏—Ç—å</button>`;
                html += `<button onclick="deleteDraw(${actualIndex})" style="padding: var(--space-xs) var(--space-sm); background: var(--danger); color: var(--text-light); border: none; border-radius: var(--radius-sm); cursor: pointer;">–£–¥–∞–ª–∏—Ç—å</button>`;
                html += '</td>';
                html += '</tr>';
            });

            html += '</tbody></table>';
            
            // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
            if (showingAllDraws) {
                html += `<p style="color: var(--text-muted); font-size: 0.9em;">–ü–æ–∫–∞–∑–∞–Ω—ã –≤—Å–µ ${totalDraws} —Ç–∏—Ä–∞–∂–µ–π</p>`;
            } else {
                html += `<p style="color: var(--text-muted); font-size: 0.9em;">–ü–æ–∫–∞–∑–∞–Ω—ã —Ç–∏—Ä–∞–∂–∏ ${startIndex + 1}-${endIndex} –∏–∑ ${totalDraws}</p>`;
            }
            
            // –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            html += `<div style="margin-top: var(--space-md); text-align: center; padding: var(--space-sm); background: var(--bg-light); border-radius: var(--radius-md);">`;
            
            if (!showingAllDraws && endIndex < totalDraws) {
                html += `<button onclick="loadMoreDraws()" style="margin: 0 var(--space-xs); padding: var(--space-xs) var(--space-lg); background: var(--success); color: var(--text-light); border: none; border-radius: var(--radius-sm); cursor: pointer;">–ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â–µ ${drawsPerPage}</button>`;
            }
            
            if (!showingAllDraws && totalDraws > drawsPerPage) {
                html += `<button onclick="showAllDraws()" style="margin: 0 var(--space-xs); padding: var(--space-xs) var(--space-lg); background: var(--info); color: var(--text-light); border: none; border-radius: var(--radius-sm); cursor: pointer;">–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ</button>`;
            }
            
            if (showingAllDraws || currentDrawsPage > 0) {
                html += `<button onclick="resetDrawsView()" style="margin: 0 var(--space-xs); padding: var(--space-xs) var(--space-lg); background: var(--secondary); color: var(--text-light); border: none; border-radius: var(--radius-sm); cursor: pointer;">–°–±—Ä–æ—Å–∏—Ç—å</button>`;
            }
            
            html += '</div>';
            html += '</div>';

            drawsList.innerHTML = html;
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π —Ç–∏—Ä–∞–∂–µ–π
        function loadMoreDraws() {
            currentDrawsPage++;
            loadDrawsList();
        }

        function showAllDraws() {
            showingAllDraws = true;
            loadDrawsList();
        }

        function resetDrawsView() {
            currentDrawsPage = 0;
            showingAllDraws = false;
            loadDrawsList();
        }

        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∏—Ä–∞–∂–∞
        function editDraw(index) {
            const draw = lottoData.draws[index];
            
            // –°–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.5);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
            `;

            modal.innerHTML = `
                <div style="background: white; padding: 30px; border-radius: 10px; width: 500px; max-width: 90vw;">
                    <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∏—Ä–∞–∂–∞ ‚Ññ${draw.draw_number}</h3>
                    
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px;">–î–∞—Ç–∞:</label>
                        <input type="date" id="editDate" value="${draw.date.split('.').reverse().join('-')}" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px;">–ù–æ–º–µ—Ä —Ç–∏—Ä–∞–∂–∞:</label>
                        <input type="number" id="editDrawNumber" value="${draw.draw_number}" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 5px;">–í—ã–∏–≥—Ä—ã—à–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é –∏–ª–∏ –ø—Ä–æ–±–µ–ª):</label>
                        <input type="text" id="editNumbers" value="${draw.numbers.join(', ')}" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    
                    <div style="text-align: right;">
                        <button onclick="saveDrawEdit(${index})" style="margin-right: 10px; padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                        <button onclick="closeEditModal()" style="padding: 10px 20px; background: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer;">–û—Ç–º–µ–Ω–∞</button>
                    </div>
                </div>
            `;

            document.body.appendChild(modal);
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ç–∏—Ä–∞–∂–∞
        function saveDrawEdit(index) {
            const date = document.getElementById('editDate').value;
            const drawNumber = document.getElementById('editDrawNumber').value;
            const numbersStr = document.getElementById('editNumbers').value;

            if (!date || !drawNumber || !numbersStr) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }

            try {
                // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–≤–æ–¥–∞ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é –∏–ª–∏ –ø—Ä–æ–±–µ–ª
            const numbers = numbersStr.split(/[,\s]+/).map(n => parseInt(n.trim())).filter(n => !isNaN(n));
                
                if (numbers.length !== 6 || numbers.some(n => isNaN(n) || n < 1 || n > 49)) {
                    alert('–í–≤–µ–¥–∏—Ç–µ 6 —á–∏—Å–µ–ª –æ—Ç 1 –¥–æ 49 —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é');
                    return;
                }

                // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∏—Ä–∞–∂
                const oldDraw = lottoData.draws[index];
                lottoData.draws[index] = {
                    date: date.split('-').reverse().join('.'),
                    draw_number: drawNumber,
                    numbers: numbers
                };

                // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –Ω–æ–º–µ—Ä–∞–º
                // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏
                oldDraw.numbers.forEach(number => {
                    if (lottoData.number_data[number]) {
                        lottoData.number_data[number] = lottoData.number_data[number].filter(item => item.draw_number !== oldDraw.draw_number);
                    }
                });

                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏
                numbers.forEach(number => {
                    if (!lottoData.number_data[number]) {
                        lottoData.number_data[number] = [];
                    }
                    lottoData.number_data[number].push({
                        date: lottoData.draws[index].date,
                        draw_number: drawNumber
                    });
                });

                // –°–æ—Ä—Ç–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –Ω–æ–º–µ—Ä–∞–º —Ç–∏—Ä–∞–∂–µ–π
                for (let i = 1; i <= 49; i++) {
                    if (lottoData.number_data[i]) {
                        lottoData.number_data[i].sort((a, b) => parseInt(b.draw_number) - parseInt(a.draw_number));
                    }
                }

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ localStorage
                saveData();

                closeEditModal();
                loadDrawsList();
                updateNumberTrends();
                
                if (selectedNumber) {
                    updateChart();
                }

                showSuccess('–¢–∏—Ä–∞–∂ –æ–±–Ω–æ–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ!');

            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏: ' + error.message);
            }
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ —Ç–∏—Ä–∞–∂–∞
        function deleteDraw(index) {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–∏—Ä–∞–∂?')) {
                return;
            }

            const draw = lottoData.draws[index];
            
            // –£–¥–∞–ª—è–µ–º –∑–∞–ø–∏—Å–∏ –∏–∑ –¥–∞–Ω–Ω—ã—Ö –ø–æ –Ω–æ–º–µ—Ä–∞–º
            draw.numbers.forEach(number => {
                if (lottoData.number_data[number]) {
                    lottoData.number_data[number] = lottoData.number_data[number].filter(item => item.draw_number !== draw.draw_number);
                }
            });

            // –£–¥–∞–ª—è–µ–º —Ç–∏—Ä–∞–∂
            lottoData.draws.splice(index, 1);

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ localStorage
            saveData();

            loadDrawsList();
            updateNumberTrends();
            
            if (selectedNumber) {
                updateChart();
            }

            showSuccess('–¢–∏—Ä–∞–∂ —É–¥–∞–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ!');
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function closeEditModal() {
            const modal = document.querySelector('div[style*="position: fixed"]');
            if (modal) {
                modal.remove();
            }
        }

        // –í—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
        function selectStrategy(strategyType) {
            selectedStrategy = strategyType;

            // –û—á–∏—â–∞–µ–º —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏, –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–∞ –¥—Ä—É–≥–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
            if (window.lastGeneratedStrategy !== null &&
                window.lastGeneratedStrategy !== undefined &&
                window.lastGeneratedStrategy !== strategyType) {
                console.log(`–û—á–∏—â–∞–µ–º –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏: ${window.lastGeneratedStrategy}`);
                window.lastGeneratedCombinations = null;
                window.lastGeneratedStrategy = null;
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∏–∑—É–∞–ª –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
            document.querySelectorAll('.strategy-card').forEach(card => {
                card.classList.remove('selected');
            });
            document.querySelector(`[data-strategy="${strategyType}"]`).classList.add('selected');

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–æ–≤—ã–π –±–ª–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–∫–Ω–æ–ø–∫–∞ + —Å–µ–ª–µ–∫—Ç–æ—Ä)
            document.getElementById('generation-controls').style.display = 'flex';
        }


        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
        function updateStrategyCardsEfficiency() {
            const strategies = ['conservative', 'balanced', 'aggressive'];
            const testCount = parseInt(document.getElementById('testTirageCount').value, 10) || 20;

            strategies.forEach(strategy => {
                let efficiency = 0;
                let isCombinationEfficiency = false;

                // –í –∫–∞—Ä—Ç–æ—á–∫–∞—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –æ–Ω–∏ –±—ã–ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã
                if (window.lastGeneratedCombinations &&
                    window.lastGeneratedCombinations.length > 0 &&
                    window.lastGeneratedStrategy !== null &&
                    window.lastGeneratedStrategy !== undefined &&
                    window.lastGeneratedStrategy === strategy) {
                    // –ï—Å—Ç—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –∏–º–µ–Ω–Ω–æ –¥–ª—è —ç—Ç–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ - —Ç–µ—Å—Ç–∏—Ä—É–µ–º –∏—Ö —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
                    console.log(`–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ ${strategy} –Ω–∞ ${testCount} —Ç–∏—Ä–∞–∂–∞—Ö...`);
                    const newEfficiency = testGeneratedCombinationEfficiency(window.lastGeneratedCombinations, testCount);
                    efficiency = newEfficiency;
                    isCombinationEfficiency = true;
                    console.log(`–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è ${strategy}: ${efficiency}%`);

                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å –¥–∞—à–±–æ—Ä–¥–æ–º
                    window.currentCombinationEfficiency = {
                        strategy: strategy,
                        efficiency: efficiency,
                        testCount: testCount
                    };
                } else {
                    // –î–ª—è –¥—Ä—É–≥–∏—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–∞–Ω–µ–µ –∑–∞–∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
                    // –ù–ï –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –∏—Ö –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–∏—Ä–∞–∂–µ–π
                    efficiency = strategyEfficiencyCache[strategy] || 0;
                    console.log(`–ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ ${strategy}: ${efficiency}%`);
                }

                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç –≤ –∫–∞—Ä—Ç–æ—á–∫–µ
                const strategyCard = document.querySelector(`[data-strategy="${strategy}"]`);
                if (strategyCard) {
                    const testElements = strategyCard.querySelectorAll('.stat-label');
                    testElements.forEach((label, index) => {
                        if (label.textContent.includes('–¢–ï–°–¢:')) {
                            const valueElement = label.parentElement.querySelector('.stat-value');
                            if (valueElement) {
                                valueElement.textContent = `${efficiency}%`;
                                // –ú–µ–Ω—è–µ–º —Ü–≤–µ—Ç –∏ —Å—Ç–∏–ª—å –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
                                if (isCombinationEfficiency) {
                                    valueElement.style.color = efficiency > 15 ? '#4caf50' : efficiency > 8 ? '#ff9800' : '#f44336';
                                    valueElement.style.fontWeight = 'bold';
                                    valueElement.style.textShadow = '0 0 3px rgba(0,0,0,0.3)';
                                } else {
                                    valueElement.style.color = '';
                                    valueElement.style.fontWeight = '';
                                    valueElement.style.textShadow = '';
                                }
                            }
                        }
                    });
                }
            });
        }

        // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
        function testGeneratedCombinationEfficiency(generatedCombinations, numTests = 20) {
            if (!generatedCombinations || generatedCombinations.length === 0) {
                console.log('–ù–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è');
                return 0;
            }

            // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ –∂–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∏—Ä–∞–∂–µ–π, —á—Ç–æ –∏ –≤ displayStrategyResults
            const userTestCount = parseInt(document.getElementById('testTirageCount').value, 10) || 20;
            const actualTestCount = Math.min(userTestCount, lottoData.draws.length);

            // –£–±–∏—Ä–∞–µ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ +10 —Ç–∏—Ä–∞–∂–µ–π, –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—É—é –ø—Ä–æ–≤–µ—Ä–∫—É
            if (lottoData.draws.length < actualTestCount) {
                console.log(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ ${actualTestCount} —Ç–∏—Ä–∞–∂–∞—Ö`);
                return 0;
            }

            // –ò–°–ü–û–õ–¨–ó–£–ï–ú –¢–ï –ñ–ï –ö–û–ú–ë–ò–ù–ê–¶–ò–ò, –ö–û–¢–û–†–´–ï –ü–û–ö–ê–ó–ê–ù–´ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Æ!
            // –ë–µ—Ä–µ–º —Å–∞–º—ã–µ —Å–≤–µ–∂–∏–µ actualTestCount —Ç–∏—Ä–∞–∂–µ–π –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–∫–∞–∫ –≤ displayStrategyResults)
            const testDraws = lottoData.draws.slice(0, actualTestCount);

            console.log(`üéØ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ü–û–ö–ê–ó–ê–ù–ù–´–• –ö–û–ú–ë–ò–ù–ê–¶–ò–ô:`);
            console.log(`   –ö–æ–º–±–∏–Ω–∞—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: ${generatedCombinations.length} —à—Ç.`);
            console.log(`   –¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞: ${testDraws.length} –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Ç–∏—Ä–∞–∂–µ–π`);
            console.log(`   –ö–æ–º–±–∏–Ω–∞—Ü–∏–∏:`, generatedCombinations);

            let totalSuccessfulGames = 0;

            // –¢–µ—Å—Ç–∏—Ä—É–µ–º –∫–∞–∂–¥—É—é –∫–æ–º–±–∏–Ω–∞—Ü–∏—é –æ—Ç–¥–µ–ª—å–Ω–æ –∏ —Å—É–º–º–∏—Ä—É–µ–º —É—Å–ø–µ—Ö–∏
            generatedCombinations.forEach((combo, comboIndex) => {
                let comboWins = 0;

                for (let i = 0; i < testDraws.length; i++) {
                    const actualNumbers = new Set(testDraws[i].numbers);
                    const matches = combo.filter(num => actualNumbers.has(num)).length;

                    if (matches >= 3) { // –ú–∏–Ω–∏–º—É–º 3 —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è = –≤—ã–∏–≥—Ä—ã—à
                        comboWins++;
                        console.log(`‚úÖ –ò–≥—Ä–∞ ${comboIndex + 1}, –¢–∏—Ä–∞–∂ ${testDraws[i].draw_number}: ${matches} —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π!`);
                    }
                }

                console.log(`   –ò–≥—Ä–∞ ${comboIndex + 1}: ${comboWins}/${testDraws.length} —É—Å–ø–µ—Ö–æ–≤`);
                totalSuccessfulGames += comboWins;
            });

            // –≠–§–§–ï–ö–¢–ò–í–ù–û–°–¢–¨ = –û–ë–©–ï–ï –ö–û–õ–ò–ß–ï–°–¢–í–û –í–´–ò–ì–†–´–®–ù–´–• –ò–ì–† / –û–ë–©–ï–ï –ö–û–õ–ò–ß–ï–°–¢–í–û –ò–ì–†
            const totalGames = generatedCombinations.length * actualTestCount;
            const efficiency = totalGames > 0 ? Math.round((totalSuccessfulGames / totalGames) * 100) : 0;

            console.log(`üéØ –û–ë–©–ê–Ø –≠–§–§–ï–ö–¢–ò–í–ù–û–°–¢–¨: ${totalSuccessfulGames}/${totalGames} = ${efficiency}%`);
            console.log(`   - ${totalSuccessfulGames} —É—Å–ø–µ—à–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –∏–∑ ${totalGames} (8 –∫–æ–º–±–∏–Ω–∞—Ü–∏–π √ó ${actualTestCount} —Ç–∏—Ä–∞–∂–µ–π)`);

            return efficiency;
        }

        // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö (–¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫)
        function testStrategyEfficiency(strategyType, numTests = 30) {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ –∂–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∏—Ä–∞–∂–µ–π, —á—Ç–æ –∏ –≤ –¥—Ä—É–≥–∏—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö
            const userTestCount = parseInt(document.getElementById('testTirageCount').value, 10) || 20;
            const actualTestCount = Math.min(userTestCount, lottoData.draws.length);

            // –£–±–∏—Ä–∞–µ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ +10 —Ç–∏—Ä–∞–∂–µ–π, –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—É—é –ø—Ä–æ–≤–µ—Ä–∫—É
            if (lottoData.draws.length < actualTestCount) {
                console.log(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ ${actualTestCount} —Ç–∏—Ä–∞–∂–∞—Ö`);
                return 0;
            }

            let successfulPredictions = 0;
            const totalTests = actualTestCount;

            // –ë–µ—Ä–µ–º —Å–∞–º—ã–µ —Å–≤–µ–∂–∏–µ —Ç–∏—Ä–∞–∂—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            const testDraws = lottoData.draws.slice(0, totalTests);

            for (let i = 0; i < totalTests; i++) {
                // –î–ª—è —Ç–µ—Å—Ç–∞ i –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–æ i-–≥–æ —Ç–∏—Ä–∞–∂–∞
                const historicalDraws = lottoData.draws.slice(i + 1, lottoData.draws.length);

                // –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –∫–æ–ø–∏—é –¥–∞–Ω–Ω—ã—Ö —Ç–æ–ª—å–∫–æ –¥–æ —Ç–µ–∫—É—â–µ–≥–æ —Ç–∏—Ä–∞–∂–∞
                const tempLottoData = {
                    draws: historicalDraws,
                    number_data: createNumberDataFromDraws(historicalDraws)
                };

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                const originalLottoData = lottoData;
                lottoData = tempLottoData;

                try {
                    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–µ–π
                    let testCombinations = [];
                    switch (strategyType) {
                        case 'conservative':
                            testCombinations = generateConservativeStrategy(8);
                            break;
                        case 'balanced':
                            testCombinations = generateBalancedStrategy(8);
                            break;
                        case 'aggressive':
                            testCombinations = generateAggressiveStrategy(8);
                            break;
                    }

                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–æ–≤–ø–∞–ª–∞ –ª–∏ —Ö–æ—Ç—å –æ–¥–Ω–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
                    // –°—á–∏—Ç–∞–µ–º —É—Å–ø–µ—à–Ω—ã–º, –µ—Å–ª–∏ —Å–æ–≤–ø–∞–ª–æ –º–∏–Ω–∏–º—É–º 3 –Ω–æ–º–µ—Ä–∞ (—É–∂–µ –≤—ã–∏–≥—Ä—ã—à!)
                    const actualNumbers = new Set(testDraws[i].numbers);
                    const hasMatch = testCombinations.some(combo => {
                        const matches = combo.filter(num => actualNumbers.has(num)).length;
                        return matches >= 3; // –ú–∏–Ω–∏–º—É–º 3 —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è = –≤—ã–∏–≥—Ä—ã—à
                    });

                    if (hasMatch) {
                        successfulPredictions++;
                    }

                } catch (error) {
                    console.log(`–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ç–∏—Ä–∞–∂–∞ ${i}:`, error.message);
                }

                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                lottoData = originalLottoData;
            }

            const efficiency = totalTests > 0 ? Math.round((successfulPredictions / totalTests) * 100) : 0;
            console.log(`–°—Ç—Ä–∞—Ç–µ–≥–∏—è ${strategyType}: ${successfulPredictions}/${totalTests} —É—Å–ø–µ—à–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π = ${efficiency}%`);

            return efficiency;
        }

        // –ö—ç—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        let strategyEfficiencyCache = {};

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
        function updateStrategyDashboard() {
            const titleElement = document.getElementById('selected-strategy-title');
            const efficiencyBar = document.getElementById('efficiency-bar');
            const efficiencyLabel = document.getElementById('efficiency-label');

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ª–∏ —ç–ª–µ–º–µ–Ω—Ç—ã (–±–ª–æ–∫ strategy-dashboard –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–∫—Ä—ã—Ç)
            if (!titleElement || !efficiencyBar || !efficiencyLabel) {
                console.log('–≠–ª–µ–º–µ–Ω—Ç—ã strategy-dashboard –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –∏–ª–∏ —Å–∫—Ä—ã—Ç—ã, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ');
                return;
            }

            const strategyNames = {
                conservative: 'üõ°Ô∏è –ö–û–ù–°–ï–†–í–ê–¢–ò–í–ù–ê–Ø –°–¢–†–ê–¢–ï–ì–ò–Ø',
                balanced: '‚öñÔ∏è –°–ë–ê–õ–ê–ù–°–ò–†–û–í–ê–ù–ù–ê–Ø –°–¢–†–ê–¢–ï–ì–ò–Ø',
                aggressive: 'üéØ –ê–ì–†–ï–°–°–ò–í–ù–ê–Ø –°–¢–†–ê–¢–ï–ì–ò–Ø'
            };

            const strategyDescriptions = {
                conservative: '–°—Ç–∞–±–∏–ª—å–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ —Å –Ω–∏–∑–∫–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å—é. –†–µ–∂–µ –¥–∞—é—Ç –¥–∂–µ–∫–ø–æ—Ç, –Ω–æ —á–∞—â–µ —É–≥–∞–¥—ã–≤–∞—é—Ç –Ω–æ–º–µ—Ä–∞',
                balanced: '–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å —Ä–∏—Å–∫–∞ –∏ —à–∞–Ω—Å–∞. –õ—É—á—à–∏–π –≤—ã–±–æ—Ä –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ–π –∏–≥—Ä—ã',
                aggressive: '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –≤—ã–∏–≥—Ä—ã—à–∞. –†–µ–¥–∫–æ, –Ω–æ —Ç–æ—á–Ω–æ!'
            };

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            const resultsContainer = document.getElementById('generator-results-container');
            const hasGeneratedCombination = resultsContainer && resultsContainer.innerHTML.trim() !== '';

            let efficiency = 0;
            let testCount = parseInt(document.getElementById('testTirageCount').value, 10) || 20;
            let efficiencyType = '—Å—Ç—Ä–∞—Ç–µ–≥–∏–∏';

            if (hasGeneratedCombination && window.currentCombinationEfficiency) {
                // –ï—Å–ª–∏ –µ—Å—Ç—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ—ë —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
                efficiency = window.currentCombinationEfficiency.efficiency;
                    efficiencyType = '–≤–∞—à–µ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏';
            } else {
                // –ï—Å–ª–∏ –Ω–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–±—â—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
                if (!strategyEfficiencyCache[selectedStrategy] || strategyEfficiencyCache[selectedStrategy + '_count'] !== testCount) {
                    console.log(`–¢–µ—Å—Ç–∏—Ä—É–µ–º –æ–±—â—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ ${selectedStrategy} –Ω–∞ ${testCount} —Ç–∏—Ä–∞–∂–∞—Ö...`);
                    strategyEfficiencyCache[selectedStrategy] = testStrategyEfficiency(selectedStrategy, testCount);
                    strategyEfficiencyCache[selectedStrategy + '_count'] = testCount;
                }
                efficiency = strategyEfficiencyCache[selectedStrategy] || 0;
            }

            // –ï—Å–ª–∏ –µ—Å—Ç—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –∏–º–µ–Ω–Ω–æ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏, –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –∏—Ö —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
            if (hasGeneratedCombination &&
                window.lastGeneratedCombinations &&
                window.lastGeneratedStrategy !== null &&
                window.lastGeneratedStrategy !== undefined &&
                window.lastGeneratedStrategy === selectedStrategy) {
                console.log(`–ü–µ—Ä–µ—Å—á–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ ${selectedStrategy} –Ω–∞ ${testCount} —Ç–∏—Ä–∞–∂–∞—Ö...`);
                const combinations = window.lastGeneratedCombinations;
                const realEfficiency = testGeneratedCombinationEfficiency(combinations, testCount);
                efficiency = realEfficiency;
                efficiencyType = '–≤–∞—à–µ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏';
                console.log(`–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–æ–º–±–∏–Ω–∞—Ü–∏–π: ${efficiency}%`);

                // –û–±–Ω–æ–≤–ª—è–µ–º currentCombinationEfficiency –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
                window.currentCombinationEfficiency = {
                    strategy: selectedStrategy,
                    efficiency: realEfficiency,
                    testCount: testCount
                };
            }

            const efficiencyColor = efficiency > 15 ? '#4caf50' : efficiency > 8 ? '#ff9800' : '#f44336';
            const efficiencyStatus = efficiency > 15 ? '–û—Ç–ª–∏—á–Ω–∞—è' : efficiency > 8 ? '–•–æ—Ä–æ—à–∞—è' : '–ù–∏–∑–∫–∞—è';

            titleElement.innerHTML = `
                ${strategyNames[selectedStrategy] || '–°—Ç—Ä–∞—Ç–µ–≥–∏—è –Ω–µ –≤—ã–±—Ä–∞–Ω–∞'}
                <div style="font-size: 0.8em; color: #666; margin-top: 5px; font-weight: normal;">
                    ${strategyDescriptions[selectedStrategy] || ''}
                </div>
                ${hasGeneratedCombination ? `
                <div style="margin-top: 10px; padding: 8px; background: rgba(255,255,255,0.1); border-radius: 6px; border-left: 3px solid ${efficiencyColor};">
                    <div style="font-size: 0.9em; color: ${efficiencyColor}; font-weight: bold;">
                        üéØ –í–∞—à–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è: ${efficiencyStatus} (${efficiency}%)
                    </div>
                    <div style="font-size: 0.7em; color: #ccc; margin-top: 2px;">
                        –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ ${testCount} –ø—Ä–æ—à–ª—ã—Ö —Ç–∏—Ä–∞–∂–∞—Ö
                    </div>
                </div>
                ` : ''}
            `;

            efficiencyBar.style.width = `${efficiency}%`;

            efficiencyLabel.textContent = `–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ${efficiencyType}: ${efficiency}% (–Ω–∞ –æ—Å–Ω–æ–≤–µ ${testCount} —Ç–∏—Ä–∞–∂–µ–π)`;
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
        function generateSelectedStrategy() {
            if (!selectedStrategy) {
                showError('–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é');
                    return;
                }

            if (!lottoData) {
                showError('–î–∞–Ω–Ω—ã–µ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
                return;
            }

            const numCombinations = parseInt(document.getElementById('numCombinations').value, 10);
            if (isNaN(numCombinations) || numCombinations < 1) {
                showError('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π');
                    return;
                }

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
                    let combinations = [];
                    let title = '';

            try {
                switch (selectedStrategy) {
                    case 'conservative':
                        title = 'üõ°Ô∏è –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–∞—è –°—Ç—Ä–∞—Ç–µ–≥–∏—è';
                        combinations = generateConservativeStrategy(numCombinations);
                        break;
                    case 'balanced':
                        title = '‚öñÔ∏è –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –°—Ç—Ä–∞—Ç–µ–≥–∏—è';
                        combinations = generateBalancedStrategy(numCombinations);
                        break;

                    case 'ai':
                        title = 'ü§ñ –ò–ò-–ü–†–ï–î–°–ö–ê–ó–ê–ù–ò–ï';
                        combinations = generateAIStrategy(numCombinations);
                        break;
                }

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∫–æ–º–±–∏–Ω–∞—Ü–∏—é –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                window.lastGeneratedCombinations = combinations;
                window.lastGeneratedStrategy = selectedStrategy;
                console.log(`–°–æ—Ö—Ä–∞–Ω–µ–Ω—ã –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏: ${selectedStrategy}, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${combinations.length}`);

                // –¢–µ—Å—Ç–∏—Ä—É–µ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏–º–µ–Ω–Ω–æ –≠–¢–û–ô —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
                const testCount = parseInt(document.getElementById('testTirageCount').value, 10) || 20;
                const realEfficiency = testGeneratedCombinationEfficiency(combinations, testCount);

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —ç—Ç–æ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
                window.currentCombinationEfficiency = {
                    strategy: selectedStrategy,
                    efficiency: realEfficiency,
                    testCount: testCount
                };

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
                window.lastGeneratedCombinations = combinations;

                displayStrategyResults(combinations, title, realEfficiency, testCount);

                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
                updateStrategyCardsEfficiency();

                // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞—à–±–æ—Ä–¥ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Å –Ω–æ–≤–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
                updateStrategyDashboard();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:', error);
                showError('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π');
            }
        }


        /**
         * –ê–Ω–∞–ª–∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –Ω–æ–º–µ—Ä–æ–≤ - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–æ–º–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –≤—ã–ø–∞–¥–∞–ª–∏ –≤–º–µ—Å—Ç–µ.
         */
        function analyzeClusterBehavior(dataToUse) {
            const clusterBonuses = {};
            const recentDraws = dataToUse.draws.slice(0, 50); // –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Ç–∏—Ä–∞–∂–µ–π
            const numberCooccurrence = {};

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–∞—Ç—Ä–∏—Ü—É —Å–æ-–≤—Å—Ç—Ä–µ—á–∞–µ–º–æ—Å—Ç–∏
            for (let i = 1; i <= 49; i++) {
                numberCooccurrence[i] = {};
                for (let j = 1; j <= 49; j++) {
                    numberCooccurrence[i][j] = 0;
                }
            }

            // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–æ-–≤—Å—Ç—Ä–µ—á–∞–µ–º–æ—Å—Ç—å
            recentDraws.forEach(draw => {
                const numbers = draw.numbers;
                for (let i = 0; i < numbers.length; i++) {
                    for (let j = i + 1; j < numbers.length; j++) {
                        numberCooccurrence[numbers[i]][numbers[j]]++;
                        numberCooccurrence[numbers[j]][numbers[i]]++;
                    }
                }
            });

            // –ù–∞—Ö–æ–¥–∏–º –Ω–æ–º–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤–º–µ—Å—Ç–µ
            for (let i = 1; i <= 49; i++) {
                let totalCooccurrence = 0;
                let cooccurrenceCount = 0;

                for (let j = 1; j <= 49; j++) {
                    if (i !== j && numberCooccurrence[i][j] > 0) {
                        totalCooccurrence += numberCooccurrence[i][j];
                        cooccurrenceCount++;
                    }
                }

                if (cooccurrenceCount > 0) {
                    const avgCooccurrence = totalCooccurrence / cooccurrenceCount;
                    // –î–∞–µ–º –±–æ–Ω—É—Å –Ω–æ–º–µ—Ä–∞–º, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è —Å –¥—Ä—É–≥–∏–º–∏
                    if (avgCooccurrence > 2) { // –í—Å—Ç—Ä–µ—á–∞–ª–∏—Å—å –≤–º–µ—Å—Ç–µ –±–æ–ª–µ–µ 2 —Ä–∞–∑
                        clusterBonuses[i] = Math.min(2.0, avgCooccurrence * 0.3);
                    }
                }
            }

            return clusterBonuses;
        }

        /**
         * –ê–Ω–∞–ª–∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –Ω–æ–º–µ—Ä–æ–≤ - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–æ–º–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –≤—ã–ø–∞–¥–∞–ª–∏ –≤–º–µ—Å—Ç–µ.
         */
        function analyzeClusterBehavior(dataToUse) {
            const clusterBonuses = {};
            const recentDraws = dataToUse.draws.slice(0, 50); // –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Ç–∏—Ä–∞–∂–µ–π
            const numberCooccurrence = {};

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–∞—Ç—Ä–∏—Ü—É —Å–æ-–≤—Å—Ç—Ä–µ—á–∞–µ–º–æ—Å—Ç–∏
            for (let i = 1; i <= 49; i++) {
                numberCooccurrence[i] = {};
                for (let j = 1; j <= 49; j++) {
                    numberCooccurrence[i][j] = 0;
                }
            }

            // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–æ-–≤—Å—Ç—Ä–µ—á–∞–µ–º–æ—Å—Ç—å
            recentDraws.forEach(draw => {
                const numbers = draw.numbers;
                for (let i = 0; i < numbers.length; i++) {
                    for (let j = i + 1; j < numbers.length; j++) {
                        numberCooccurrence[numbers[i]][numbers[j]]++;
                        numberCooccurrence[numbers[j]][numbers[i]]++;
                    }
                }
            });

            // –ù–∞—Ö–æ–¥–∏–º –Ω–æ–º–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤–º–µ—Å—Ç–µ
            for (let i = 1; i <= 49; i++) {
                let totalCooccurrence = 0;
                let cooccurrenceCount = 0;

                for (let j = 1; j <= 49; j++) {
                    if (i !== j && numberCooccurrence[i][j] > 0) {
                        totalCooccurrence += numberCooccurrence[i][j];
                        cooccurrenceCount++;
                    }
                }

                if (cooccurrenceCount > 0) {
                    const avgCooccurrence = totalCooccurrence / cooccurrenceCount;
                    // –î–∞–µ–º –±–æ–Ω—É—Å –Ω–æ–º–µ—Ä–∞–º, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è —Å –¥—Ä—É–≥–∏–º–∏
                    if (avgCooccurrence > 2) { // –í—Å—Ç—Ä–µ—á–∞–ª–∏—Å—å –≤–º–µ—Å—Ç–µ –±–æ–ª–µ–µ 2 —Ä–∞–∑
                        clusterBonuses[i] = Math.min(2.0, avgCooccurrence * 0.3);
                    }
                }
            }

            return clusterBonuses;
        }

        // ===============================================================================================
        // –¢–ï–°–¢–û–í–´–ï –§–£–ù–ö–¶–ò–ò
        // ===============================================================================================

        // –¢–µ—Å—Ç–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ analyzeClusterBehavior
        window.testClusterBehavior = function() {
            console.log('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ analyzeClusterBehavior...');
            const clusterBonuses = analyzeClusterBehavior(lottoData);
            console.log('–†–µ–∑—É–ª—å—Ç–∞—Ç:', Object.keys(clusterBonuses).length, '–Ω–æ–º–µ—Ä–æ–≤ —Å –±–æ–Ω—É—Å–∞–º–∏');
            return clusterBonuses;
        };

        // –¢–µ—Å—Ç–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ getSmartTargetNumbers
        window.testSmartTargets = function() {
            console.log('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ getSmartTargetNumbers...');
            const targets = getSmartTargetNumbers(15, lottoData);
            console.log('–¢–æ–ø-10 —Ü–µ–ª–µ–π:', targets.slice(0, 10));
            return targets;
        };

        // ===============================================================================================
        // –§–ò–ù–ê–õ–¨–ù–ê–Ø –ì–ò–ë–†–ò–î–ù–ê–Ø –°–¢–†–ê–¢–ï–ì–ò–Ø (v2.2 - Smart Target AI)
        // ===============================================================================================

        /**
         * "–ü—Å–µ–≤–¥–æ-–Ω–µ–π—Ä–æ–Ω–Ω—ã–π" –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è 6 —Å–∞–º—ã—Ö "–≤–ª–∏—è—Ç–µ–ª—å–Ω—ã—Ö" –Ω–æ–º–µ—Ä–æ–≤.
         * @param {number} historySize - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Ç–∏—Ä–∞–∂–µ–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.
         * @param {object} dataToUse - –î–∞–Ω–Ω—ã–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.
         * @returns {Array<number>} - –ú–∞—Å—Å–∏–≤ –∏–∑ 6 —Ü–µ–ª–µ–≤—ã—Ö –Ω–æ–º–µ—Ä–æ–≤.
         */
        function getSmartTargetNumbers(historySize, dataToUse) {
            if (!dataToUse.draws || dataToUse.draws.length < historySize) {
                // –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –º–∞–ª–æ, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –Ω–æ–º–µ—Ä–∞ –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ç–∏—Ä–∞–∂–∞ –∏–ª–∏ –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
                console.log(`‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–º–∞—Ä—Ç-–∞–Ω–∞–ª–∏–∑–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ç–∏—Ä–∞–∂.`);
                return (dataToUse.draws && dataToUse.draws.length > 0) ? [...dataToUse.draws[0].numbers] : [];
            }

            const recentDraws = dataToUse.draws.slice(0, historySize);
            const numberScores = {};

            for (let i = 1; i <= 49; i++) {
                numberScores[i] = { score: 0, number: i };
            }

            // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ç–∏—Ä–∞–∂–∏
            recentDraws.forEach((draw, index) => {
                // –í–µ—Å –æ—Ç 1.0 (—Å–∞–º—ã–π –Ω–æ–≤—ã–π) –¥–æ ~0.0 (—Å–∞–º—ã–π —Å—Ç–∞—Ä—ã–π –≤ –≤—ã–±–æ—Ä–∫–µ)
                const recencyWeight = (historySize - index) / historySize;

                draw.numbers.forEach(num => {
                    // 1. –ë–æ–Ω—É—Å –∑–∞ —á–∞—Å—Ç–æ—Ç—É –∏ —Å–≤–µ–∂–µ—Å—Ç—å
                    numberScores[num].score += 1 * recencyWeight;
                });
            });

            // 2. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –±–æ–Ω—É—Å –∑–∞ "–≥–æ—Ä—è—á–µ—Å—Ç—å" –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–±—â–µ–≥–æ —Ç—Ä–µ–Ω–¥–∞
            for (let i = 1; i <= 49; i++) {
                const trend = calculateNumberTrend(i); // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é
                const numberData = dataToUse.number_data[i] || [];
                const { debt } = calculateDebtIndicator(i);
                const { avgGap, cv } = calculateGapStats(numberData);

                if (trend.status === 'very-hot') {
                    numberScores[i].score += 2.0; // –£–≤–µ–ª–∏—á–µ–Ω –±–æ–Ω—É—Å –∑–∞ –æ—á–µ–Ω—å –≥–æ—Ä—è—á—É—é —Ñ–∞–∑—É
                } else if (trend.status === 'hot') {
                    numberScores[i].score += 1.0; // –£–≤–µ–ª–∏—á–µ–Ω –±–æ–Ω—É—Å –∑–∞ –≥–æ—Ä—è—á—É—é —Ñ–∞–∑—É
                }

                // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —É—Å–∏–ª–µ–Ω–Ω—ã–µ –±–æ–Ω—É—Å—ã –∑–∞ –∫–æ—Ä–æ—Ç–∫–∏–µ –ø–∞—É–∑—ã –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
                if (avgGap > 0) {
                    const debtRatio = debt / avgGap;
                    if (debtRatio < 0.6 && cv < 0.9) { // –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏
                        numberScores[i].score += 3.0; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –±–æ–Ω—É—Å
                    } else if (debtRatio < 0.8 && cv < 1.1) { // –ï—â–µ –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏
                        numberScores[i].score += 2.5; // –ë–æ–ª—å—à–æ–π –±–æ–Ω—É—Å
                    } else if (debtRatio < 1.0 && cv < 1.0) { // –®–∏—Ä–æ–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏
                        numberScores[i].score += 1.8; // –•–æ—Ä–æ—à–∏–π –±–æ–Ω—É—Å
                    } else if (debtRatio < 1.2) { // –ü—Ä–æ—Å—Ç–æ –∫–æ—Ä–æ—Ç–∫–∞—è –ø–∞—É–∑–∞
                        numberScores[i].score += 1.2; // –ë–æ–Ω—É—Å –∑–∞ —Å–≤–µ–∂–µ—Å—Ç—å
                    } else if (cv < 0.8) { // –ü—Ä–æ—Å—Ç–æ —Ö–æ—Ä–æ—à–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
                        numberScores[i].score += 1.5; // –ë–æ–Ω—É—Å –∑–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
                    }
                }
            }

            // 3. –°–ü–ï–¶–ò–ê–õ–¨–ù–´–ô –ë–û–ù–£–° –ó–ê –ö–õ–ê–°–¢–ï–†–ù–û–ï –ü–û–í–ï–î–ï–ù–ò–ï (–±–µ–∑ –ø—Ä—è–º—ã—Ö —Å—Å—ã–ª–æ–∫ –Ω–∞ –Ω–æ–º–µ—Ä–∞)
            // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º, –∫–∞–∫–∏–µ –Ω–æ–º–µ—Ä–∞ —á–∞—Å—Ç–æ –≤—ã–ø–∞–¥–∞–ª–∏ –≤–º–µ—Å—Ç–µ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Ç–∏—Ä–∞–∂–µ–π
            console.log('üîç –ê–ù–ê–õ–ò–ó –ö–õ–ê–°–¢–ï–†–ù–û–ì–û –ü–û–í–ï–î–ï–ù–ò–Ø...');
            const clusterBehaviorBonus = analyzeClusterBehavior(dataToUse);
            for (let i = 1; i <= 49; i++) {
                if (clusterBehaviorBonus[i]) {
                    numberScores[i].score += clusterBehaviorBonus[i];
                    console.log(`   ‚Ä¢ –ù–æ–º–µ—Ä ${i}: +${clusterBehaviorBonus[i].toFixed(1)} –∑–∞ –∫–ª–∞—Å—Ç–µ—Ä–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ`);
                }
            }

            // –ü—Ä–µ–≤—Ä–∞—â–∞–µ–º –æ–±—ä–µ–∫—Ç –≤ –º–∞—Å—Å–∏–≤ –∏ —Å–æ—Ä—Ç–∏—Ä—É–µ–º
            const sortedCandidates = Object.values(numberScores).sort((a, b) => b.score - a.score);

            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–ø-10 –Ω–æ–º–µ—Ä–æ–≤
            const top10 = sortedCandidates.slice(0, 10).map(c => c.number);
            
            console.log(`üß† –°–º–∞—Ä—Ç-—Ü–µ–ª–∏ (—Ç–æ–ø-10 –ø–æ –≤–ª–∏—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏): ${top10.join(', ')}`);
            return top10;
        }

        /**
         * –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç "–∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª" –Ω–æ–º–µ—Ä–∞, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –µ–≥–æ —Ç–µ–∫—É—â—É—é —Ñ–∞–∑—É.
         */
        function analyzeNumberLifecycle(num, dataToUse) {
            const numberData = dataToUse.number_data[num] || [];
            if (numberData.length < 5) return { phase: 'unknown', score: 0, debtRatio: 0, cv: 99 };

                    const { avgGap, cv } = calculateGapStats(numberData);
                const { debt } = calculateDebtIndicator(num);
            const { rsi } = calculateRSI(num);
            
            const debtRatio = avgGap > 0 ? debt / avgGap : 0;

            let phase = 'unknown';
            let score = 0;

            if (debtRatio > 2.0 && rsi < 35) {
                phase = '–°–ø—è—â–∏–π';
                score = 25; // –°–Ω–∏–∂–µ–Ω –±–∞–∑–æ–≤—ã–π –±–∞–ª–ª
            } else if (debtRatio > 1.2 && rsi < 50) {
                phase = '–ü—Ä–æ–±—É–∂–¥–∞–µ—Ç—Å—è';
                score = 45; // –°–Ω–∏–∂–µ–Ω –±–∞–ª–ª
            } else if (debtRatio < 1.0 && rsi > 50 && rsi < 70) {
                phase = '–ì–æ—Ä—è—á–∏–π';
                score = 35; // –£–≤–µ–ª–∏—á–µ–Ω –±–∞–ª–ª –∑–∞ –≥–æ—Ä—è—á—É—é —Ñ–∞–∑—É
            } else if (debtRatio < 0.5 && rsi > 70) {
                phase = '–û—Å—Ç—ã–≤–∞–µ—Ç';
                score = 30; // –°–Ω–∏–∂–µ–Ω –±–∞–ª–ª
            } else {
                phase = '–°—Ç–∞–±–∏–ª—å–Ω—ã–π';
                score = 40; // –£–≤–µ–ª–∏—á–µ–Ω –±–∞–ª–ª –∑–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
            }

            // –£—Å–∏–ª–µ–Ω–Ω—ã–µ –±–æ–Ω—É—Å—ã –∑–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –∫–æ—Ä–æ—Ç–∫–∏–µ –ø–∞—É–∑—ã
            if (cv < 0.6) {
                score += 45; // –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–≤–µ–ª–∏—á–µ–Ω –±–æ–Ω—É—Å –∑–∞ –≤—ã—Å–æ–∫—É—é —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
            } else if (cv < 0.8) {
                score += 35; // –£–≤–µ–ª–∏—á–µ–Ω –±–æ–Ω—É—Å –∑–∞ —Ö–æ—Ä–æ—à—É—é —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
            } else if (cv < 1.0) {
                score += 25; // –£–≤–µ–ª–∏—á–µ–Ω –±–æ–Ω—É—Å –∑–∞ —É–º–µ—Ä–µ–Ω–Ω—É—é —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
            } else if (cv > 1.5) {
                score -= 25; // –£–≤–µ–ª–∏—á–µ–Ω —à—Ç—Ä–∞—Ñ –∑–∞ —Ö–∞–æ—Å
            } else if (cv > 1.2) {
                score -= 15; // –î–æ–±–∞–≤–ª–µ–Ω —à—Ç—Ä–∞—Ñ –∑–∞ –≤—ã—Å–æ–∫—É—é –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
            }

            // –£—Å–∏–ª–µ–Ω–Ω—ã–µ –±–æ–Ω—É—Å—ã –∑–∞ –∫–æ—Ä–æ—Ç–∫–∏–µ –ø–∞—É–∑—ã (–∫–ª–∞—Å—Ç–µ—Ä–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ –∏–º–µ—é—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ)
            if (debtRatio < 0.5) {
                score += 25; // –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –±–æ–Ω—É—Å –∑–∞ –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏–µ –ø–∞—É–∑—ã
            } else if (debtRatio < 0.8) {
                score += 20; // –ë–æ–ª—å—à–æ–π –±–æ–Ω—É—Å –∑–∞ –∫–æ—Ä–æ—Ç–∫–∏–µ –ø–∞—É–∑—ã
            } else if (debtRatio < 1.0) {
                score += 10; // –ë–æ–Ω—É—Å –∑–∞ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –ø–∞—É–∑—ã
            }

            return { phase, score, debtRatio, cv };
        }

        /**
         * –ù–∞—Ö–æ–¥–∏—Ç –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏–π —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –≤ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö N —Ç–∏—Ä–∞–∂–∞—Ö ("—ç–ø–æ—Ö–µ").
         */
        // –ê–î–ê–ü–¢–ò–í–ù–´–ô –ê–ù–ê–õ–ò–ó –ü–û–°–õ–ï–î–ù–ò–• 2-3 –¢–ò–†–ê–ñ–ï–ô
        function analyzeRecentPattern(analysisSize, dataToUse) {
            if (!dataToUse.draws || dataToUse.draws.length < analysisSize) {
                return { low: 2, mid: 2, high: 2, efficiency: 0, trend: 'unknown' };
            }

            const recentDraws = dataToUse.draws.slice(0, analysisSize);
            const RANGES = { low: { min: 1, max: 16 }, mid: { min: 17, max: 33 }, high: { min: 34, max: 49 } };

            let totalLow = 0, totalMid = 0, totalHigh = 0;
            let winningPatterns = 0;

            recentDraws.forEach(draw => {
                let low = 0, mid = 0, high = 0;
                draw.numbers.forEach(num => {
                    if (num >= RANGES.low.min && num <= RANGES.low.max) low++;
                    else if (num >= RANGES.mid.min && num <= RANGES.mid.max) mid++;
                    else high++;
                });
                totalLow += low;
                totalMid += mid;
                totalHigh += high;

                // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º "–≤—ã–∏–≥—Ä—ã—à–Ω—ã–µ" –ø–∞—Ç—Ç–µ—Ä–Ω—ã (—Å –º–∏–Ω–∏–º—É–º 3 —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è–º–∏ –≤ 6 —á–∏—Å–ª–∞—Ö)
                if (low >= 2 || mid >= 2 || high >= 1) {
                    winningPatterns++;
                }
            });

            const efficiency = (winningPatterns / analysisSize) * 100;

            return {
                low: Math.round(totalLow / analysisSize),
                mid: Math.round(totalMid / analysisSize),
                high: Math.round(totalHigh / analysisSize),
                efficiency: efficiency,
                trend: efficiency > 70 ? 'very-good' : efficiency > 50 ? 'good' : efficiency > 30 ? 'moderate' : 'poor'
            };
        }

        // –ì–ò–ë–ö–ò–ï –î–ò–ê–ü–ê–ó–û–ù–´ –° –£–ß–ï–¢–û–ú –ê–î–ê–ü–¢–ò–í–ù–û–ì–û –ê–ù–ê–õ–ò–ó–ê
        function getAdaptiveRanges(adaptivePattern, dataToUse) {
            const BASE_RANGES = {
                low: { min: 1, max: 16 },
                mid: { min: 17, max: 33 },
                high: { min: 34, max: 49 }
            };

            // –ï—Å–ª–∏ —Å—Ä–µ–¥–Ω–∏–µ —á–∏—Å–ª–∞ –¥–æ–º–∏–Ω–∏—Ä—É—é—Ç –≤ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Ç–∏—Ä–∞–∂–∞—Ö, —Ä–∞—Å—à–∏—Ä—è–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω —Å—Ä–µ–¥–Ω–∏—Ö
            if (adaptivePattern.mid >= 3) {
                return {
                    low: { min: 1, max: 15 },  // –£–º–µ–Ω—å—à–∞–µ–º –Ω–∏–∑–∫–∏–µ
                    mid: { min: 16, max: 35 }, // –†–∞—Å—à–∏—Ä—è–µ–º —Å—Ä–µ–¥–Ω–∏–µ
                    high: { min: 36, max: 49 } // –ù–∞—á–∏–Ω–∞–µ–º –≤—ã—Å–æ–∫–∏–µ –ø–æ–∑–∂–µ
                };
            }

            // –ï—Å–ª–∏ –Ω–∏–∑–∫–∏–µ —á–∏—Å–ª–∞ –¥–æ–º–∏–Ω–∏—Ä—É—é—Ç, —É—Å–∏–ª–∏–≤–∞–µ–º –∏—Ö
            else if (adaptivePattern.low >= 3) {
                return {
                    low: { min: 1, max: 18 },  // –†–∞—Å—à–∏—Ä—è–µ–º –Ω–∏–∑–∫–∏–µ
                    mid: { min: 19, max: 32 }, // –£–º–µ–Ω—å—à–∞–µ–º —Å—Ä–µ–¥–Ω–∏–µ
                    high: { min: 33, max: 49 }
                };
            }

            // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã –¥–ª—è —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
            return BASE_RANGES;
        }

        // –û–†–ò–ì–ò–ù–ê–õ–¨–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –î–õ–Ø –î–û–õ–ì–û–°–†–û–ß–ù–û–ì–û –ê–ù–ê–õ–ò–ó–ê
        function findDominantPattern(epochSize, dataToUse) {
            const RANGES = {
                low: { min: 1, max: 16 },
                mid: { min: 17, max: 33 },
                high: { min: 34, max: 49 }
            };
            const recentDraws = dataToUse.draws.slice(0, epochSize);
            const patternCounts = {};

            recentDraws.forEach(draw => {
                let low = 0, mid = 0, high = 0;
                draw.numbers.forEach(num => {
                    if (num >= RANGES.low.min && num <= RANGES.low.max) low++;
                    else if (num >= RANGES.mid.min && num <= RANGES.mid.max) mid++;
                    else high++;
                });
                const patternKey = `L${low}M${mid}H${high}`;
                patternCounts[patternKey] = (patternCounts[patternKey] || 0) + 1;
            });

            if (Object.keys(patternCounts).length === 0) {
                return { low: 2, mid: 2, high: 2 };
            }

            const dominantPatternKey = Object.keys(patternCounts).reduce((a, b) => patternCounts[a] > patternCounts[b] ? a : b);

            const match = dominantPatternKey.match(/L(\d+)M(\d+)H(\d+)/);
            return {
                low: parseInt(match[1], 10),
                mid: parseInt(match[2], 10),
                high: parseInt(match[3], 10)
            };
        }

        /**
         * –ê–Ω–∞–ª–∏–∑ –≤–æ–ª–Ω–æ–≤—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –≠–ª–ª–∏–æ—Ç—Ç–∞ –∏–∑ v1.
         */
        function analyzeElliotWaves(number, data) {
            const numberData = data.number_data[number] || [];
            if (numberData.length < 15) return 0;

            const recentDrawNumbers = numberData.map(d => parseInt(d.draw_number)).slice(0, 15);
            let waveScore = 0;

            for (let i = 4; i < recentDrawNumbers.length; i++) {
                const window = recentDrawNumbers.slice(i - 4, i + 1);
                const trend = window[0] > window[4] ? -1 : 1;
                const hasCorrections = window.some((val, idx) => {
                    if (idx === 0 || idx === 4) return false;
                    return (trend > 0 && val < window[idx - 1]) || (trend < 0 && val > window[idx - 1]);
                });

                if (hasCorrections) waveScore += 1;
            }

            return Math.min(waveScore, 5);
        }


        /**
         * –§–∏–Ω–∞–ª—å–Ω–∞—è "–ì–∏–±—Ä–∏–¥–Ω–∞—è –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–∞—è –°—Ç—Ä–∞—Ç–µ–≥–∏—è" v2.2.
         */
        function generateConservativeStrategy(numCombinations, customData = null) {
            const dataToUse = customData || lottoData;
            const EPOCH_SIZE = 100;
            const SMART_HISTORY_SIZE = 15;
            const RECENT_ANALYSIS_SIZE = 3; // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 2-3 —Ç–∏—Ä–∞–∂–∞ –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏

            console.log('================================================================');
            console.log('üöÄ –£–õ–£–ß–®–ï–ù–ù–ê–Ø –ê–î–ê–ü–¢–ò–í–ù–ê–Ø –ö–û–ù–°–ï–†–í–ê–¢–ò–í–ù–ê–Ø –°–¢–†–ê–¢–ï–ì–ò–Ø (v3.0)');
            console.log('üéØ –ê–î–ê–ü–¢–ò–í–ù–´–ô –ê–ù–ê–õ–ò–ó –ü–û–°–õ–ï–î–ù–ò–• 2-3 –¢–ò–†–ê–ñ–ï–ô + –ì–ò–ë–ö–ò–ï –ü–†–ê–í–ò–õ–ê');

            // 1. –ü–æ–ª—É—á–∞–µ–º "—É–º–Ω—ã–µ" —Ü–µ–ª–µ–≤—ã–µ –Ω–æ–º–µ—Ä–∞ (–ª–æ–≥–∏–∫–∞ v2.2)
            const targetNumbers = getSmartTargetNumbers(SMART_HISTORY_SIZE, dataToUse);

            // 2. –ê–î–ê–ü–¢–ò–í–ù–´–ô –ê–ù–ê–õ–ò–ó –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 2-3 —Ç–∏—Ä–∞–∂–µ–π
            console.log(`üéØ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑: –ø–æ—Å–ª–µ–¥–Ω–∏–µ ${RECENT_ANALYSIS_SIZE} —Ç–∏—Ä–∞–∂–µ–π.`);
            const adaptivePattern = analyzeRecentPattern(RECENT_ANALYSIS_SIZE, dataToUse);
            console.log(`üìä –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω: ${adaptivePattern.low}L-${adaptivePattern.mid}M-${adaptivePattern.high}H`);
            console.log(`üìà –¢—Ä–µ–Ω–¥ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏: ${adaptivePattern.efficiency.toFixed(1)}%`);

            // 3. –ì–ò–ë–ö–ò–ï –î–ò–ê–ü–ê–ó–û–ù–´ —Å —É—á–µ—Ç–æ–º –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
            const adaptiveRanges = getAdaptiveRanges(adaptivePattern, dataToUse);
            console.log(`üé™ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã: ${adaptiveRanges.low.min}-${adaptiveRanges.low.max} (–Ω–∏–∑–∫–∏–µ), ${adaptiveRanges.mid.min}-${adaptiveRanges.mid.max} (—Å—Ä–µ–¥–Ω–∏–µ)`);

            // 4. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º "—ç–ø–æ—Ö—É" –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ç—Ä–µ–Ω–¥–∞ (–ª–æ–≥–∏–∫–∞ v2)
            console.log(`üìö –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑: –ø–æ—Å–ª–µ–¥–Ω–∏–µ ${EPOCH_SIZE} —Ç–∏—Ä–∞–∂–µ–π.`);
            const dominantPattern = findDominantPattern(EPOCH_SIZE, dataToUse);
            console.log(`‚ö° –î–æ–º–∏–Ω–∏—Ä—É—é—â–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω —ç–ø–æ—Ö–∏: ${dominantPattern.low}L-${dominantPattern.mid}M-${dominantPattern.high}H`);

            console.log('5. –£–õ–£–ß–®–ï–ù–ù–´–ô –°–ö–û–†–ò–ù–ì –ù–û–ú–ï–†–û–í –° –ê–î–ê–ü–¢–ò–í–ù–´–ú–ò –ü–†–ê–í–ò–õ–ê–ú–ò...');

            // 5. –û—Ü–µ–Ω–∏—Ç—å –∫–∞–∂–¥—ã–π –Ω–æ–º–µ—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ —É–ª—É—á—à–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏
            const candidates = [];

            for (let num = 1; num <= 49; num++) {
                const lifecycle = analyzeNumberLifecycle(num, dataToUse);
                if (lifecycle.phase === 'unknown') continue;

                // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∞–ª–∏–∑ –í–æ–ª–Ω –≠–ª–ª–∏–æ—Ç—Ç–∞
                const waveScore = analyzeElliotWaves(num, dataToUse);
                lifecycle.score += waveScore * 3;

                // –î–æ–±–∞–≤–ª—è–µ–º –±–æ–Ω—É—Å –∑–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é —Å "—É–º–Ω—ã–º–∏" —Ü–µ–ª—è–º–∏
                if (targetNumbers.includes(num)) {
                    lifecycle.score += 40;
                }

                // –ê–î–ê–ü–¢–ò–í–ù–´–ô –°–ö–û–†–ò–ù–ì –° –£–ß–ï–¢–û–ú –î–ò–ê–ü–ê–ó–û–ù–û–í
                let category = 'unknown';
                let adaptiveScore = 0;

                if (num >= adaptiveRanges.low.min && num <= adaptiveRanges.low.max) {
                    category = 'low';
                    adaptiveScore = 50; // –ë–∞–∑–æ–≤—ã–π –±–æ–Ω—É—Å –∑–∞ –Ω–∏–∑–∫–∏–µ
                    if (lifecycle.phase === '–ü—Ä–æ–±—É–∂–¥–∞–µ—Ç—Å—è') adaptiveScore += 20;
                    if (lifecycle.phase === '–ì–æ—Ä—è—á–∏–π') adaptiveScore += 10;
                }
                else if (num >= adaptiveRanges.mid.min && num <= adaptiveRanges.mid.max) {
                    category = 'mid';
                    // –ì–ò–ë–ö–ò–ï –ü–†–ê–í–ò–õ–ê –î–õ–Ø –°–†–ï–î–ù–ò–• –ß–ò–°–ï–õ!
                    if (adaptivePattern.mid >= 3 && adaptivePattern.efficiency > 50) {
                        // –ï—Å–ª–∏ —Å—Ä–µ–¥–Ω–∏–µ –¥–æ–º–∏–Ω–∏—Ä—É—é—Ç –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã - –¥–∞–µ–º –±–æ–Ω—É—Å
                        adaptiveScore = 30;
                        if (lifecycle.phase === '–°—Ç–∞–±–∏–ª—å–Ω—ã–π') adaptiveScore += 15;
                        if (lifecycle.phase === '–ì–æ—Ä—è—á–∏–π') adaptiveScore += 25;
                        if (lifecycle.phase === '–ü—Ä–æ–±—É–∂–¥–∞–µ—Ç—Å—è') adaptiveScore += 20;
                    } else {
                        // –í –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö - —É–º–µ—Ä–µ–Ω–Ω—ã–π –±–æ–Ω—É—Å –∏–ª–∏ —à—Ç—Ä–∞—Ñ
                        adaptiveScore = adaptivePattern.mid >= 2 ? 15 : -10;
                    }
                }
                else {
                    category = 'high';
                    adaptiveScore = 40; // –ë–∞–∑–æ–≤—ã–π –±–æ–Ω—É—Å –∑–∞ –≤—ã—Å–æ–∫–∏–µ
                    if (lifecycle.phase === '–ì–æ—Ä—è—á–∏–π') adaptiveScore += 15;
                    if (lifecycle.phase === '–û—Å—Ç—ã–≤–∞–µ—Ç') adaptiveScore += 10;
                }

                const finalScore = lifecycle.score + adaptiveScore;

                candidates.push({
                    number: num,
                    score: finalScore,
                    phase: lifecycle.phase,
                    category: category,
                    cv: lifecycle.cv,
                    adaptiveBonus: adaptiveScore
                });
            }

            // 6. –†–∞–∑–¥–µ–ª–∏—Ç—å –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –Ω–∞ –ø—É–ª—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –æ—á–∫–∞–º
            const lowPool = candidates.filter(c => c.category === 'low').sort((a, b) => b.score - a.score);
            const midPool = candidates.filter(c => c.category === 'mid').sort((a, b) => b.score - a.score);
            const highPool = candidates.filter(c => c.category === 'high').sort((a, b) => b.score - a.score);

            console.log(`üìä –ü—É–ª—ã –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤: ${lowPool.length} –Ω–∏–∑–∫–∏—Ö, ${midPool.length} —Å—Ä–µ–¥–Ω–∏—Ö, ${highPool.length} –≤—ã—Å–æ–∫–∏—Ö.`);
            console.log('6. –ì–ï–ù–ï–†–ê–¶–ò–Ø –ö–û–ú–ë–ò–ù–ê–¶–ò–ô –ü–û –ê–î–ê–ü–¢–ò–í–ù–û–ú–£ –ü–ê–¢–¢–ï–†–ù–£...');

            // 7. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏, —Å–ª–µ–¥—É—è –ê–î–ê–ü–¢–ò–í–ù–û–ú–£ –ø–∞—Ç—Ç–µ—Ä–Ω—É
                const combinations = [];
            for (let i = 0; i < numCombinations; i++) {
                let combo = new Set();

                const pickFromPool = (pool, count) => {
                    if (count === 0 || pool.length === 0) return;

                    const shuffledPool = [...pool].sort(() => 0.5 - Math.random());
                    let picked = 0;
                    for (const candidate of shuffledPool) {
                        if (picked < count && !combo.has(candidate.number)) {
                            combo.add(candidate.number);
                            picked++;
                        }
                    }
                };

                // –ò–°–ü–û–õ–¨–ó–£–ï–ú –ê–î–ê–ü–¢–ò–í–ù–´–ô –ü–ê–¢–¢–ï–†–ù –≤–º–µ—Å—Ç–æ –¥–æ–º–∏–Ω–∏—Ä—É—é—â–µ–≥–æ
                pickFromPool(lowPool, adaptivePattern.low);
                pickFromPool(midPool, adaptivePattern.mid);
                pickFromPool(highPool, adaptivePattern.high);

                // –ï—Å–ª–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –Ω–µ –ø–æ–ª–Ω–∞—è, –¥–æ–±–∏—Ä–∞–µ–º –∏–∑ –ª—É—á—à–∏—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
                if (combo.size < 6) {
                    const allCandidates = [...lowPool, ...midPool, ...highPool].sort((a, b) => b.score - a.score);
                    for (const candidate of allCandidates) {
                        if (combo.size < 6 && !combo.has(candidate.number)) {
                            combo.add(candidate.number);
                        } else if (combo.size >= 6) {
                            break;
                        }
                    }
                }

                const finalCombo = Array.from(combo).sort((a, b) => a - b);
                if (finalCombo.length === 6) {
                    combinations.push(finalCombo);
                }
            }
            
            console.log(`‚úÖ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ ${combinations.length} —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö –≥–∏–±—Ä–∏–¥–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π.`);
            console.log('================================================================');
                return combinations;
        }

        // –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è - –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Å–æ—á–µ—Ç–∞–Ω–∏–µ
        function generateBalancedStrategy(numCombinations) {
            const candidates = [];

            // –û—Ü–µ–Ω–∏–≤–∞–µ–º –≤—Å–µ –Ω–æ–º–µ—Ä–∞ –ø–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º
            for (let num = 1; num <= 49; num++) {
                const numberData = lottoData.number_data[num] || [];
                if (numberData.length < 3) continue;

                const trend = calculateNumberTrend(num);
                const { debt } = calculateDebtIndicator(num);
                const { avgGap, cv } = calculateGapStats(numberData);

                // –ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Ä–∏—Å–∫–æ–º –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–º
                let score = 0;

                // –ü–ª—é—Å—ã –∑–∞ –Ω–µ–¥–∞–≤–Ω—é—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
                if (trend.status === 'hot' || trend.status === 'very-hot') score += 35; // –£–≤–µ–ª–∏—á–µ–Ω –±–æ–Ω—É—Å
                else if (trend.status === 'cold') score += 25; // –£–≤–µ–ª–∏—á–µ–Ω –±–æ–Ω—É—Å

                // –ü–ª—é—Å—ã –∑–∞ –∫–æ—Ä–æ—Ç–∫–∏–µ –ø–∞—É–∑—ã (–∫–ª–∞—Å—Ç–µ—Ä–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ –∏–º–µ—é—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ)
                if (debt < 5) score += 30; // –ë–æ–Ω—É—Å –∑–∞ –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏–µ –ø–∞—É–∑—ã
                else if (debt < 10) score += 20; // –ë–æ–Ω—É—Å –∑–∞ –∫–æ—Ä–æ—Ç–∫–∏–µ –ø–∞—É–∑—ã
                else if (debt > 5 && debt < 20) score += 25; // –£–º–µ—Ä–µ–Ω–Ω—ã–π –¥–æ–ª–≥
                else if (debt > 20) score += 15; // –î–ª–∏–Ω–Ω—ã–π –¥–æ–ª–≥

                // –£—Å–∏–ª–µ–Ω–Ω—ã–µ –ø–ª—é—Å—ã –∑–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
                if (cv < 0.7) score += 35; // –í—ã—Å–æ–∫–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
                else if (cv < 1.0) score += 25; // –°—Ä–µ–¥–Ω—è—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
                else if (cv < 1.2) score += 15; // –£–º–µ—Ä–µ–Ω–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å

                // –£—Å–∏–ª–µ–Ω–Ω—ã–µ –º–∏–Ω—É—Å—ã –∑–∞ —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫—É—é –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
                if (cv > 1.5) score -= 25; // –•–∞–æ—Ç–∏—á–Ω—ã–π —Ä–∏—Ç–º
                else if (cv > 1.2) score -= 10; // –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å

                if (score > 20) {
                    candidates.push({ number: num, score: score });
                }
            }

            candidates.sort((a, b) => b.score - a.score);
            const topNumbers = candidates.slice(0, 25).map(item => item.number);

            if (topNumbers.length < 6) {
                throw new Error('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –Ω–æ–º–µ—Ä–æ–≤');
            }

                const combinations = [];
            for (let i = 0; i < numCombinations; i++) {
                const combo = [];
                const shuffled = [...topNumbers].sort(() => Math.random() - 0.5);

                for (let j = 0; j < 6; j++) {
                    combo.push(shuffled[j]);
                }

                    combinations.push(combo.sort((a, b) => a - b));
                }

                return combinations;
        }

        // –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫
        function generateAggressiveStrategy(numCombinations) {
            const highRiskNumbers = [];

            // –ò—â–µ–º –Ω–æ–º–µ—Ä–∞ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–º
            for (let num = 1; num <= 49; num++) {
                const numberData = lottoData.number_data[num] || [];
                if (numberData.length < 2) continue;

                const trend = calculateNumberTrend(num);
                const { debt } = calculateDebtIndicator(num);

                // –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫ (—É—Å–∏–ª–µ–Ω—ã –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤)
                if ((trend.status === 'very-cold' || trend.status === 'cold') &&
                    debt > 10 && // –°–Ω–∏–∂–µ–Ω –ø–æ—Ä–æ–≥ –ø–∞—É–∑—ã –¥–ª—è –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–æ–≥–æ –æ—Ö–≤–∞—Ç–∞
                    numberData.length > 3) { // –°–Ω–∏–∂–µ–Ω –ø–æ—Ä–æ–≥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤—ã–ø–∞–¥–µ–Ω–∏–π
                    highRiskNumbers.push(num);
                }
            }

            if (highRiskNumbers.length < 6) {
                // –ï—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ö–æ–ª–æ–¥–Ω—ã—Ö, –¥–æ–±–∞–≤–ª—è–µ–º –≥–æ—Ä—è—á–∏–µ –¥–ª—è –±–∞–ª–∞–Ω—Å–∞
                for (let num = 1; num <= 49; num++) {
                    const numberData = lottoData.number_data[num] || [];
                    if (numberData.length < 3) continue;

                    const trend = calculateNumberTrend(num);
                    if ((trend.status === 'very-hot' || trend.status === 'hot') &&
                        !highRiskNumbers.includes(num)) {
                        highRiskNumbers.push(num);
                    }
                }
            }

            if (highRiskNumbers.length < 6) {
                throw new Error('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–æ–º–µ—Ä–æ–≤ –¥–ª—è –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏');
            }

            const combinations = [];
            for (let i = 0; i < numCombinations; i++) {
                const combo = [];
                const shuffled = [...highRiskNumbers].sort(() => Math.random() - 0.5);

                for (let j = 0; j < 6; j++) {
                    combo.push(shuffled[j]);
                }

                combinations.push(combo.sort((a, b) => a - b));
            }

            return combinations;
        }

        // –ò–ò-—Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Å —Å–∞–º–æ–æ–±—É—á–µ–Ω–∏–µ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function generateAIStrategy(numCombinations) {
            console.log('================================================================');
            console.log('ü§ñ –ò–ò-–°–¢–†–ê–¢–ï–ì–ò–Ø –° –°–ê–ú–û–û–ë–£–ß–ï–ù–ò–ï–ú');
            console.log('üß† –ê–ù–ê–õ–ò–ó –ü–û–õ–ù–û–ô –°–¢–ê–¢–ò–°–¢–ò–ö–ò –î–õ–Ø –ü–†–ï–î–°–ö–ê–ó–ê–ù–ò–Ø');

            // –ü–æ–ª—É—á–∞–µ–º "—É–º–Ω—ã–µ" —Ü–µ–ª–µ–≤—ã–µ –Ω–æ–º–µ—Ä–∞ (–ª–æ–≥–∏–∫–∞ v2.2)
            const targetNumbers = getSmartTargetNumbers(15, lottoData);

            // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–ª–∞—Å—Ç–µ—Ä–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
            const clusterBonuses = analyzeClusterBehavior(lottoData);

            // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç—Ä–µ–Ω–¥—ã –≤—Å–µ—Ö –Ω–æ–º–µ—Ä–æ–≤
            const numberTrends = {};
            for (let i = 1; i <= 49; i++) {
                numberTrends[i] = calculateNumberTrend(i);
            }

            // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∂–∏–∑–Ω–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã –≤—Å–µ—Ö –Ω–æ–º–µ—Ä–æ–≤
            const numberLifecycles = {};
            for (let i = 1; i <= 49; i++) {
                numberLifecycles[i] = analyzeNumberLifecycle(i, lottoData);
            }

            // –°–æ–∑–¥–∞–µ–º –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Ñ–∞–∫—Ç–æ—Ä–æ–≤
            const aiScores = {};

            for (let i = 1; i <= 49; i++) {
                let score = 0;

                // 1. –ë–∞–∑–æ–≤—ã–π —Ç—Ä–µ–Ω–¥
                const trend = numberTrends[i];
                if (trend.status === 'very-hot') score += 3.0;
                else if (trend.status === 'hot') score += 2.0;
                else if (trend.status === 'cold') score += 1.5;
                else if (trend.status === 'very-cold') score += 1.0;

                // 2. –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª
                const lifecycle = numberLifecycles[i];
                if (lifecycle.phase === '–ì–æ—Ä—è—á–∏–π') score += 2.5;
                else if (lifecycle.phase === '–ü—Ä–æ–±—É–∂–¥–∞–µ—Ç—Å—è') score += 2.0;
                else if (lifecycle.phase === '–°—Ç–∞–±–∏–ª—å–Ω—ã–π') score += 1.5;
                else if (lifecycle.phase === '–°–ø—è—â–∏–π') score += 1.0;

                // 3. –ö–ª–∞—Å—Ç–µ—Ä–Ω—ã–µ –±–æ–Ω—É—Å—ã
                if (clusterBonuses[i]) score += clusterBonuses[i];

                // 4. "–£–º–Ω—ã–µ" —Ü–µ–ª–∏
                if (targetNumbers.includes(i)) score += 2.0;

                // 5. –í–æ–ª–Ω–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
                const waveScore = analyzeElliotWaves(i, lottoData);
                score += waveScore * 0.5;

                aiScores[i] = { score, number: i };
            }

            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–æ–º–µ—Ä–∞ –ø–æ –ò–ò-–æ—Ü–µ–Ω–∫–µ
            const sortedByAI = Object.values(aiScores).sort((a, b) => b.score - a.score);

            // –í—ã–±–∏—Ä–∞–µ–º —Ç–æ–ø-15 –Ω–æ–º–µ—Ä–æ–≤ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
            const topAINumbers = sortedByAI.slice(0, 15).map(item => item.number);

            console.log(`üéØ –¢–æ–ø-15 –Ω–æ–º–µ—Ä–æ–≤ –ø–æ –ò–ò: ${topAINumbers.join(', ')}`);

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ò–ò-–∞–Ω–∞–ª–∏–∑–∞
            const combinations = [];
            for (let i = 0; i < numCombinations; i++) {
                const combo = [];
                const shuffled = [...topAINumbers].sort(() => Math.random() - 0.5);

                for (let j = 0; j < 6; j++) {
                    combo.push(shuffled[j]);
                }

                combinations.push(combo.sort((a, b) => a - b));
            }

            console.log(`‚úÖ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ ${combinations.length} –ò–ò-–∫–æ–º–±–∏–Ω–∞—Ü–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏`);
            console.log('================================================================');

            return combinations;
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
        function displayStrategyResults(combinations, title, realEfficiency = null, testCount = null) {
                const container = document.getElementById('generator-results-container');

                if (combinations.length === 0) {
                container.innerHTML = '<div class="error">–ù–µ —É–¥–∞–ª–æ—Å—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏</div>';
                    return;
                }

                // –¢–µ—Å—Ç–∏—Ä—É–µ–º –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Ç–∏—Ä–∞–∂–µ–π, —É–∫–∞–∑–∞–Ω–Ω–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
                const userTestCount = parseInt(document.getElementById('testTirageCount').value, 10) || 20;
                const actualTestCount = Math.min(userTestCount, lottoData.draws.length);
                const testDraws = lottoData.draws.slice(0, actualTestCount);
                const winningResults = [];

                combinations.forEach((combo, comboIndex) => {
                    testDraws.forEach((draw, drawIndex) => {
                        const actualNumbers = new Set(draw.numbers);
                        const matchingNumbers = combo.filter(num => actualNumbers.has(num));
                        const matchCount = matchingNumbers.length;
                        if (matchCount >= 3) { // –ú–∏–Ω–∏–º—É–º 3 —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è = –≤—ã–∏–≥—Ä—ã—à
                            winningResults.push({
                                game: comboIndex + 1,
                                drawNumber: draw.draw_number,
                                date: draw.date,
                                matches: matchCount,
                                matchingNumbers: matchingNumbers,
                                combo: combo
                            });
                        }
                    });
                });

                // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –≤—ã–∏–≥—Ä—ã—à–∏ –ø–æ —Ç–∏—Ä–∞–∂–∞–º –¥–ª—è –æ—Ç—á–µ—Ç–∞
                const drawsWithWins = {};
                winningResults.forEach(result => {
                    if (!drawsWithWins[result.drawNumber]) {
                        drawsWithWins[result.drawNumber] = {
                            date: result.date,
                            games: []
                        };
                    }
                    drawsWithWins[result.drawNumber].games.push({
                        game: result.game,
                        matches: result.matches,
                        matchingNumbers: result.matchingNumbers,
                        combo: result.combo
                    });
                });

                const titleHtml = `<h3 class="generator-results-title">${title} (${combinations.length} –∫–æ–º–±.)</h3>`;

                const gridHtml = combinations.map((combo, index) => {
                    const numbersHtml = combo.map(num => {
                        // –ü–æ–ª—É—á–∞–µ–º —Ç—Ä–µ–Ω–¥ –¥–ª—è —Ü–≤–µ—Ç–∞
                        const trend = calculateNumberTrend(num);
                        const trendClass = getTrendClass(trend.status);
                        return `<div class="combo-number ${trendClass}" onclick="selectNumberFromGenerator(${num})" title="–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –Ω–æ–º–µ—Ä–∞ ${num}">${num}</div>`;
                    }).join('');

                return `<div class="combination-card">
                    <div class="combination-card-title">–ò–≥—Ä–∞ ${index + 1}:</div>
                    <div class="combination-numbers">${numbersHtml}</div>
                </div>`;
                }).join('');

                container.innerHTML = `${titleHtml}<div class="combination-grid">${gridHtml}</div>`;

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º HTML –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤—ã–∏–≥—Ä—ã—à–∞—Ö
            let winningInfoHtml = '';
            if (Object.keys(drawsWithWins).length > 0) {
                winningInfoHtml = `
                    <div style="margin-top: 15px; padding: 15px; background: #d4edda; border: 1px solid #c3e6cb; border-radius: 8px;">
                        <h5 style="margin-top: 0; color: #155724;">üéØ –í—ã–∏–≥—Ä—ã—à–∏ –Ω–∞–π–¥–µ–Ω—ã –≤ —Ç–∏—Ä–∞–∂–∞—Ö:</h5>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 15px;">
                            ${Object.entries(drawsWithWins)
                                .sort((a, b) => b[0] - a[0]) // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –æ—Ç –Ω–æ–≤–æ–≥–æ –∫ —Å—Ç–∞—Ä–æ–º—É
                                .map(([drawNum, info]) => `
                                <div style="padding: 12px; background: rgba(255,255,255,0.9); border-radius: 8px; border-left: 4px solid #28a745; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                    <div style="font-weight: 600; margin-bottom: 8px; color: #155724; font-size: 0.95em;">–¢–∏—Ä–∞–∂ ${drawNum} (${info.date})</div>
                                    <div style="font-size: 0.9em; color: #333; line-height: 1.4;">
                                        ${info.games.map(game => `<div><strong>–ò–≥—Ä–∞ ${game.game}:</strong> —Å–æ–≤–ø–∞–ª–∏ ${game.matchingNumbers.join(', ')} <span style="color: #666;">(${game.matches} –∏–∑ 6)</span></div>`).join('')}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            } else {
                winningInfoHtml = `
                    <div style="margin-top: 15px; padding: 15px; background: #f8d7da; border: 1px solid #f5c6cb; border-radius: 8px;">
                        <h5 style="margin-top: 0; color: #721c24;">‚ùå –í—ã–∏–≥—Ä—ã—à–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h5>
                        <p style="margin: 0;">–í –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–∏—Ä–∞–∂–∞—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π —Å 3+ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è–º–∏</p>
                    </div>
                `;
            }

            // –î–æ–±–∞–≤–ª—è–µ–º –∫—Ä–∞—Ç–∫—É—é —Å–≤–æ–¥–∫—É
            let warningHtml = '';
            if (userTestCount > actualTestCount) {
                warningHtml = `
                    <div style="margin: 5px 0; padding: 5px 10px; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 5px; font-size: 12px; color: #856404;">
                        ‚ö†Ô∏è –ó–∞–ø—Ä–æ—à–µ–Ω–æ ${userTestCount} —Ç–∏—Ä–∞–∂–µ–π, –Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ ${actualTestCount}. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
                    </div>
                `;
            }

            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
            const maxMatches = winningResults.length > 0 ? Math.max(...winningResults.map(r => r.matches)) : 0;

            const summaryHtml = `
                <div class="quick-summary" style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                    <h4 style="margin-top: 0; color: #333;">üìä –ë—ã—Å—Ç—Ä–∞—è —Å–≤–æ–¥–∫–∞</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
                        <div style="padding: 10px; background: rgba(255,255,255,0.8); border-radius: 6px; text-align: center;">
                            <div style="font-size: 1.2em; font-weight: bold; color: var(--primary-color);">${combinations.length}</div>
                            <div style="font-size: 0.8em; color: #666;">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π</div>
                        </div>
                        <div style="padding: 10px; background: rgba(255,255,255,0.8); border-radius: 6px; text-align: center;">
                            <div style="font-size: 1.2em; font-weight: bold; color: ${winningResults.length > 0 ? '#28a745' : '#dc3545'};">${winningResults.length}</div>
                            <div style="font-size: 0.8em; color: #666;">–ù–∞–π–¥–µ–Ω–æ –≤—ã–∏–≥—Ä—ã—à–µ–π</div>
                        </div>
                        <div style="padding: 10px; background: rgba(255,255,255,0.8); border-radius: 6px; text-align: center;">
                            <div style="font-size: 1.2em; font-weight: bold; color: ${maxMatches >= 3 ? '#28a745' : '#dc3545'};">${maxMatches}</div>
                            <div style="font-size: 0.8em; color: #666;">–ú–∞–∫—Å–∏–º—É–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π</div>
                        </div>
                    </div>
                    <p style="margin: 5px 0;">‚Ä¢ –°—Ä–µ–¥–Ω—è—è —Å—É–º–º–∞: ${calculateAverageSum(combinations)}</p>
                    <p style="margin: 5px 0;">‚Ä¢ –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤: ${countUniqueNumbers(combinations)}</p>
                    <p style="margin: 5px 0;">‚Ä¢ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ —Ç–∏—Ä–∞–∂–µ–π: ${actualTestCount}</p>
                    ${warningHtml}
                    ${winningInfoHtml}
                </div>
            `;

            container.insertAdjacentHTML('beforeend', summaryHtml);
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function calculateAverageSum(combinations) {
            const sums = combinations.map(combo => combo.reduce((a, b) => a + b, 0));
            const avg = sums.reduce((a, b) => a + b, 0) / sums.length;
            return Math.round(avg);
        }

        function countUniqueNumbers(combinations) {
            const allNumbers = new Set();
            combinations.forEach(combo => combo.forEach(num => allNumbers.add(num)));
            return allNumbers.size;
        }

        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±—ã—Å—Ç—Ä–æ–π —Å–≤–æ–¥–∫–∏ (–≥–ª–æ–±–∞–ª—å–Ω–∞—è)
        function updateQuickSummary() {
            const container = document.getElementById('generator-results-container');
            if (!container) return;

            // –ò—â–µ–º —ç–ª–µ–º–µ–Ω—Ç –±—ã—Å—Ç—Ä–æ–π —Å–≤–æ–¥–∫–∏ (–ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É –∏–ª–∏ –ø–æ –∫–ª–∞—Å—Å—É)
            let summaryElement = container.querySelector('.quick-summary');
            if (!summaryElement) {
                // –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω –ø–æ –∫–ª–∞—Å—Å—É, –∏—â–µ–º –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É
                const headings = container.querySelectorAll('h4');
                for (let heading of headings) {
                    if (heading.textContent.includes('–ë—ã—Å—Ç—Ä–∞—è —Å–≤–æ–¥–∫–∞')) {
                        summaryElement = heading.parentElement;
                        break;
                    }
                }
            }
            if (!summaryElement) return;

            // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –∏–∑ DOM
            const combinationCards = container.querySelectorAll('.combination-card');
            if (combinationCards.length === 0) return;

            const combinations = [];
            combinationCards.forEach(card => {
                const numbers = [];
                const numberElements = card.querySelectorAll('.combo-number');
                numberElements.forEach(element => {
                    numbers.push(parseInt(element.textContent, 10));
                });
                if (numbers.length === 6) {
                    combinations.push(numbers);
                }
            });

            if (combinations.length === 0) return;

            // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –∞–Ω–∞–ª–∏–∑ –Ω–∞ –Ω–æ–≤–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Ç–∏—Ä–∞–∂–µ–π
            const userTestCount = parseInt(document.getElementById('testTirageCount').value, 10) || 20;
            const actualTestCount = Math.min(userTestCount, lottoData.draws.length);
            const testDraws = lottoData.draws.slice(0, actualTestCount);

            const winningResults = [];
                combinations.forEach((combo, comboIndex) => {
                    testDraws.forEach((draw, drawIndex) => {
                        const actualNumbers = new Set(draw.numbers);
                        const matchingNumbers = combo.filter(num => actualNumbers.has(num));
                        const matchCount = matchingNumbers.length;
                        if (matchCount >= 3) {
                            winningResults.push({
                                game: comboIndex + 1,
                                drawNumber: draw.draw_number,
                                date: draw.date,
                                matches: matchCount,
                                matchingNumbers: matchingNumbers,
                                combo: combo
                            });
                        }
                    });
                });

            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –≤—ã–∏–≥—Ä—ã—à–∏ –ø–æ —Ç–∏—Ä–∞–∂–∞–º
            const drawsWithWins = {};
            winningResults.forEach(result => {
                if (!drawsWithWins[result.drawNumber]) {
                    drawsWithWins[result.drawNumber] = {
                        date: result.date,
                        games: []
                    };
                }
                drawsWithWins[result.drawNumber].games.push({
                    game: result.game,
                    matches: result.matches,
                    matchingNumbers: result.matchingNumbers,
                    combo: result.combo
                });
            });

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º HTML –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π —Å–≤–æ–¥–∫–∏
            let winningInfoHtml = '';
            if (Object.keys(drawsWithWins).length > 0) {
                // –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç –Ω–æ–≤—ã—Ö –∫ —Å—Ç–∞—Ä—ã–º
                const sortedResults = Object.entries(drawsWithWins)
                    .sort((a, b) => b[0] - a[0]) // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –æ—Ç –Ω–æ–≤–æ–≥–æ –∫ —Å—Ç–∞—Ä–æ–º—É
                    .flatMap(([drawNum, info]) => info.games.map(game => ({ drawNumber: drawNum, date: info.date, ...game })));

                // –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ –≥—Ä—É–ø–ø—ã –ø–æ 3 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –¥–ª—è –∫–æ–ª–æ–Ω–æ–∫
                const columns = [];
                for (let i = 0; i < sortedResults.length; i += 3) {
                    columns.push(sortedResults.slice(i, i + 3));
                }

                winningInfoHtml = `
                    <div style="margin-top: 15px; padding: 15px; background: #d4edda; border: 1px solid #c3e6cb; border-radius: 8px;">
                        <h5 style="margin-top: 0; color: #155724;">üéØ –í—ã–∏–≥—Ä—ã—à–∏ –Ω–∞–π–¥–µ–Ω—ã –≤ —Ç–∏—Ä–∞–∂–∞—Ö:</h5>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 15px;">
                            ${columns.map((columnResults, columnIndex) => `
                                <div style="display: flex; flex-direction: column; gap: 12px;">
                                    ${columnResults.map(result => `
                                    <div style="padding: 12px; background: rgba(255,255,255,0.9); border-radius: 8px; border-left: 4px solid #28a745; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                        <div style="font-weight: 600; margin-bottom: 8px; color: #155724; font-size: 0.95em;">–¢–∏—Ä–∞–∂ ${result.drawNumber} (${result.date})</div>
                                        <div style="font-size: 0.9em; color: #333; line-height: 1.4;">
                                            <strong>–ò–≥—Ä–∞ ${result.game}:</strong> —Å–æ–≤–ø–∞–ª–∏ ${result.matchingNumbers.join(', ')}
                                            <span style="color: #666; margin-left: 8px;">(${result.matches} –∏–∑ 6)</span>
                                        </div>
                                    </div>
                                    `).join('')}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            } else {
                winningInfoHtml = `
                    <div style="margin-top: 15px; padding: 15px; background: #f8d7da; border: 1px solid #f5c6cb; border-radius: 8px;">
                        <h5 style="margin-top: 0; color: #721c24;">‚ùå –í—ã–∏–≥—Ä—ã—à–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h5>
                        <p style="margin: 0;">–í –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–∏—Ä–∞–∂–∞—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π —Å 3+ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è–º–∏</p>
                    </div>
                `;
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –±—ã—Å—Ç—Ä–æ–π —Å–≤–æ–¥–∫–∏
            let warningHtml = '';
            if (userTestCount > actualTestCount) {
                warningHtml = `
                    <div style="margin: 5px 0; padding: 5px 10px; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 5px; font-size: 12px; color: #856404;">
                        ‚ö†Ô∏è –ó–∞–ø—Ä–æ—à–µ–Ω–æ ${userTestCount} —Ç–∏—Ä–∞–∂–µ–π, –Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ ${actualTestCount}. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
                    </div>
                `;
            }

            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
            const maxMatches = winningResults.length > 0 ? Math.max(...winningResults.map(r => r.matches)) : 0;

            const updatedSummaryHtml = `
                <div class="quick-summary" style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                    <h4 style="margin-top: 0; color: #333;">üìä –ë—ã—Å—Ç—Ä–∞—è —Å–≤–æ–¥–∫–∞</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
                        <div style="padding: 10px; background: rgba(255,255,255,0.8); border-radius: 6px; text-align: center;">
                            <div style="font-size: 1.2em; font-weight: bold; color: var(--primary-color);">${combinations.length}</div>
                            <div style="font-size: 0.8em; color: #666;">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π</div>
                        </div>
                        <div style="padding: 10px; background: rgba(255,255,255,0.8); border-radius: 6px; text-align: center;">
                            <div style="font-size: 1.2em; font-weight: bold; color: ${winningResults.length > 0 ? '#28a745' : '#dc3545'};">${winningResults.length}</div>
                            <div style="font-size: 0.8em; color: #666;">–ù–∞–π–¥–µ–Ω–æ –≤—ã–∏–≥—Ä—ã—à–µ–π</div>
                        </div>
                        <div style="padding: 10px; background: rgba(255,255,255,0.8); border-radius: 6px; text-align: center;">
                            <div style="font-size: 1.2em; font-weight: bold; color: ${maxMatches >= 3 ? '#28a745' : '#dc3545'};">${maxMatches}</div>
                            <div style="font-size: 0.8em; color: #666;">–ú–∞–∫—Å–∏–º—É–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π</div>
                        </div>
                    </div>
                    <p style="margin: 5px 0;">‚Ä¢ –°—Ä–µ–¥–Ω—è—è —Å—É–º–º–∞: ${calculateAverageSum(combinations)}</p>
                    <p style="margin: 5px 0;">‚Ä¢ –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤: ${countUniqueNumbers(combinations)}</p>
                    <p style="margin: 5px 0;">‚Ä¢ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ —Ç–∏—Ä–∞–∂–µ–π: ${actualTestCount}</p>
                    ${warningHtml}
                    ${winningInfoHtml}
                </div>
            `;

            // –ó–∞–º–µ–Ω—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –±—ã—Å—Ç—Ä–æ–π —Å–≤–æ–¥–∫–∏
            summaryElement.outerHTML = updatedSummaryHtml;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
        function testCustomCombination() {
            const testCount = parseInt(document.getElementById('customTestTirageCount').value, 10) || 20;
            const container = document.getElementById('custom-results-container');

            // –°–æ–±–∏—Ä–∞–µ–º —á–∏—Å–ª–∞ –∏–∑ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
            const numbers = [];
            let hasEmptyFields = false;

            for (let i = 1; i <= 6; i++) {
                const numInput = document.getElementById(`customNum${i}`);
                const numValue = parseInt(numInput.value.trim());

                if (numInput.value.trim() === '' || isNaN(numValue)) {
                    hasEmptyFields = true;
                    numInput.style.borderColor = '#dc3545'; // –ö—Ä–∞—Å–Ω–∞—è —Ä–∞–º–∫–∞ –¥–ª—è –ø—É—Å—Ç—ã—Ö –ø–æ–ª–µ–π
                } else {
                    numInput.style.borderColor = 'var(--bg-lighter)'; // –°–±—Ä–æ—Å —Ä–∞–º–∫–∏
                    if (numValue >= 1 && numValue <= 49) {
                        numbers.push(numValue);
                    } else {
                        numInput.style.borderColor = '#dc3545'; // –ö—Ä–∞—Å–Ω–∞—è —Ä–∞–º–∫–∞ –¥–ª—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö —á–∏—Å–µ–ª
                        container.innerHTML = '<div class="error">–í—Å–µ —á–∏—Å–ª–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç 1 –¥–æ 49</div>';
                        return;
                    }
                }
            }

            if (hasEmptyFields) {
                container.innerHTML = '<div class="error">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ 6 –ø–æ–ª–µ–π —á–∏—Å–ª–∞–º–∏ –æ—Ç 1 –¥–æ 49</div>';
                return;
            }

            if (numbers.length !== 6) {
                container.innerHTML = '<div class="error">–í–≤–µ–¥–∏—Ç–µ —Ä–æ–≤–Ω–æ 6 —á–∏—Å–µ–ª –æ—Ç 1 –¥–æ 49</div>';
                return;
            }

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ —á–∏—Å–ª–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã
            const uniqueNumbers = [...new Set(numbers)];
            if (uniqueNumbers.length !== 6) {
                const duplicates = numbers.filter((num, index) => numbers.indexOf(num) !== index);
                const duplicateList = [...new Set(duplicates)].join(', ');
                container.innerHTML = `<div class="error">–ù–∞–π–¥–µ–Ω—ã –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —á–∏—Å–ª–∞: ${duplicateList}. –í –ª–æ—Ç–µ—Ä–µ–µ –≤—Å–µ —á–∏—Å–ª–∞ –≤ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏.</div>`;
                return;
            }

            const userTestCount = testCount;
            const actualTestCount = Math.min(userTestCount, lottoData.draws.length);

            if (lottoData.draws.length < actualTestCount) {
                container.innerHTML = '<div class="error">–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</div>';
                return;
            }

            // –ë–µ—Ä–µ–º —Å–∞–º—ã–µ —Å–≤–µ–∂–∏–µ —Ç–∏—Ä–∞–∂–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            const testDraws = lottoData.draws.slice(0, actualTestCount);
            const winningResults = [];

            // –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é –∫–æ–º–±–∏–Ω–∞—Ü–∏—é
            testDraws.forEach((draw, drawIndex) => {
                const actualNumbers = new Set(draw.numbers);
                const matchingNumbers = numbers.filter(num => actualNumbers.has(num));
                const matchCount = matchingNumbers.length;

                if (matchCount >= 3) { // –ú–∏–Ω–∏–º—É–º 3 —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è = –≤—ã–∏–≥—Ä—ã—à
                    winningResults.push({
                        drawNumber: draw.draw_number,
                        date: draw.date,
                        matches: matchCount,
                        matchingNumbers: matchingNumbers,
                        combo: numbers
                    });
                }
            });

            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            displayCustomCombinationResults([numbers], winningResults, actualTestCount);
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
        function displayCustomCombinationResults(combinations, winningResults, testCount) {
            const container = document.getElementById('custom-results-container');

            const titleHtml = `<h3 class="generator-results-title">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–∞—à–µ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏</h3>`;

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º HTML –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤—ã–∏–≥—Ä—ã—à–∞—Ö
            let winningInfoHtml = '';
            if (winningResults.length > 0) {
                // –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç –Ω–æ–≤—ã—Ö –∫ —Å—Ç–∞—Ä—ã–º
                const sortedResults = winningResults.sort((a, b) => b.drawNumber - a.drawNumber);

                // –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ –≥—Ä—É–ø–ø—ã –ø–æ 3 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –¥–ª—è –∫–æ–ª–æ–Ω–æ–∫
                const columns = [];
                for (let i = 0; i < sortedResults.length; i += 3) {
                    columns.push(sortedResults.slice(i, i + 3));
                }

                winningInfoHtml = `
                    <div style="margin-top: 15px; padding: 15px; background: #d4edda; border: 1px solid #c3e6cb; border-radius: 8px;">
                        <h5 style="margin-top: 0; color: #155724;">üéØ –í—ã–∏–≥—Ä—ã—à–∏ –Ω–∞–π–¥–µ–Ω—ã –≤ —Ç–∏—Ä–∞–∂–∞—Ö:</h5>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 15px;">
                            ${columns.map((columnResults, columnIndex) => `
                                <div style="display: flex; flex-direction: column; gap: 12px;">
                                    ${columnResults.map(result => `
                                    <div style="padding: 12px; background: rgba(255,255,255,0.9); border-radius: 8px; border-left: 4px solid #28a745; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                        <div style="font-weight: 600; margin-bottom: 8px; color: #155724; font-size: 0.95em;">–¢–∏—Ä–∞–∂ ${result.drawNumber} (${result.date})</div>
                                        <div style="font-size: 0.9em; color: #333; line-height: 1.4;">
                                            <strong>–°–æ–≤–ø–∞–ª–∏:</strong> ${result.matchingNumbers.join(', ')}
                                            <span style="color: #666; margin-left: 8px;">(${result.matches} –∏–∑ 6)</span>
                                        </div>
                                    </div>
                                    `).join('')}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            } else {
                winningInfoHtml = `
                    <div style="margin-top: 15px; padding: 15px; background: #f8d7da; border: 1px solid #f5c6cb; border-radius: 8px;">
                        <h5 style="margin-top: 0; color: #721c24;">‚ùå –í—ã–∏–≥—Ä—ã—à–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h5>
                        <p style="margin: 0;">–í –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö ${testCount} —Ç–∏—Ä–∞–∂–∞—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω–æ 3+ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π</p>
                    </div>
                `;
            }

            // –î–æ–±–∞–≤–ª—è–µ–º –∫—Ä–∞—Ç–∫—É—é —Å–≤–æ–¥–∫—É
            const maxMatches = winningResults.length > 0 ? Math.max(...winningResults.map(r => r.matches)) : 0;
            const summaryHtml = `
                <div class="quick-summary" style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                    <h4 style="margin-top: 0; color: #333;">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏</h4>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 15px;">
                        <div style="padding: 10px; background: rgba(255,255,255,0.8); border-radius: 6px; text-align: center;">
                            <div style="font-size: 1.2em; font-weight: bold; color: var(--primary-color);">${testCount}</div>
                            <div style="font-size: 0.8em; color: #666;">–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —Ç–∏—Ä–∞–∂–µ–π</div>
                        </div>
                        <div style="padding: 10px; background: rgba(255,255,255,0.8); border-radius: 6px; text-align: center;">
                            <div style="font-size: 1.2em; font-weight: bold; color: ${maxMatches >= 3 ? '#28a745' : '#dc3545'};">${maxMatches}</div>
                            <div style="font-size: 0.8em; color: #666;">–ú–∞–∫—Å–∏–º—É–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π</div>
                        </div>
                    </div>
                    <p style="margin: 5px 0; text-align: center; font-weight: 600;">‚Ä¢ –ù–∞–π–¥–µ–Ω–æ –≤—ã–∏–≥—Ä—ã—à–µ–π: ${winningResults.length}</p>
                    ${winningInfoHtml}
                </div>
            `;

            container.innerHTML = `${titleHtml}${summaryHtml}`;
        }
    </script>
</body>
</html>